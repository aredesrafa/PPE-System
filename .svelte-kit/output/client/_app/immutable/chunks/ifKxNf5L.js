import{w as d,d as l}from"./D3FebGYg.js";import{ae as i}from"./BW7nMWMn.js";function y(){const{subscribe:r,set:a,update:s}=d("light");return{subscribe:r,initialize:()=>{const e=localStorage.getItem("theme");if(e==="dark"||e==="light"){a(e),document.documentElement.classList.toggle("dark",e==="dark");return}const o=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";a(o),document.documentElement.classList.toggle("dark",o==="dark")},toggle:()=>{s(e=>{const t=e==="light"?"dark":"light";return localStorage.setItem("theme",t),document.documentElement.classList.toggle("dark",t==="dark"),t})},set:e=>{localStorage.setItem("theme",e),document.documentElement.classList.toggle("dark",e==="dark"),a(e)}}}const N=y();function k(){const{subscribe:r,update:a}=d([]);return{subscribe:r,add:s=>{const e=Math.random().toString(36).substring(7),t={id:e,...s};a(n=>[...n,t]);const o=s.duration||5e3;return o>0&&setTimeout(()=>{a(n=>n.filter(p=>p.id!==e))},o),e},remove:s=>{a(e=>e.filter(t=>t.id!==s))},clear:()=>{a(()=>[])}}}const g=k(),_={success:(r,a,s)=>g.add({type:"success",title:r,message:a,duration:s}),error:(r,a,s)=>g.add({type:"error",title:r,message:a,duration:s}),warning:(r,a,s)=>g.add({type:"warning",title:r,message:a,duration:s}),info:(r,a,s)=>g.add({type:"info",title:r,message:a,duration:s})};function b(r){const a=d(r),s=d(""),e=d(1),t=d(10),o=d(""),n=d("asc"),p=l([a,s,e,t,o,n],([c,f,m,C,P,I])=>({filters:c,search:{term:f,fields:[]},pagination:{currentPage:m,itemsPerPage:C,totalItems:0,totalPages:0},sort:{field:P,direction:I}}));return{filters:a,searchTerm:s,currentPage:e,itemsPerPage:t,sortField:o,sortDirection:n,filtersState:p,updateFilter:(c,f)=>{a.update(m=>({...m,[c]:f})),e.set(1)},setSearchTerm:c=>{s.set(c),e.set(1)},setCurrentPage:c=>{e.set(c)},setItemsPerPage:c=>{t.set(c),e.set(1)},setSorting:(c,f)=>{const m=i(n),C=i(o);c===C&&!f?n.set(m==="asc"?"desc":"asc"):(o.set(c),n.set(f||"asc"))},resetFilters:()=>{a.set(r),s.set(""),e.set(1),o.set(""),n.set("asc")},resetPagination:()=>{e.set(1)},getCurrentFilters:()=>i(a),getCurrentSearchTerm:()=>i(s),getCurrentPage:()=>i(e),getCurrentSort:()=>({field:i(o),direction:i(n)})}}b({status:"todos",categoria:"todas",fabricante:"todos"});b({status:"todos",estoque:"todos",categoria:"todas",vencimento:"todos"});b({cargo:"todos",empresa:"todas",devolucaoPendente:!1});function x(){const{subscribe:r,set:a,update:s}=d([]);return{subscribe:r,set:a,add:e=>s(t=>[...t,e]),update:(e,t)=>s(o=>o.map(n=>n.id===e?{...n,...t}:n)),remove:e=>s(t=>t.filter(o=>o.id!==e)),getById:e=>i({subscribe:r}).find(t=>t.id===e),clear:()=>a([])}}function E(){const{subscribe:r,set:a,update:s}=d([]);return{subscribe:r,set:a,add:e=>s(t=>[...t,e]),update:(e,t)=>s(o=>o.map(n=>n.id===e?{...n,...t}:n)),remove:e=>s(t=>t.filter(o=>o.id!==e)),updateQuantidade:(e,t)=>s(o=>o.map(n=>n.id===e?{...n,quantidade:t}:n)),getById:e=>i({subscribe:r}).find(t=>t.id===e),getByTipoEPI:e=>i({subscribe:r}).filter(t=>t.tipoEPIId===e),clear:()=>a([])}}function q(){const{subscribe:r,set:a,update:s}=d([]);return{subscribe:r,set:a,add:e=>s(t=>[...t,e]),update:(e,t)=>s(o=>o.map(n=>n.id===e?{...n,...t}:n)),remove:e=>s(t=>t.filter(o=>o.id!==e)),getById:e=>i({subscribe:r}).find(t=>t.id===e),getByColaborador:e=>i({subscribe:r}).filter(t=>t.colaboradorId===e),getAtivas:()=>i({subscribe:r}).filter(e=>e.status==="ativo"),getVencidas:()=>i({subscribe:r}).filter(e=>e.status==="vencido"),clear:()=>a([])}}function B(){const{subscribe:r,set:a,update:s}=d([]);return{subscribe:r,set:a,add:e=>s(t=>[...t,e]),update:(e,t)=>s(o=>o.map(n=>n.id===e?{...n,...t}:n)),remove:e=>s(t=>t.filter(o=>o.id!==e)),getById:e=>i({subscribe:r}).find(t=>t.id===e),getByEmpresa:e=>i({subscribe:r}).filter(t=>t.empresaId===e),getAtivos:()=>i({subscribe:r}).filter(e=>e.status==="ativo"),clear:()=>a([])}}function O(){const{subscribe:r,set:a,update:s}=d([]);return{subscribe:r,set:a,add:e=>s(t=>[...t,e]),update:(e,t)=>s(o=>o.map(n=>n.id===e?{...n,...t}:n)),remove:e=>s(t=>t.filter(o=>o.id!==e)),getById:e=>i({subscribe:r}).find(t=>t.id===e),getAtivas:()=>i({subscribe:r}).filter(e=>e.status==="ativa"),clear:()=>a([])}}function w(){const{subscribe:r,set:a,update:s}=d([]);return{subscribe:r,set:a,add:e=>s(t=>[...t,e]),update:(e,t)=>s(o=>o.map(n=>n.id===e?{...n,...t}:n)),remove:e=>s(t=>t.filter(o=>o.id!==e)),getById:e=>i({subscribe:r}).find(t=>t.id===e),getByFicha:e=>i({subscribe:r}).filter(t=>t.fichaEPIId===e),getPendentes:()=>i({subscribe:r}).filter(e=>e.status==="nao_assinado"||e.status==="pendente"),clear:()=>a([])}}function A(){const{subscribe:r,set:a,update:s}=d([]);return{subscribe:r,set:a,add:e=>s(t=>[e,...t]),update:(e,t)=>s(o=>o.map(n=>n.id===e?{...n,...t}:n)),remove:e=>s(t=>t.filter(o=>o.id!==e)),markAsRead:e=>s(t=>t.map(o=>o.id===e?{...o,lida:!0}:o)),markAllAsRead:()=>s(e=>e.map(t=>({...t,lida:!0}))),getNaoLidas:()=>i({subscribe:r}).filter(e=>!e.lida),getByTipo:e=>i({subscribe:r}).filter(t=>t.tipo===e),clear:()=>a([])}}x();const v=E(),h=q(),S=B();O();w();const F=A();l(v,r=>r.filter(a=>a.quantidade>0&&a.status==="disponivel"));l(v,r=>r.filter(a=>a.quantidadeMinima&&a.quantidade<=a.quantidadeMinima));l(h,r=>r.filter(a=>a.status==="vencido"));l(S,r=>r.filter(a=>a.status==="ativo"));const T=l(F,r=>r.filter(a=>!a.lida));l(T,r=>r.length);l([v,h,S,T],([r,a,s,e])=>({totalEstoque:r.reduce((t,o)=>t+o.quantidade,0),fichasAtivas:a.filter(t=>t.status==="ativo").length,fichasVencidas:a.filter(t=>t.status==="vencido").length,colaboradoresAtivos:s.filter(t=>t.status==="ativo").length,notificacoesPendentes:e.length,estoqueComProblemas:r.filter(t=>t.status==="baixo_estoque"||t.status==="vencido"||t.status==="esgotado").length}));function u(){const{subscribe:r,set:a,update:s}=d({isOpen:!1,mode:"create",data:void 0});return{subscribe:r,open:(e="create",t)=>{a({isOpen:!0,mode:e,data:t})},close:()=>{a({isOpen:!1,mode:"create",data:void 0})},setData:e=>{s(t=>({...t,data:e}))},setMode:e=>{s(t=>({...t,mode:e}))},isOpen:()=>i({subscribe:r}).isOpen,isMode:e=>i({subscribe:r}).mode===e,getData:()=>i({subscribe:r}).data}}u();u();u();u();u();u();u();u();function M(){const{subscribe:r,set:a,update:s}=d({isOpen:!1,title:"",message:"",confirmText:"Confirmar",cancelText:"Cancelar",confirmColor:"red"});return{subscribe:r,confirm:e=>{a({isOpen:!0,title:e.title,message:e.message,confirmText:e.confirmText||"Confirmar",cancelText:e.cancelText||"Cancelar",confirmColor:e.confirmColor||"red",onConfirm:e.onConfirm,onCancel:e.onCancel})},close:()=>{a({isOpen:!1,title:"",message:"",confirmText:"Confirmar",cancelText:"Cancelar",confirmColor:"red"})},handleConfirm:async()=>{const e=i({subscribe:r});e.onConfirm&&await e.onConfirm(),a({isOpen:!1,title:"",message:"",confirmText:"Confirmar",cancelText:"Cancelar",confirmColor:"red"})},handleCancel:()=>{const e=i({subscribe:r});e.onCancel&&e.onCancel(),a({isOpen:!1,title:"",message:"",confirmText:"Confirmar",cancelText:"Cancelar",confirmColor:"red"})}}}M();export{g as a,_ as n,N as t};
