var ao=Object.defineProperty;var io=(s,e,t)=>e in s?ao(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var Se=(s,e,t)=>io(s,typeof e!="symbol"?e+"":e,t);import{_ as Je}from"./C1FmrZbK.js";import{S as Jt,i as Zt,s as Kt,d as _,m as F,o as T,p as $e,q as Ae,b as x,c as m,O as $,e as v,f as A,g as S,h as D,j as b,t as O,k as C,Z as Wt,Q as Xt,A as le,B as ne,C as se,D as de,n as ye,P as _e,r as xe,a as W,M as ro,z as Le,a6 as Ue,a4 as Oe,a7 as Re,a8 as Ve}from"./D8ZBcRFv.js";import{c as lo,a as ve,d as je,B as Gt,e as Ie,u as no,o as so}from"./INiUvie6.js";import"./IHki7fMi.js";import{S as Yt,b as co,A as eo,a as uo,L as Pe}from"./Rh-Jv65z.js";import{D as fo,a as _o,T as mo}from"./N0OUQu58.js";import{R as Be}from"./DHdrbWbi.js";import{I as He}from"./V03hm1sS.js";import{F as po}from"./CEMPKOvn.js";import{C as go}from"./PUFNlXKg.js";import{P as Qe}from"./n0KSuBaQ.js";class ho{constructor(){Se(this,"baseEndpoint","/notas-movimentacao")}async listarNotas(e={}){var t,o,a,i,r,d;console.log("üìã NotasMovimentacaoAdapter: Listando notas via endpoint principal",e);try{const c=lo(this.baseEndpoint,{page:(t=e.page)==null?void 0:t.toString(),limit:(o=e.limit)==null?void 0:o.toString(),dataInicio:e.dataInicio,dataFim:e.dataFim,status:e.status,tipo:e.tipo,numero:e.numero,usuarioId:e.responsavel_id,almoxarifadoId:e.almoxarifado_id}),f=await ve.get(c,{timeout:3e4,retries:2});if(console.log("‚úÖ Notas carregadas:",f),f.success&&f.data)return{data:f.data.map(n=>{var u,g,p,E;return{id:n.id,numero:n.numero,tipo:n.tipo,status:n._status,createdAt:n.createdAt,observacoes:n.observacoes,usuarioId:n.usuarioId,almoxarifadoOrigemId:n.almoxarifadoOrigemId,almoxarifadoDestinoId:n.almoxarifadoDestinoId,responsavel_id:n.usuarioId,almoxarifado_id:n.almoxarifadoOrigemId||n.almoxarifadoDestinoId,almoxarifado_destino_id:n.almoxarifadoDestinoId,tipo_nota:n.tipo,_status:n._status,numero_documento:n.numero,data_documento:n.createdAt,created_at:n.createdAt,responsavel_nome:((u=n.usuario)==null?void 0:u.nome)||"N/A",almoxarifado_nome:((g=n.almoxarifadoOrigem)==null?void 0:g.nome)||((p=n.almoxarifadoDestino)==null?void 0:p.nome)||"N/A",almoxarifado_destino_nome:(E=n.almoxarifadoDestino)==null?void 0:E.nome,total_itens:n.totalItens||0,valor_total:n.valorTotal||0,itens:n._itens||[],_itens:n._itens||[],responsavel:n.usuario,almoxarifado:n.almoxarifadoOrigem||n.almoxarifadoDestino,almoxarifado_destino:n.almoxarifadoDestino}}),total:((a=f.pagination)==null?void 0:a.total)||0,page:((i=f.pagination)==null?void 0:i.page)||1,pageSize:((r=f.pagination)==null?void 0:r.limit)||10,totalPages:((d=f.pagination)==null?void 0:d.totalPages)||1};throw new Error("Resposta inv√°lida do servidor")}catch(c){throw console.error("‚ùå Erro ao listar notas:",c),new Error("N√£o foi poss√≠vel carregar as notas de movimenta√ß√£o")}}async obterNota(e){console.log("üîç NotasMovimentacaoAdapter: Buscando nota",e);try{const t=await ve.get(`${this.baseEndpoint}/${e}`);console.log("‚úÖ Resposta obter nota:",t),console.log("üîç Estrutura da resposta:",JSON.stringify(t,null,2));let o;return t.success&&t.data||t.data?o=t.data:o=t,console.log("üìã Dados da nota processados:",JSON.stringify(o,null,2)),o}catch(t){throw console.error("‚ùå Erro ao buscar nota:",t),new Error("N√£o foi poss√≠vel encontrar a nota")}}async listarRascunhos(){var e;console.log("üìù NotasMovimentacaoAdapter: Listando rascunhos");try{const t=await ve.get(`${this.baseEndpoint}/rascunhos`);return console.log("‚úÖ Resposta listar rascunhos:",t),t.success&&t.data?Array.isArray(t.data)?t.data:[]:Array.isArray(t.data)?t.data:(e=t.data)!=null&&e.items?t.data.items:[]}catch(t){throw console.error("‚ùå Erro ao listar rascunhos:",t),new Error("N√£o foi poss√≠vel carregar os rascunhos")}}async criarNota(e){console.log("üìù NotasMovimentacaoAdapter: Criando nota",e);try{if(!e.responsavel_id){console.log("‚ö†Ô∏è responsavel_id n√£o fornecido, buscando usu√°rio padr√£o...");try{const a=await ve.get("/usuarios?limit=1");console.log("üîç Resposta usuarios endpoint:",a),a.items&&a.items.length>0?(e.responsavel_id=a.items[0].id,console.log("‚úÖ Usando responsavel_id:",e.responsavel_id)):a.success&&a.data&&a.data.length>0?(e.responsavel_id=a.data[0].id,console.log("‚úÖ Usando responsavel_id:",e.responsavel_id)):(console.log("‚ö†Ô∏è Nenhum usu√°rio encontrado, usando administrador padr√£o..."),e.responsavel_id="cffc2197-acbe-4a64-bfd7-435370e9c226",console.log("‚úÖ Usando responsavel_id do administrador:",e.responsavel_id))}catch(a){console.error("‚ùå Erro ao buscar usu√°rio:",a),e.responsavel_id="cffc2197-acbe-4a64-bfd7-435370e9c226",console.log("‚úÖ Usando responsavel_id do administrador (fallback):",e.responsavel_id)}}const t={tipo:e.tipo_nota};e.observacoes&&e.observacoes.trim()!==""&&(t.observacoes=e.observacoes.trim()),e.almoxarifado_origem_id&&(t.almoxarifadoOrigemId=e.almoxarifado_origem_id),e.almoxarifado_destino_id&&(t.almoxarifadoDestinoId=e.almoxarifado_destino_id),console.log("üì§ Dados para backend:",t);const o=await ve.post(this.baseEndpoint,t);return console.log("‚úÖ Nota criada:",o),o.success&&o.data?{success:o.success,data:o.data}:o.data?{success:!0,data:o.data}:{success:!0,data:o}}catch(t){throw console.error("‚ùå Erro ao criar nota:",t),new Error("N√£o foi poss√≠vel criar a nota de movimenta√ß√£o")}}async atualizarNota(e,t){console.log("üìù NotasMovimentacaoAdapter: Atualizando nota",e,t);try{const o=await ve.put(`${this.baseEndpoint}/${e}`,t);return console.log("‚úÖ Resposta atualizar nota:",o),o.success&&o.data||o.data?o.data:o}catch(o){throw console.error("‚ùå Erro ao atualizar nota:",o),new Error("N√£o foi poss√≠vel atualizar a nota")}}async excluirNota(e){console.log("üóëÔ∏è NotasMovimentacaoAdapter: Excluindo nota",e);try{await ve.delete(`${this.baseEndpoint}/${e}`),console.log("‚úÖ Nota exclu√≠da:",e)}catch(t){throw console.error("‚ùå Erro ao excluir nota:",t),new Error("N√£o foi poss√≠vel excluir a nota")}}async adicionarItem(e,t){console.log("‚ûï NotasMovimentacaoAdapter: Adicionando item",e,t);try{if(!t.tipo_epi_id)throw new Error("ID do tipo EPI √© obrigat√≥rio");const o=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i,a=/^[A-Z0-9]{6}$/;if(!o.test(t.tipo_epi_id)&&!a.test(t.tipo_epi_id))throw console.error("‚ùå ID inv√°lido detectado:",t.tipo_epi_id),new Error(`ID do tipo EPI inv√°lido: ${t.tipo_epi_id}. Deve ser um UUID v√°lido ou ID customizado (ex: E4U302)`);const i={tipoEpiId:t.tipo_epi_id,quantidade:Number(t.quantidade)};t.observacoes&&t.observacoes.trim()!==""&&(i.observacoes=t.observacoes),console.log("üì§ Dados do item para backend:",i);const r=await ve.post(`${this.baseEndpoint}/${e}/itens`,i);return console.log("‚úÖ Item adicionado:",r),r.success&&r.data||r.data?r.data:r}catch(o){throw console.error("‚ùå Erro ao adicionar item:",o),new Error("N√£o foi poss√≠vel adicionar o item √† nota")}}async atualizarQuantidade(e,t,o){console.log("üìù NotasMovimentacaoAdapter: Atualizando quantidade",e,t,o);try{await ve.put(`${this.baseEndpoint}/${e}/itens/${t}`,{quantidade:Number(o)}),console.log("‚úÖ Quantidade atualizada")}catch(a){throw console.error("‚ùå Erro ao atualizar quantidade:",a),new Error("N√£o foi poss√≠vel atualizar a quantidade")}}async removerItem(e,t){console.log("üóëÔ∏è NotasMovimentacaoAdapter: Removendo item",e,t);try{await ve.delete(`${this.baseEndpoint}/${e}/itens/${t}`),console.log("‚úÖ Item removido")}catch(o){throw console.error("‚ùå Erro ao remover item:",o),new Error("N√£o foi poss√≠vel remover o item")}}async concluirNota(e){console.log("‚ö° NotasMovimentacaoAdapter: Concluindo nota",e);try{const t=await ve.post(`${this.baseEndpoint}/${e}/concluir`,{validarEstoque:!0});return console.log("‚úÖ Nota conclu√≠da:",t),t.success?{success:t.success,data:t.data}:t}catch(t){throw console.error("‚ùå Erro ao concluir nota:",t),new Error("N√£o foi poss√≠vel concluir a nota")}}async cancelarNota(e,t){console.log("üö´ NotasMovimentacaoAdapter: Cancelando nota",e);try{await ve.post(`${this.baseEndpoint}/${e}/cancelar`,{motivo:t||"Cancelamento solicitado pelo usu√°rio",gerarEstorno:!0}),console.log("‚úÖ Nota cancelada:",e)}catch(o){throw console.error("‚ùå Erro ao cancelar nota:",o),new Error("N√£o foi poss√≠vel cancelar a nota")}}async validarCancelamento(e){console.log("üîç NotasMovimentacaoAdapter: Validando cancelamento",e);try{const t=await ve.get(`${this.baseEndpoint}/${e}/validar-cancelamento`);return console.log("‚úÖ Valida√ß√£o de cancelamento:",t),t.success&&t.data||t.data?t.data:t}catch(t){return console.error("‚ùå Erro ao validar cancelamento:",t),{pode_cancelar:!1,motivo:"Erro na valida√ß√£o"}}}async obterNotaCompleta(e){return console.log("üîç NotasMovimentacaoAdapter: Buscando nota completa",e),this.obterNota(e)}async validarNotaAntesConcluir(e){var t,o,a;console.log("üîç NotasMovimentacaoAdapter: Valida√ß√£o local da nota",e);try{const i=await this.obterNota(e),r=[],d=[];(!i.itens||i.itens.length===0)&&r.push("Nota deve ter pelo menos um item"),(i.status==="CONCLUIDA"||i._status==="CONCLUIDA")&&r.push("Nota j√° foi conclu√≠da anteriormente"),(i.status==="CANCELADA"||i._status==="CANCELADA")&&r.push("Nota cancelada n√£o pode ser conclu√≠da");const c=r.length===0;return c&&d.push("Valida√ß√£o local aprovada"),console.log("‚úÖ Valida√ß√£o local conclu√≠da:",{podeConfirmar:c,erros:r.length,itens:(t=i.itens)==null?void 0:t.length}),{pode_concluir:c,erros:r,avisos:d,total_itens_processados:((o=i.itens)==null?void 0:o.length)||0,movimentacoes_previstas:((a=i.itens)==null?void 0:a.length)||0}}catch(i){return console.error("‚ùå Erro na valida√ß√£o local:",i),{pode_concluir:!1,erros:["N√£o foi poss√≠vel carregar dados da nota para valida√ß√£o"],avisos:["Erro na valida√ß√£o local"]}}}async obterOpcoesFilters(){console.log("üîß NotasMovimentacaoAdapter: Carregando op√ß√µes de filtros");try{const[e,t]=await Promise.all([ve.get("/usuarios?limit=100"),ve.get("/estoque/almoxarifados")]),o=(e==null?void 0:e.data)||(e==null?void 0:e.items)||[],a=(t==null?void 0:t.data)||[],i={responsaveis:o.map(r=>({value:r.id,label:r.nome||r.name||`Usu√°rio ${r.id.slice(0,8)}`})),almoxarifados:a.map(r=>({value:r.id,label:r.nome||r.name||`Almoxarifado ${r.id.slice(0,8)}`})),tipos:[{value:"ENTRADA",label:"Entrada"},{value:"TRANSFERENCIA",label:"Transfer√™ncia"},{value:"DESCARTE",label:"Descarte"},{value:"AJUSTE",label:"Ajuste"}],status:[{value:"RASCUNHO",label:"Rascunho"},{value:"CONCLUIDA",label:"Conclu√≠da"},{value:"CANCELADA",label:"Cancelada"}]};return console.log("‚úÖ Op√ß√µes de filtros carregadas:",{responsaveis:i.responsaveis.length,almoxarifados:i.almoxarifados.length}),i}catch(e){return console.error("‚ùå Erro ao carregar op√ß√µes de filtros:",e),{responsaveis:[],almoxarifados:[],tipos:[{value:"ENTRADA",label:"Entrada"},{value:"TRANSFERENCIA",label:"Transfer√™ncia"},{value:"DESCARTE",label:"Descarte"},{value:"AJUSTE",label:"Ajuste"}],status:[{value:"RASCUNHO",label:"Rascunho"},{value:"CONCLUIDA",label:"Conclu√≠da"},{value:"CANCELADA",label:"Cancelada"}]}}}}const ze=new ho;class vo{constructor(){Se(this,"baseEndpoint","/estoque/almoxarifados");Se(this,"selectOptionsCache",null)}async listarAlmoxarifados(){var e;console.log("üè™ AlmoxarifadosAdapter: Listando almoxarifados via estoque");try{try{console.log("üîç Tentando endpoint direto:",this.baseEndpoint);const t=await ve.get(this.baseEndpoint,{timeout:15e3,retries:1});console.log("üì¶ Resposta recebida:",t);let o=[];return t.success&&t.data?o=Array.isArray(t.data)?t.data:[]:Array.isArray(t)?o=t:(console.warn("‚ö†Ô∏è Estrutura de resposta inesperada:",t),o=[]),console.log("üîç Almoxarifados recebidos do backend:",o.map(a=>({id:a.id,nome:a.nome}))),console.log("‚úÖ Almoxarifados listados via endpoint direto:",o.length),o.length===0?(console.warn("‚ö†Ô∏è Nenhum almoxarifado retornado, usando fallback"),this.getFallbackAlmoxarifados()):o}catch{console.log("‚ö†Ô∏è Endpoint direto n√£o dispon√≠vel, extraindo de estoque...");const o=await ve.get("/estoque/itens?limit=100"),a=new Map;o.data.items.forEach(r=>{const d=r.almoxarifado;d&&!a.has(d.id)&&a.set(d.id,{id:d.id,nome:d.nome,unidadeNegocioId:d.unidadeNegocioId,isPrincipal:d.nome.toLowerCase().includes("central"),createdAt:new Date().toISOString(),unidadeNegocio:{id:d.unidadeNegocio.id,nome:d.unidadeNegocio.nome,codigo:d.unidadeNegocio.codigo}})});const i=Array.from(a.values());return console.log("‚úÖ Almoxarifados extra√≠dos do estoque:",i.length),i}}catch(t){if(console.error("‚ùå Erro ao listar almoxarifados:",t),t.name==="AbortError"||(e=t.message)!=null&&e.includes("timeout"))return console.warn("‚ö†Ô∏è Backend indispon√≠vel, usando dados de fallback"),this.getFallbackAlmoxarifados();throw new Error("N√£o foi poss√≠vel carregar os almoxarifados")}}async listarAlmoxarifadosPaginados(e){console.log("üè™ AlmoxarifadosAdapter: Listando almoxarifados com pagina√ß√£o",e);try{const t=new URLSearchParams;e!=null&&e.page&&t.append("page",e.page.toString()),e!=null&&e.limit&&t.append("limit",e.limit.toString()),e!=null&&e.search&&t.append("search",e.search);const o=`${this.baseEndpoint}?${t.toString()}`,a=await ve.get(o);return console.log("‚úÖ Almoxarifados paginados listados:",a.data.pagination),{data:a.data.items,total:a.data.pagination.total,page:a.data.pagination.page,pageSize:a.data.pagination.limit,totalPages:a.data.pagination.totalPages}}catch(t){throw console.error("‚ùå Erro ao listar almoxarifados paginados:",t),new Error("N√£o foi poss√≠vel carregar os almoxarifados")}}async obterAlmoxarifado(e){console.log("üîç AlmoxarifadosAdapter: Buscando almoxarifado",e);try{const t=await ve.get(`${this.baseEndpoint}/${e}`);return console.log("‚úÖ Almoxarifado encontrado:",t.data.nome),t.data}catch(t){throw console.error("‚ùå Erro ao buscar almoxarifado:",t),new Error("N√£o foi poss√≠vel encontrar o almoxarifado")}}async obterOpcoesSelect(){console.log("üîß AlmoxarifadosAdapter: Carregando op√ß√µes para select");try{const t=(await this.listarAlmoxarifados()).map(o=>{var a;return{value:o.id,label:o.nome,isPrincipal:o.isPrincipal,unidadeNegocio:(a=o.unidadeNegocio)==null?void 0:a.nome}});return t.sort((o,a)=>o.isPrincipal&&!a.isPrincipal?-1:!o.isPrincipal&&a.isPrincipal?1:o.label.localeCompare(a.label)),console.log("‚úÖ Op√ß√µes de select criadas:",t.length),t}catch(e){return console.error("‚ùå Erro ao criar op√ß√µes de select:",e),[]}}async obterOpcoesSelectComCache(){const t=Date.now();if(this.selectOptionsCache&&t-this.selectOptionsCache.timestamp<3e5)return console.log("üíæ AlmoxarifadosAdapter: Usando cache para op√ß√µes select"),this.selectOptionsCache.data;const o=await this.obterOpcoesSelect();return this.selectOptionsCache={data:o,timestamp:t},o}limparCache(){this.selectOptionsCache=null,console.log("üóëÔ∏è AlmoxarifadosAdapter: Cache limpo")}clearCache(){this.limparCache()}async validarExistencia(e){try{return await this.obterAlmoxarifado(e),!0}catch{return!1}}async obterAlmoxarifadosPrincipais(){console.log("üèÜ AlmoxarifadosAdapter: Buscando almoxarifados principais");try{const t=(await this.listarAlmoxarifados()).filter(o=>o.isPrincipal);return console.log("‚úÖ Almoxarifados principais encontrados:",t.length),t}catch(e){throw console.error("‚ùå Erro ao buscar almoxarifados principais:",e),new Error("N√£o foi poss√≠vel carregar os almoxarifados principais")}}getFallbackAlmoxarifados(){return[{id:"567a1885-0763-4a13-b9f6-157daa39ddc3",nome:"Almoxarifado Central SP",unidadeNegocioId:"d42d0657-4671-4026-ae34-61b74806ad9d",isPrincipal:!0,createdAt:new Date().toISOString(),unidadeNegocio:{id:"d42d0657-4671-4026-ae34-61b74806ad9d",nome:"Matriz S√£o Paulo",codigo:"SP001"}},{id:"fallback-2",nome:"Almoxarifado Obra (Demo)",unidadeNegocioId:"unidade-2",isPrincipal:!1,createdAt:new Date().toISOString(),unidadeNegocio:{id:"unidade-2",nome:"Obra A",codigo:"OA01"}}]}}const bo=new vo;class Eo{constructor(){Se(this,"baseEndpoint","/tipos-epi");Se(this,"selectOptionsCache",null)}async listarTiposEpi(e){var t;console.log("üõ°Ô∏è TiposEpiAdapter: Listando tipos de EPI",e);try{const o=new URLSearchParams;e!=null&&e.page&&o.append("page",e.page.toString()),e!=null&&e.limit&&o.append("limit",e.limit.toString()),e!=null&&e.search&&o.append("search",e.search),e!=null&&e.categoria&&o.append("categoria",e.categoria);const a=`${this.baseEndpoint}?${o.toString()}`,i=await ve.get(a);return console.log("‚úÖ Tipos de EPI listados:",i.data.pagination),{data:i.data.items,total:i.data.pagination.total,page:i.data.pagination.page,pageSize:i.data.pagination.limit,totalPages:i.data.pagination.totalPages}}catch(o){if(console.error("‚ùå Erro ao listar tipos de EPI:",o),o.name==="AbortError"||(t=o.message)!=null&&t.includes("timeout")){console.warn("‚ö†Ô∏è Backend indispon√≠vel, usando dados de fallback para tipos EPI");const a=this.getFallbackTiposEPI();return{data:a,total:a.length,page:1,pageSize:a.length,totalPages:1}}throw new Error("N√£o foi poss√≠vel carregar os tipos de EPI")}}async obterTipoEpi(e){console.log("üîç TiposEpiAdapter: Buscando tipo de EPI",e);try{const t=await ve.get(`${this.baseEndpoint}/${e}`);return console.log("‚úÖ Tipo de EPI encontrado:",t.data.nome_equipamento),t.data}catch(t){throw console.error("‚ùå Erro ao buscar tipo de EPI:",t),new Error("N√£o foi poss√≠vel encontrar o tipo de EPI")}}async obterOpcoesSelect(e){console.log("üîß TiposEpiAdapter: Carregando op√ß√µes para select",e);try{const t={page:1,limit:(e==null?void 0:e.limite)||100};e!=null&&e.categoria&&(t.categoria=e.categoria);const o=await this.listarTiposEpi(t),a=d=>{const c=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i,f=/^[A-Z0-9]{6}$/;return c.test(d)||f.test(d)},i=o.data.filter(d=>{const c=a(d.id);return c||console.warn(`‚ö†Ô∏è Tipo EPI com ID inv√°lido ignorado: ${d.id} - ${d.nomeEquipamento}`),c});console.log(`üîç Tipos EPI v√°lidos: ${i.length} de ${o.data.length}`);const r=i.map(d=>{console.log("üîç Mapeando tipo EPI completo:",JSON.stringify(d,null,2)),console.log("üîç Campos dispon√≠veis:",Object.keys(d)),console.log("üîç nome_equipamento:",d.nome_equipamento),console.log("üîç nomeEquipamento:",d.nomeEquipamento),console.log("üîç nome:",d.nome),console.log("üîç name:",d.name);const c=d.nomeEquipamento||d.nome_equipamento||d.nome||d.name||"Nome n√£o identificado",f=d.numeroCa||d.numero_ca||d.numeroCA||d.ca||"N/A",l=d.categoria||d.category||"Sem categoria",n={value:d.id,label:`${c} (CA: ${f})`,categoria:l,numeroCA:f,custoUnitario:d.custo_unitario||d.custoUnitario||d.preco||0,status:d.status};return console.log("üéØ Op√ß√£o final criada:",n),n});return r.sort((d,c)=>d.label.localeCompare(c.label)),console.log("‚úÖ Op√ß√µes de select criadas:",r.length),r}catch(t){return console.error("‚ùå Erro ao criar op√ß√µes de select:",t),[]}}async obterOpcoesAgrupadasPorCategoria(){console.log("üìÇ TiposEpiAdapter: Agrupando op√ß√µes por categoria");try{const e=await this.obterOpcoesSelect({apenasAtivos:!0}),t={};return e.forEach(o=>{t[o.categoria]||(t[o.categoria]=[]),t[o.categoria].push(o)}),Object.keys(t).forEach(o=>{t[o].sort((a,i)=>a.label.localeCompare(i.label))}),console.log("‚úÖ Op√ß√µes agrupadas por categoria:",Object.keys(t)),t}catch(e){return console.error("‚ùå Erro ao agrupar op√ß√µes por categoria:",e),{}}}async obterOpcoesSelectComCache(e){const o=Date.now(),a=JSON.stringify(e||{});if(this.selectOptionsCache&&this.selectOptionsCache.key===a&&o-this.selectOptionsCache.timestamp<3e5)return console.log("üíæ TiposEpiAdapter: Usando cache para op√ß√µes select"),this.selectOptionsCache.data;const i=await this.obterOpcoesSelect(e);return this.selectOptionsCache={data:i,timestamp:o,key:a},i}async buscarTiposEpi(e){if(console.log("üîç TiposEpiAdapter: Buscando tipos de EPI",e),!e||e.length<2)return[];try{const o=(await this.listarTiposEpi({search:e,limit:20})).data.map(a=>{const i=a.nomeEquipamento||a.nome_equipamento||a.nome||a.name||"Nome n√£o identificado",r=a.numeroCa||a.numero_ca||a.numeroCA||a.ca||"N/A",d=a.categoria||a.category||"Sem categoria";return{value:a.id,label:`${i} (CA: ${r})`,categoria:d,numeroCA:r,custoUnitario:a.custo_unitario||a.custoUnitario||a.preco||0}});return console.log("‚úÖ Busca realizada, encontrados:",o.length),o}catch(t){return console.error("‚ùå Erro na busca de tipos de EPI:",t),[]}}async obterCategorias(){console.log("üìã TiposEpiAdapter: Carregando categorias");try{const e=await this.listarTiposEpi({limit:500}),t=[...new Set(e.data.map(o=>o.categoria))].filter(o=>o&&o.trim()!=="").sort();return console.log("‚úÖ Categorias encontradas:",t),t}catch(e){return console.error("‚ùå Erro ao carregar categorias:",e),[]}}async validarTipoEpiAtivo(e){try{return(await this.obterTipoEpi(e)).status==="ATIVO"}catch{return!1}}limparCache(){this.selectOptionsCache=null,console.log("üóëÔ∏è TiposEpiAdapter: Cache limpo")}clearCache(){this.limparCache()}async obterTiposPopulares(e=10){console.log("üåü TiposEpiAdapter: Carregando tipos populares");try{const o=(await this.listarTiposEpi({limit:e})).data.map(a=>{const i=a.nomeEquipamento||a.nome_equipamento||a.nome||a.name||"Nome n√£o identificado",r=a.numeroCa||a.numero_ca||a.numeroCA||a.ca||"N/A",d=a.categoria||a.category||"Sem categoria";return{value:a.id,label:`${i} (CA: ${r})`,categoria:d,numeroCA:r,custoUnitario:a.custo_unitario||a.custoUnitario||a.preco||0}});return console.log("‚úÖ Tipos populares carregados:",o.length),o}catch(t){return console.error("‚ùå Erro ao carregar tipos populares:",t),[]}}getFallbackTiposEPI(){return[{id:"fallback-1",nome_equipamento:"Capacete de Seguran√ßa (Demo)",numero_ca:"12345",categoria:"PROTECAO_CRANIO",custo_unitario:35.5,status:"ATIVO",created_at:new Date().toISOString()},{id:"fallback-2",nome_equipamento:"√ìculos de Prote√ß√£o (Demo)",numero_ca:"67890",categoria:"PROTECAO_OLHOS",custo_unitario:28.9,status:"ATIVO",created_at:new Date().toISOString()},{id:"fallback-3",nome_equipamento:"Luva de Seguran√ßa (Demo)",numero_ca:"54321",categoria:"PROTECAO_MAOS",custo_unitario:15.75,status:"ATIVO",created_at:new Date().toISOString()}]}}const to=new Eo,$o=Object.freeze(Object.defineProperty({__proto__:null,tiposEpiAdapter:to},Symbol.toStringTag,{value:"Module"}));class Ao{constructor(){Se(this,"baseEndpoint","/estoque/itens");Se(this,"itensDisponiveis",{})}async listarItensEstoque(e){console.log("üì¶ EstoqueItensAdapter: Listando itens de estoque",e);try{const t=new URLSearchParams;e!=null&&e.page&&t.append("page",e.page.toString()),e!=null&&e.limit&&t.append("limit",e.limit.toString()),e!=null&&e.search&&t.append("search",e.search),e!=null&&e.almoxarifado_id&&t.append("almoxarifado_id",e.almoxarifado_id),e!=null&&e.tipo_epi_id&&t.append("tipo_epi_id",e.tipo_epi_id),e!=null&&e.status&&e.status!=="todos"&&t.append("status",e.status),e!=null&&e.categoria&&t.append("categoria",e.categoria);const o=`${this.baseEndpoint}?${t.toString()}`,a=await ve.get(o);return console.log("‚úÖ Itens de estoque listados:",a.data.pagination),{data:a.data.items,total:a.data.pagination.total,page:a.data.pagination.page,pageSize:a.data.pagination.limit,totalPages:a.data.pagination.totalPages}}catch(t){throw console.error("‚ùå Erro ao listar itens de estoque:",t),new Error("N√£o foi poss√≠vel carregar os itens de estoque")}}async obterItensDisponiveisParaSaida(e){console.log("üöö EstoqueItensAdapter: Buscando itens dispon√≠veis para sa√≠da",e);try{const o=(await this.listarItensEstoque({almoxarifado_id:e,status:"DISPONIVEL",limit:100})).data.filter(a=>a.quantidade>0).map(a=>({value:a.id,label:`${a.tipo_epi.nome_equipamento} - ${a.quantidade} dispon√≠vel`,quantidade:a.quantidade,equipamento:a.tipo_epi.nome_equipamento,categoria:a.tipo_epi.categoria,numeroCA:a.tipo_epi.numero_ca,almoxarifado:a.almoxarifado.nome,almoxarifadoId:a.almoxarifado.id,quantidadeMaxima:a.quantidade,status:a.status,dataValidade:a.data_validade,lote:a.lote}));return o.sort((a,i)=>a.equipamento.localeCompare(i.equipamento)),console.log("‚úÖ Itens dispon√≠veis para sa√≠da:",o.length),o}catch(t){return console.error("‚ùå Erro ao buscar itens dispon√≠veis para sa√≠da:",t),[]}}async buscarItensEstoque(e,t){if(console.log("üîç EstoqueItensAdapter: Buscando itens de estoque",e,t),!e||e.length<2)return[];try{const o={search:e,limit:20,status:"DISPONIVEL",almoxarifado_id:t},i=(await this.listarItensEstoque(o)).data.map(r=>({value:r.id,label:`${r.tipo_epi.nome_equipamento} (${r.quantidade} dispon√≠vel)`,quantidade:r.quantidade,equipamento:r.tipo_epi.nome_equipamento,categoria:r.tipo_epi.categoria,numeroCA:r.tipo_epi.numero_ca,almoxarifado:r.almoxarifado.nome,almoxarifadoId:r.almoxarifado.id,quantidadeMaxima:r.quantidade,status:r.status,dataValidade:r.data_validade,lote:r.lote}));return console.log("‚úÖ Busca realizada, encontrados:",i.length),i}catch(o){return console.error("‚ùå Erro na busca de itens de estoque:",o),[]}}async obterItemEstoque(e){console.log("üîç EstoqueItensAdapter: Buscando item de estoque",e);try{const t=await ve.get(`${this.baseEndpoint}/${e}`);return console.log("‚úÖ Item de estoque encontrado:",t.data.tipo_epi.nome_equipamento),t.data}catch(t){throw console.error("‚ùå Erro ao buscar item de estoque:",t),new Error("N√£o foi poss√≠vel encontrar o item de estoque")}}async validarQuantidadeDisponivel(e,t){console.log("‚úÖ EstoqueItensAdapter: Validando quantidade dispon√≠vel",e,t);try{const o=await this.obterItemEstoque(e);return o.status!=="DISPONIVEL"?{valido:!1,quantidadeDisponivel:o.quantidade,motivo:`Item n√£o est√° dispon√≠vel (status: ${o.status})`}:t>o.quantidade?{valido:!1,quantidadeDisponivel:o.quantidade,motivo:`Quantidade desejada (${t}) √© maior que a dispon√≠vel (${o.quantidade})`}:t<=0?{valido:!1,quantidadeDisponivel:o.quantidade,motivo:"Quantidade deve ser maior que zero"}:{valido:!0,quantidadeDisponivel:o.quantidade}}catch(o){return console.error("‚ùå Erro ao validar quantidade dispon√≠vel:",o),{valido:!1,quantidadeDisponivel:0,motivo:"Erro ao validar item de estoque"}}}async obterItensAgrupadosPorTipo(e){console.log("üìä EstoqueItensAdapter: Agrupando itens por tipo de EPI",e);try{const t=await this.listarItensEstoque({almoxarifado_id:e,status:"DISPONIVEL",limit:500}),o={};return t.data.forEach(a=>{const i=a.tipo_epi.id;o[i]||(o[i]={tipo_epi:a.tipo_epi,itens:[],quantidade_total:0}),o[i].itens.push(a),o[i].quantidade_total+=a.quantidade}),console.log("‚úÖ Itens agrupados por tipo:",Object.keys(o).length),o}catch(t){return console.error("‚ùå Erro ao agrupar itens por tipo:",t),{}}}async obterItensDisponiveisComCache(e){const o=Date.now(),a=this.itensDisponiveis[e];if(a&&o-a.timestamp<12e4)return console.log("üíæ EstoqueItensAdapter: Usando cache para itens dispon√≠veis"),a.data;const i=await this.obterItensDisponiveisParaSaida(e);return this.itensDisponiveis[e]={data:i,timestamp:o},i}limparCache(e){e?(delete this.itensDisponiveis[e],console.log("üóëÔ∏è EstoqueItensAdapter: Cache limpo para almoxarifado",e)):(this.itensDisponiveis={},console.log("üóëÔ∏è EstoqueItensAdapter: Cache completo limpo"))}clearCache(){this.limparCache()}async obterItensBaixoEstoque(e){console.log("‚ö†Ô∏è EstoqueItensAdapter: Buscando itens com baixo estoque");try{const o=(await this.listarItensEstoque({almoxarifado_id:e,status:"BAIXO",limit:100})).data.map(a=>({value:a.id,label:`${a.tipo_epi.nome_equipamento} - ${a.quantidade} restante`,quantidade:a.quantidade,equipamento:a.tipo_epi.nome_equipamento,categoria:a.tipo_epi.categoria,numeroCA:a.tipo_epi.numero_ca,almoxarifado:a.almoxarifado.nome,almoxarifadoId:a.almoxarifado.id,quantidadeMaxima:a.quantidade,status:a.status,dataValidade:a.data_validade,lote:a.lote}));return console.log("‚úÖ Itens com baixo estoque:",o.length),o}catch(t){return console.error("‚ùå Erro ao buscar itens com baixo estoque:",t),[]}}async verificarDisponibilidadeRealTime(e){console.log("üîÑ EstoqueItensAdapter: Verificando disponibilidade em tempo real");const t=await Promise.all(e.map(async o=>{try{const a=await this.validarQuantidadeDisponivel(o.itemId,o.quantidade);return{itemId:o.itemId,disponivel:a.valido,quantidadeAtual:a.quantidadeDisponivel,motivo:a.motivo}}catch{return{itemId:o.itemId,disponivel:!1,quantidadeAtual:0,motivo:"Erro ao verificar item"}}}));return console.log("‚úÖ Verifica√ß√£o conclu√≠da:",t.length),t}}const oo=new Ao,xo=Object.freeze(Object.defineProperty({__proto__:null,estoqueItensAdapter:oo},Symbol.toStringTag,{value:"Module"}));function Ze(s,e,t){const o=s.slice();return o[23]=e[t],o[25]=t,o}function Ke(s,e,t){const o=s.slice();return o[26]=e[t],o}function We(s){let e,t;return e=new je({props:{color:"gray",class:"ml-2 rounded-sm",$$slots:{default:[ko]},$$scope:{ctx:s}}}),{c(){de(e.$$.fragment)},l(o){se(e.$$.fragment,o)},m(o,a){ne(e,o,a),t=!0},p(o,a){const i={};a&536870913&&(i.$$scope={dirty:a,ctx:o}),e.$set(i)},i(o){t||(T(e.$$.fragment,o),t=!0)},o(o){F(e.$$.fragment,o),t=!1},d(o){le(e,o)}}}function ko(s){let e=s[0].length+"",t;return{c(){t=O(e)},l(o){t=S(o,e)},m(o,a){x(o,t,a)},p(o,a){a&1&&e!==(e=o[0].length+"")&&W(t,e)},d(o){o&&_(t)}}}function Xe(s){let e,t;return e=new Gt({props:{size:"sm",color:"primary",class:"rounded-sm",disabled:s[5],$$slots:{default:[Io]},$$scope:{ctx:s}}}),e.$on("click",s[8]),{c(){de(e.$$.fragment)},l(o){se(e.$$.fragment,o)},m(o,a){ne(e,o,a),t=!0},p(o,a){const i={};a&32&&(i.disabled=o[5]),a&536870912&&(i.$$scope={dirty:a,ctx:o}),e.$set(i)},i(o){t||(T(e.$$.fragment,o),t=!0)},o(o){F(e.$$.fragment,o),t=!1},d(o){le(e,o)}}}function Io(s){let e,t,o;return e=new Qe({props:{class:"w-4 h-4 mr-2"}}),{c(){de(e.$$.fragment),t=O(`
        Adicionar Item`)},l(a){se(e.$$.fragment,a),t=S(a,`
        Adicionar Item`)},m(a,i){ne(e,a,i),x(a,t,i),o=!0},p:ye,i(a){o||(T(e.$$.fragment,a),o=!0)},o(a){F(e.$$.fragment,a),o=!1},d(a){a&&_(t),le(e,a)}}}function wo(s){let e,t=[],o=new Map,a,i,r,d=Ie(s[0]);const c=l=>l[23].temp_id;for(let l=0;l<d.length;l+=1){let n=Ze(s,d,l),u=c(n);o.set(u,t[l]=dt(u,n))}let f=s[0].length>0&&ct(s);return{c(){e=b("div");for(let l=0;l<t.length;l+=1)t[l].c();a=C(),f&&f.c(),i=xe(),this.h()},l(l){e=v(l,"DIV",{class:!0});var n=A(e);for(let u=0;u<t.length;u+=1)t[u].l(n);n.forEach(_),a=D(l),f&&f.l(l),i=xe(),this.h()},h(){$(e,"class","space-y-0")},m(l,n){x(l,e,n);for(let u=0;u<t.length;u+=1)t[u]&&t[u].m(e,null);x(l,a,n),f&&f.m(l,n),x(l,i,n),r=!0},p(l,n){n&1759&&(d=Ie(l[0]),$e(),t=no(t,n,c,1,l,d,o,e,so,dt,null,Ze),Ae()),l[0].length>0?f?f.p(l,n):(f=ct(l),f.c(),f.m(i.parentNode,i)):f&&(f.d(1),f=null)},i(l){if(!r){for(let n=0;n<d.length;n+=1)T(t[n]);r=!0}},o(l){for(let n=0;n<t.length;n+=1)F(t[n]);r=!1},d(l){l&&(_(e),_(a),_(i));for(let n=0;n<t.length;n+=1)t[n].d();f&&f.d(l)}}}function Do(s){let e,t;return e=new go({props:{size:"sm",class:"text-center py-8",$$slots:{default:[So]},$$scope:{ctx:s}}}),{c(){de(e.$$.fragment)},l(o){se(e.$$.fragment,o)},m(o,a){ne(e,o,a),t=!0},p(o,a){const i={};a&536871042&&(i.$$scope={dirty:a,ctx:o}),e.$set(i)},i(o){t||(T(e.$$.fragment,o),t=!0)},o(o){F(e.$$.fragment,o),t=!1},d(o){le(e,o)}}}function Co(s){let e,t='<div class="animate-spin inline-block w-6 h-6 border-[3px] border-current border-t-transparent text-primary-600 rounded-full" aria-label="loading"><span class="sr-only">Carregando...</span></div> <p class="text-sm text-gray-500 mt-2">Carregando op√ß√µes...</p>';return{c(){e=b("div"),e.innerHTML=t,this.h()},l(o){e=v(o,"DIV",{class:!0,"data-svelte-h":!0}),_e(e)!=="svelte-dy1n65"&&(e.innerHTML=t),this.h()},h(){$(e,"class","text-center py-8")},m(o,a){x(o,e,a)},p:ye,i:ye,o:ye,d(o){o&&_(e)}}}function Ge(s){let e,t,o=s[23].equipamento_nome+"",a;return{c(){e=b("span"),t=O("- "),a=O(o),this.h()},l(i){e=v(i,"SPAN",{class:!0});var r=A(e);t=S(r,"- "),a=S(r,o),r.forEach(_),this.h()},h(){$(e,"class","font-normal text-gray-600 dark:text-gray-400")},m(i,r){x(i,e,r),m(e,t),m(e,a)},p(i,r){r&1&&o!==(o=i[23].equipamento_nome+"")&&W(a,o)},d(i){i&&_(e)}}}function Ye(s){let e,t,o,a,i;t=new co({props:{class:"w-4 h-4"}});function r(){return s[13](s[25])}return{c(){e=b("button"),de(t.$$.fragment),this.h()},l(d){e=v(d,"BUTTON",{class:!0,title:!0});var c=A(e);se(t.$$.fragment,c),c.forEach(_),this.h()},h(){$(e,"class","p-1 rounded-sm text-red-600 hover:bg-red-100 dark:hover:bg-red-800/20 transition-colors"),$(e,"title","Remover item")},m(d,c){x(d,e,c),ne(t,e,null),o=!0,a||(i=ro(e,"click",r),a=!0)},p(d,c){s=d},i(d){o||(T(t.$$.fragment,d),o=!0)},o(d){F(t.$$.fragment,d),o=!1},d(d){d&&_(e),le(t),a=!1,i()}}}function et(s){let e,t=s[26].label+"",o,a;return{c(){e=b("option"),o=O(t),this.h()},l(i){e=v(i,"OPTION",{});var r=A(e);o=S(r,t),r.forEach(_),this.h()},h(){e.__value=a=s[26].value,Ue(e,e.__value)},m(i,r){x(i,e,r),m(e,o)},p(i,r){r&140&&t!==(t=i[26].label+"")&&W(o,t),r&140&&a!==(a=i[26].value)&&(e.__value=a,Ue(e,e.__value))},d(i){i&&_(e)}}}function No(s){let e,t="Selecione...",o,a,i=Ie(s[7]?s[2]:s[3]),r=[];for(let d=0;d<i.length;d+=1)r[d]=et(Ke(s,i,d));return{c(){e=b("option"),e.textContent=t,o=C();for(let d=0;d<r.length;d+=1)r[d].c();a=xe(),this.h()},l(d){e=v(d,"OPTION",{"data-svelte-h":!0}),_e(e)!=="svelte-6uo3hd"&&(e.textContent=t),o=D(d);for(let c=0;c<r.length;c+=1)r[c].l(d);a=xe(),this.h()},h(){e.__value="",Ue(e,e.__value)},m(d,c){x(d,e,c),x(d,o,c);for(let f=0;f<r.length;f+=1)r[f]&&r[f].m(d,c);x(d,a,c)},p(d,c){if(c&140){i=Ie(d[7]?d[2]:d[3]);let f;for(f=0;f<i.length;f+=1){const l=Ke(d,i,f);r[f]?r[f].p(l,c):(r[f]=et(l),r[f].c(),r[f].m(a.parentNode,a))}for(;f<r.length;f+=1)r[f].d(1);r.length=i.length}},d(d){d&&(_(e),_(o),_(a)),Le(r,d)}}}function tt(s){let e,t,o=s[23].quantidade_disponivel+"",a,i;return{c(){e=b("span"),t=O("(m√°x: "),a=O(o),i=O(")"),this.h()},l(r){e=v(r,"SPAN",{class:!0});var d=A(e);t=S(d,"(m√°x: "),a=S(d,o),i=S(d,")"),d.forEach(_),this.h()},h(){$(e,"class","text-xs text-gray-500")},m(r,d){x(r,e,d),m(e,t),m(e,a),m(e,i)},p(r,d){d&1&&o!==(o=r[23].quantidade_disponivel+"")&&W(a,o)},d(r){r&&_(e)}}}function ot(s){let e,t,o,a,i,r,d;function c(...f){return s[16](s[25],...f)}return r=new He({props:{id:"custo-"+s[25],type:"number",min:"0",step:"0.01",value:s[23].custo_unitario,disabled:s[1],placeholder:"Custo unit√°rio (R$)",class:"rounded-sm text-sm"}}),r.$on("input",c),{c(){e=b("div"),t=b("label"),o=O("Custo Unit√°rio (R$)"),i=C(),de(r.$$.fragment),this.h()},l(f){e=v(f,"DIV",{class:!0});var l=A(e);t=v(l,"LABEL",{for:!0,class:!0});var n=A(t);o=S(n,"Custo Unit√°rio (R$)"),n.forEach(_),i=D(l),se(r.$$.fragment,l),l.forEach(_),this.h()},h(){$(t,"for",a="custo-"+s[25]),$(t,"class","block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"),$(e,"class","md:col-span-3")},m(f,l){x(f,e,l),m(e,t),m(t,o),m(e,i),ne(r,e,null),d=!0},p(f,l){s=f,(!d||l&1&&a!==(a="custo-"+s[25]))&&$(t,"for",a);const n={};l&1&&(n.id="custo-"+s[25]),l&1&&(n.value=s[23].custo_unitario),l&2&&(n.disabled=s[1]),r.$set(n)},i(f){d||(T(r.$$.fragment,f),d=!0)},o(f){F(r.$$.fragment,f),d=!1},d(f){f&&_(e),le(r)}}}function at(s){let e,t,o,a,i=s[23].equipamento_nome+"",r,d,c,f,l,n,u,g=s[23].quantidade+"",p,E,w=s[4]&&s[23].custo_unitario!=null&&typeof s[23].custo_unitario=="number"&&!isNaN(s[23].custo_unitario),V,P=s[23].categoria&&it(s),U=s[23].numero_ca&&rt(s),h=w&&lt(s),y=s[23].quantidade_disponivel!==void 0&&nt(s);return{c(){e=b("div"),t=b("div"),o=b("div"),a=b("h6"),r=O(i),d=C(),P&&P.c(),c=C(),U&&U.c(),f=C(),l=b("div"),n=b("p"),u=O("Qtd: "),p=O(g),E=C(),h&&h.c(),V=C(),y&&y.c(),this.h()},l(L){e=v(L,"DIV",{class:!0});var M=A(e);t=v(M,"DIV",{class:!0});var X=A(t);o=v(X,"DIV",{});var I=A(o);a=v(I,"H6",{class:!0});var j=A(a);r=S(j,i),j.forEach(_),d=D(I),P&&P.l(I),c=D(I),U&&U.l(I),I.forEach(_),f=D(X),l=v(X,"DIV",{class:!0});var H=A(l);n=v(H,"P",{class:!0});var G=A(n);u=S(G,"Qtd: "),p=S(G,g),G.forEach(_),E=D(H),h&&h.l(H),V=D(H),y&&y.l(H),H.forEach(_),X.forEach(_),M.forEach(_),this.h()},h(){$(a,"class","text-sm font-medium text-gray-900 dark:text-white"),$(n,"class","text-sm font-medium text-gray-900 dark:text-white"),$(l,"class","text-right"),$(t,"class","flex items-start justify-between"),$(e,"class","mt-4 p-3 bg-gray-50 dark:bg-gray-800 rounded-sm")},m(L,M){x(L,e,M),m(e,t),m(t,o),m(o,a),m(a,r),m(o,d),P&&P.m(o,null),m(o,c),U&&U.m(o,null),m(t,f),m(t,l),m(l,n),m(n,u),m(n,p),m(l,E),h&&h.m(l,null),m(l,V),y&&y.m(l,null)},p(L,M){M&1&&i!==(i=L[23].equipamento_nome+"")&&W(r,i),L[23].categoria?P?P.p(L,M):(P=it(L),P.c(),P.m(o,c)):P&&(P.d(1),P=null),L[23].numero_ca?U?U.p(L,M):(U=rt(L),U.c(),U.m(o,null)):U&&(U.d(1),U=null),M&1&&g!==(g=L[23].quantidade+"")&&W(p,g),M&17&&(w=L[4]&&L[23].custo_unitario!=null&&typeof L[23].custo_unitario=="number"&&!isNaN(L[23].custo_unitario)),w?h?h.p(L,M):(h=lt(L),h.c(),h.m(l,V)):h&&(h.d(1),h=null),L[23].quantidade_disponivel!==void 0?y?y.p(L,M):(y=nt(L),y.c(),y.m(l,null)):y&&(y.d(1),y=null)},d(L){L&&_(e),P&&P.d(),U&&U.d(),h&&h.d(),y&&y.d()}}}function it(s){let e,t,o=s[23].categoria+"",a;return{c(){e=b("p"),t=O("Categoria: "),a=O(o),this.h()},l(i){e=v(i,"P",{class:!0});var r=A(e);t=S(r,"Categoria: "),a=S(r,o),r.forEach(_),this.h()},h(){$(e,"class","text-xs text-gray-600 dark:text-gray-400")},m(i,r){x(i,e,r),m(e,t),m(e,a)},p(i,r){r&1&&o!==(o=i[23].categoria+"")&&W(a,o)},d(i){i&&_(e)}}}function rt(s){let e,t,o=s[23].numero_ca+"",a;return{c(){e=b("p"),t=O("CA: "),a=O(o),this.h()},l(i){e=v(i,"P",{class:!0});var r=A(e);t=S(r,"CA: "),a=S(r,o),r.forEach(_),this.h()},h(){$(e,"class","text-xs text-gray-600 dark:text-gray-400")},m(i,r){x(i,e,r),m(e,t),m(e,a)},p(i,r){r&1&&o!==(o=i[23].numero_ca+"")&&W(a,o)},d(i){i&&_(e)}}}function lt(s){let e,t,o=s[23].custo_unitario.toFixed(2)+"",a,i,r,d,c=(s[23].quantidade*s[23].custo_unitario).toFixed(2)+"",f;return{c(){e=b("p"),t=O("Unit: R$ "),a=O(o),i=C(),r=b("p"),d=O("Total: R$ "),f=O(c),this.h()},l(l){e=v(l,"P",{class:!0});var n=A(e);t=S(n,"Unit: R$ "),a=S(n,o),n.forEach(_),i=D(l),r=v(l,"P",{class:!0});var u=A(r);d=S(u,"Total: R$ "),f=S(u,c),u.forEach(_),this.h()},h(){$(e,"class","text-xs text-gray-600 dark:text-gray-400"),$(r,"class","text-sm font-medium text-green-600 dark:text-green-400")},m(l,n){x(l,e,n),m(e,t),m(e,a),x(l,i,n),x(l,r,n),m(r,d),m(r,f)},p(l,n){n&1&&o!==(o=l[23].custo_unitario.toFixed(2)+"")&&W(a,o),n&1&&c!==(c=(l[23].quantidade*l[23].custo_unitario).toFixed(2)+"")&&W(f,c)},d(l){l&&(_(e),_(i),_(r))}}}function nt(s){let e,t,o=s[23].quantidade_disponivel+"",a;return{c(){e=b("p"),t=O("Dispon√≠vel: "),a=O(o),this.h()},l(i){e=v(i,"P",{class:!0});var r=A(e);t=S(r,"Dispon√≠vel: "),a=S(r,o),r.forEach(_),this.h()},h(){$(e,"class","text-xs text-gray-600 dark:text-gray-400")},m(i,r){x(i,e,r),m(e,t),m(e,a)},p(i,r){r&1&&o!==(o=i[23].quantidade_disponivel+"")&&W(a,o)},d(i){i&&_(e)}}}function st(s){let e,t;return e=new eo({props:{color:"red",class:"mt-3 rounded-sm",$$slots:{default:[yo]},$$scope:{ctx:s}}}),{c(){de(e.$$.fragment)},l(o){se(e.$$.fragment,o)},m(o,a){ne(e,o,a),t=!0},p(o,a){const i={};a&536870977&&(i.$$scope={dirty:a,ctx:o}),e.$set(i)},i(o){t||(T(e.$$.fragment,o),t=!0)},o(o){F(e.$$.fragment,o),t=!1},d(o){le(e,o)}}}function yo(s){let e,t=s[6][s[23].temp_id]+"",o;return{c(){e=b("span"),o=O(t),this.h()},l(a){e=v(a,"SPAN",{class:!0});var i=A(e);o=S(i,t),i.forEach(_),this.h()},h(){$(e,"class","text-sm")},m(a,i){x(a,e,i),m(e,o)},p(a,i){i&65&&t!==(t=a[6][a[23].temp_id]+"")&&W(o,t)},d(a){a&&_(e)}}}function dt(s,e){let t,o,a,i,r=e[25]+1+"",d,c,f,l,n,u,g,p=e[7]?"Tipo de EPI":"Item do Estoque",E,w,V,P,U,h,y,L,M,X,I,j,H,G,ee,ie,ae=e[23].equipamento_nome&&Ge(e),Q=!e[1]&&e[0].length>1&&Ye(e);function ke(...J){return e[14](e[25],...J)}P=new Yt({props:{id:"item-select-"+e[25],value:e[7]?e[23].tipo_epi_id:e[23].estoque_item_id,disabled:e[1],class:"rounded-sm text-sm",$$slots:{default:[No]},$$scope:{ctx:e}}}),P.$on("change",ke);let Y=e[23].quantidade_disponivel!==void 0&&tt(e);function ce(...J){return e[15](e[25],...J)}I=new He({props:{id:"quantidade-"+e[25],type:"number",min:"1",max:e[23].quantidade_disponivel||void 0,value:e[23].quantidade,disabled:e[1],placeholder:"Qtd",class:"rounded-sm text-sm"}}),I.$on("input",ce);let B=e[4]&&ot(e),K=e[23].equipamento_nome&&at(e),fe=e[6][e[23].temp_id]&&st(e);return{key:s,first:null,c(){t=b("div"),o=b("div"),a=b("h5"),i=O("Item "),d=O(r),c=C(),ae&&ae.c(),f=C(),Q&&Q.c(),l=C(),n=b("div"),u=b("div"),g=b("label"),E=O(p),V=C(),de(P.$$.fragment),U=C(),h=b("div"),y=b("label"),L=O(`Quantidade
                `),Y&&Y.c(),X=C(),de(I.$$.fragment),j=C(),B&&B.c(),H=C(),K&&K.c(),G=C(),fe&&fe.c(),ee=C(),this.h()},l(J){t=v(J,"DIV",{class:!0});var z=A(t);o=v(z,"DIV",{class:!0});var Z=A(o);a=v(Z,"H5",{class:!0});var N=A(a);i=S(N,"Item "),d=S(N,r),c=D(N),ae&&ae.l(N),N.forEach(_),f=D(Z),Q&&Q.l(Z),Z.forEach(_),l=D(z),n=v(z,"DIV",{class:!0});var oe=A(n);u=v(oe,"DIV",{class:!0});var me=A(u);g=v(me,"LABEL",{for:!0,class:!0});var pe=A(g);E=S(pe,p),pe.forEach(_),V=D(me),se(P.$$.fragment,me),me.forEach(_),U=D(oe),h=v(oe,"DIV",{});var re=A(h);y=v(re,"LABEL",{for:!0,class:!0});var De=A(y);L=S(De,`Quantidade
                `),Y&&Y.l(De),De.forEach(_),X=D(re),se(I.$$.fragment,re),re.forEach(_),j=D(oe),B&&B.l(oe),oe.forEach(_),H=D(z),K&&K.l(z),G=D(z),fe&&fe.l(z),ee=D(z),z.forEach(_),this.h()},h(){$(a,"class","text-sm font-medium text-gray-900 dark:text-white"),$(o,"class","flex items-start justify-between mb-4"),$(g,"for",w="item-select-"+e[25]),$(g,"class","block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"),$(u,"class","md:col-span-2"),$(y,"for",M="quantidade-"+e[25]),$(y,"class","block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"),$(n,"class","grid grid-cols-1 md:grid-cols-3 gap-4"),$(t,"class","w-full border border-gray-200 dark:border-gray-700 rounded-sm p-4 bg-white dark:bg-gray-800"),this.first=t},m(J,z){x(J,t,z),m(t,o),m(o,a),m(a,i),m(a,d),m(a,c),ae&&ae.m(a,null),m(o,f),Q&&Q.m(o,null),m(t,l),m(t,n),m(n,u),m(u,g),m(g,E),m(u,V),ne(P,u,null),m(n,U),m(n,h),m(h,y),m(y,L),Y&&Y.m(y,null),m(h,X),ne(I,h,null),m(n,j),B&&B.m(n,null),m(t,H),K&&K.m(t,null),m(t,G),fe&&fe.m(t,null),m(t,ee),ie=!0},p(J,z){e=J,(!ie||z&1)&&r!==(r=e[25]+1+"")&&W(d,r),e[23].equipamento_nome?ae?ae.p(e,z):(ae=Ge(e),ae.c(),ae.m(a,null)):ae&&(ae.d(1),ae=null),!e[1]&&e[0].length>1?Q?(Q.p(e,z),z&3&&T(Q,1)):(Q=Ye(e),Q.c(),T(Q,1),Q.m(o,null)):Q&&($e(),F(Q,1,1,()=>{Q=null}),Ae()),(!ie||z&128)&&p!==(p=e[7]?"Tipo de EPI":"Item do Estoque")&&W(E,p),(!ie||z&1&&w!==(w="item-select-"+e[25]))&&$(g,"for",w);const Z={};z&1&&(Z.id="item-select-"+e[25]),z&129&&(Z.value=e[7]?e[23].tipo_epi_id:e[23].estoque_item_id),z&2&&(Z.disabled=e[1]),z&536871052&&(Z.$$scope={dirty:z,ctx:e}),P.$set(Z),e[23].quantidade_disponivel!==void 0?Y?Y.p(e,z):(Y=tt(e),Y.c(),Y.m(y,null)):Y&&(Y.d(1),Y=null),(!ie||z&1&&M!==(M="quantidade-"+e[25]))&&$(y,"for",M);const N={};z&1&&(N.id="quantidade-"+e[25]),z&1&&(N.max=e[23].quantidade_disponivel||void 0),z&1&&(N.value=e[23].quantidade),z&2&&(N.disabled=e[1]),I.$set(N),e[4]?B?(B.p(e,z),z&16&&T(B,1)):(B=ot(e),B.c(),T(B,1),B.m(n,null)):B&&($e(),F(B,1,1,()=>{B=null}),Ae()),e[23].equipamento_nome?K?K.p(e,z):(K=at(e),K.c(),K.m(t,G)):K&&(K.d(1),K=null),e[6][e[23].temp_id]?fe?(fe.p(e,z),z&65&&T(fe,1)):(fe=st(e),fe.c(),T(fe,1),fe.m(t,ee)):fe&&($e(),F(fe,1,1,()=>{fe=null}),Ae())},i(J){ie||(T(Q),T(P.$$.fragment,J),T(I.$$.fragment,J),T(B),T(fe),ie=!0)},o(J){F(Q),F(P.$$.fragment,J),F(I.$$.fragment,J),F(B),F(fe),ie=!1},d(J){J&&_(t),ae&&ae.d(),Q&&Q.d(),le(P),Y&&Y.d(),le(I),B&&B.d(),K&&K.d(),fe&&fe.d()}}}function ct(s){let e,t,o,a,i,r=s[0].length+"",d,c,f=s[4]&&ut(s);return{c(){e=b("div"),t=b("div"),o=b("div"),a=b("span"),i=O("Total de Itens: "),d=O(r),c=C(),f&&f.c(),this.h()},l(l){e=v(l,"DIV",{class:!0});var n=A(e);t=v(n,"DIV",{class:!0});var u=A(t);o=v(u,"DIV",{class:!0});var g=A(o);a=v(g,"SPAN",{class:!0});var p=A(a);i=S(p,"Total de Itens: "),d=S(p,r),p.forEach(_),c=D(g),f&&f.l(g),g.forEach(_),u.forEach(_),n.forEach(_),this.h()},h(){$(a,"class","text-sm font-medium text-gray-900 dark:text-white"),$(o,"class","flex items-center space-x-4"),$(t,"class","flex justify-between items-center"),$(e,"class","w-full border border-gray-200 dark:border-gray-700 rounded-sm p-4 bg-gray-50 dark:bg-gray-800")},m(l,n){x(l,e,n),m(e,t),m(t,o),m(o,a),m(a,i),m(a,d),m(o,c),f&&f.m(o,null)},p(l,n){n&1&&r!==(r=l[0].length+"")&&W(d,r),l[4]?f?f.p(l,n):(f=ut(l),f.c(),f.m(o,null)):f&&(f.d(1),f=null)},d(l){l&&_(e),f&&f.d()}}}function ut(s){let e,t,o,a,i=s[0].reduce(s[17],0).toFixed(2)+"",r;return{c(){e=b("span"),t=O(`Valor Total: 
                `),o=b("span"),a=O("R$ "),r=O(i),this.h()},l(d){e=v(d,"SPAN",{class:!0});var c=A(e);t=S(c,`Valor Total: 
                `),o=v(c,"SPAN",{class:!0});var f=A(o);a=S(f,"R$ "),r=S(f,i),f.forEach(_),c.forEach(_),this.h()},h(){$(o,"class","text-lg font-bold text-green-600 dark:text-green-400"),$(e,"class","text-sm font-medium text-gray-900 dark:text-white")},m(d,c){x(d,e,c),m(e,t),m(e,o),m(o,a),m(o,r)},p(d,c){c&1&&i!==(i=d[0].reduce(d[17],0).toFixed(2)+"")&&W(r,i)},d(d){d&&_(e)}}}function qo(s){let e=s[7]?"Adicione EPIs do cat√°logo":"Selecione itens do estoque",t;return{c(){t=O(e)},l(o){t=S(o,e)},m(o,a){x(o,t,a)},p(o,a){a&128&&e!==(e=o[7]?"Adicione EPIs do cat√°logo":"Selecione itens do estoque")&&W(t,e)},d(o){o&&_(t)}}}function To(s){let e;return{c(){e=O("Esta nota n√£o possui itens registrados")},l(t){e=S(t,"Esta nota n√£o possui itens registrados")},m(t,o){x(t,e,o)},p:ye,d(t){t&&_(e)}}}function ft(s){let e,t;return e=new Gt({props:{size:"sm",color:"primary",class:"rounded-sm",$$slots:{default:[Po]},$$scope:{ctx:s}}}),e.$on("click",s[8]),{c(){de(e.$$.fragment)},l(o){se(e.$$.fragment,o)},m(o,a){ne(e,o,a),t=!0},p(o,a){const i={};a&536870912&&(i.$$scope={dirty:a,ctx:o}),e.$set(i)},i(o){t||(T(e.$$.fragment,o),t=!0)},o(o){F(e.$$.fragment,o),t=!1},d(o){le(e,o)}}}function Po(s){let e,t,o;return e=new Qe({props:{class:"w-4 h-4 mr-2"}}),{c(){de(e.$$.fragment),t=O(`
          Adicionar Primeiro Item`)},l(a){se(e.$$.fragment,a),t=S(a,`
          Adicionar Primeiro Item`)},m(a,i){ne(e,a,i),x(a,t,i),o=!0},p:ye,i(a){o||(T(e.$$.fragment,a),o=!0)},o(a){F(e.$$.fragment,a),o=!1},d(a){a&&_(t),le(e,a)}}}function So(s){let e,t,o,a,i=s[1]?"Nenhum item encontrado":"Nenhum item adicionado",r,d,c,f,l,n;t=new Qe({props:{class:"w-8 h-8 text-gray-400"}});function u(w,V){return w[1]?To:qo}let g=u(s),p=g(s),E=!s[1]&&ft(s);return{c(){e=b("div"),de(t.$$.fragment),o=C(),a=b("h3"),r=O(i),d=C(),c=b("p"),p.c(),f=C(),E&&E.c(),l=xe(),this.h()},l(w){e=v(w,"DIV",{class:!0});var V=A(e);se(t.$$.fragment,V),V.forEach(_),o=D(w),a=v(w,"H3",{class:!0});var P=A(a);r=S(P,i),P.forEach(_),d=D(w),c=v(w,"P",{class:!0});var U=A(c);p.l(U),U.forEach(_),f=D(w),E&&E.l(w),l=xe(),this.h()},h(){$(e,"class","w-16 h-16 mx-auto mb-4 bg-gray-100 dark:bg-gray-800 rounded-full flex items-center justify-center"),$(a,"class","text-lg font-medium text-gray-900 dark:text-white mb-2"),$(c,"class","text-gray-500 dark:text-gray-400 mb-4")},m(w,V){x(w,e,V),ne(t,e,null),x(w,o,V),x(w,a,V),m(a,r),x(w,d,V),x(w,c,V),p.m(c,null),x(w,f,V),E&&E.m(w,V),x(w,l,V),n=!0},p(w,V){(!n||V&2)&&i!==(i=w[1]?"Nenhum item encontrado":"Nenhum item adicionado")&&W(r,i),g===(g=u(w))&&p?p.p(w,V):(p.d(1),p=g(w),p&&(p.c(),p.m(c,null))),w[1]?E&&($e(),F(E,1,1,()=>{E=null}),Ae()):E?(E.p(w,V),V&2&&T(E,1)):(E=ft(w),E.c(),T(E,1),E.m(l.parentNode,l))},i(w){n||(T(t.$$.fragment,w),T(E),n=!0)},o(w){F(t.$$.fragment,w),F(E),n=!1},d(w){w&&(_(e),_(o),_(a),_(d),_(c),_(f),_(l)),le(t),p.d(),E&&E.d(w)}}}function Oo(s){let e,t,o,a,i,r,d,c,f,l=s[0].length>0&&We(s),n=!s[1]&&Xe(s);const u=[Co,Do,wo],g=[];function p(E,w){return E[5]?0:E[0].length===0?1:2}return d=p(s),c=g[d]=u[d](s),{c(){e=b("div"),t=b("div"),o=b("h4"),a=O(`Itens da Nota
      `),l&&l.c(),i=C(),n&&n.c(),r=C(),c.c(),this.h()},l(E){e=v(E,"DIV",{class:!0});var w=A(e);t=v(w,"DIV",{class:!0});var V=A(t);o=v(V,"H4",{class:!0});var P=A(o);a=S(P,`Itens da Nota
      `),l&&l.l(P),P.forEach(_),i=D(V),n&&n.l(V),V.forEach(_),r=D(w),c.l(w),w.forEach(_),this.h()},h(){$(o,"class","text-lg font-semibold text-gray-900 dark:text-white"),$(t,"class","flex items-center justify-between"),$(e,"class","space-y-4")},m(E,w){x(E,e,w),m(e,t),m(t,o),m(o,a),l&&l.m(o,null),m(t,i),n&&n.m(t,null),m(e,r),g[d].m(e,null),f=!0},p(E,[w]){E[0].length>0?l?(l.p(E,w),w&1&&T(l,1)):(l=We(E),l.c(),T(l,1),l.m(o,null)):l&&($e(),F(l,1,1,()=>{l=null}),Ae()),E[1]?n&&($e(),F(n,1,1,()=>{n=null}),Ae()):n?(n.p(E,w),w&2&&T(n,1)):(n=Xe(E),n.c(),T(n,1),n.m(t,null));let V=d;d=p(E),d===V?g[d].p(E,w):($e(),F(g[V],1,1,()=>{g[V]=null}),Ae(),c=g[d],c?c.p(E,w):(c=g[d]=u[d](E),c.c()),T(c,1),c.m(e,null))},i(E){f||(T(l),T(n),T(c),f=!0)},o(E){F(l),F(n),F(c),f=!1},d(E){E&&_(e),l&&l.d(),n&&n.d(),g[d].d()}}}function Ro(){return`temp_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}function Vo(s,e,t){let o,a,i,{tipo:r}=e,{almoxarifadoId:d}=e,{itens:c=[]}=e,{readonly:f=!1}=e;const l=Wt();let n=[],u=[],g=!1,p={};Xt(async()=>{console.log("üèóÔ∏è NotaItensManagerSimplified: Inicializando",{tipo:r,almoxarifadoId:d}),await E()});async function E(){if(!(!d&&!a))try{t(5,g=!0),a?(t(2,n=await to.obterOpcoesSelectComCache({apenasAtivos:!0})),console.log("üì¶ Tipos EPI carregados:",n.length)):(t(3,u=await oo.obterItensDisponiveisComCache(d)),console.log("üì¶ Itens de estoque carregados:",u.length))}catch(I){console.error("Erro ao carregar op√ß√µes:",I),l("validationError","Erro ao carregar op√ß√µes dispon√≠veis")}finally{t(5,g=!1)}}function w(){const I={temp_id:Ro(),quantidade:1,equipamento_nome:"",custo_unitario:o?0:void 0};a?I.tipo_epi_id="":I.estoque_item_id="",t(0,c=[...c,I]),l("itensChanged",c),console.log("‚ûï Item adicionado:",I.temp_id)}function V(I){const j=c[I];t(0,c=c.filter((H,G)=>G!==I)),j&&p[j.temp_id]&&(delete p[j.temp_id],t(6,p={...p})),l("itensChanged",c),console.log("‚ûñ Item removido:",j==null?void 0:j.temp_id)}function P(I,j,H){const G=c[I];if(G){if(G[j]=H,j==="tipo_epi_id"&&H){const ee=n.find(ie=>ie.value===H);ee&&(G.equipamento_nome=ee.label,G.categoria=ee.categoria,G.numero_ca=ee.numeroCA,ee.custoSugerido&&(!G.custo_unitario||G.custo_unitario===0)&&(G.custo_unitario=ee.custoSugerido))}else if(j==="estoque_item_id"&&H){const ee=u.find(ie=>ie.value===H);ee&&(G.equipamento_nome=ee.label,G.categoria=ee.categoria,G.numero_ca=ee.numeroCA,G.quantidade_disponivel=ee.quantidadeDisponivel)}U(G),t(0,c=[...c]),l("itensChanged",c)}}function U(I){if(t(6,p[I.temp_id]="",p),a&&!I.tipo_epi_id){t(6,p[I.temp_id]="Selecione um tipo de EPI",p);return}if(i&&!I.estoque_item_id){t(6,p[I.temp_id]="Selecione um item do estoque",p);return}if(!I.quantidade||I.quantidade<=0){t(6,p[I.temp_id]="Quantidade deve ser maior que zero",p);return}if(i&&I.quantidade_disponivel!==void 0&&I.quantidade>I.quantidade_disponivel){t(6,p[I.temp_id]=`Quantidade indispon√≠vel (m√°x: ${I.quantidade_disponivel})`,p);return}if(o&&(!I.custo_unitario||I.custo_unitario<=0)){t(6,p[I.temp_id]="Custo unit√°rio √© obrigat√≥rio para entradas",p);return}t(6,p[I.temp_id]="",p),l("validationError","")}const h=I=>V(I),y=(I,j)=>P(I,a?"tipo_epi_id":"estoque_item_id",j.target.value),L=(I,j)=>P(I,"quantidade",parseInt(j.target.value)||1),M=(I,j)=>P(I,"custo_unitario",parseFloat(j.target.value)||0),X=(I,j)=>{const H=j.quantidade||0,G=j.custo_unitario!=null&&typeof j.custo_unitario=="number"&&!isNaN(j.custo_unitario)?j.custo_unitario:0;return I+H*G};return s.$$set=I=>{"tipo"in I&&t(11,r=I.tipo),"almoxarifadoId"in I&&t(12,d=I.almoxarifadoId),"itens"in I&&t(0,c=I.itens),"readonly"in I&&t(1,f=I.readonly)},s.$$.update=()=>{s.$$.dirty&2048&&t(4,o=r==="ENTRADA"),s.$$.dirty&16&&t(7,a=o),s.$$.dirty&16&&(i=!o),s.$$.dirty&6144&&(r||d)&&E(),s.$$.dirty&15&&c.length===0&&!f&&(n.length>0||u.length>0)&&w()},[c,f,n,u,o,g,p,a,w,V,P,r,d,h,y,L,M,X]}class Fo extends Jt{constructor(e){super(),Zt(this,e,Vo,Oo,Kt,{tipo:11,almoxarifadoId:12,itens:0,readonly:1})}}function Me(s){return{ENTRADA:"Entrada",TRANSFERENCIA:"Transfer√™ncia",DESCARTE:"Descarte",ENTRADA_AJUSTE:"Entrada (Ajuste)",SAIDA_AJUSTE:"Sa√≠da (Ajuste)"}[s]||s}function $a(s){return{RASCUNHO:"Rascunho",CONCLUIDA:"Conclu√≠da",CANCELADA:"Cancelada"}[s]||s}function _t(s){return{ENTRADA:"green",TRANSFERENCIA:"blue",DESCARTE:"red",ENTRADA_AJUSTE:"yellow",SAIDA_AJUSTE:"dark"}[s]||"gray"}function Aa(s){return{RASCUNHO:"yellow",CONCLUIDA:"green",CANCELADA:"red"}[s]||"dark"}function mt(s,e,t){const o=s.slice();return o[53]=e[t],o}function pt(s,e,t){const o=s.slice();return o[53]=e[t],o}function gt(s,e,t){const o=s.slice();return o[53]=e[t],o}function ht(s,e,t){const o=s.slice();return o[50]=e[t],o[52]=t,o}function vt(s,e,t){const o=s.slice();return o[60]=e[t],o}function bt(s,e,t){const o=s.slice();return o[60]=e[t],o}function Lo(s){let e=s[9]&&(Object.keys(s[8]).length>0||s[7].length>0),t,o,a,i,r,d=e&&Et(s);const c=[jo,zo],f=[];function l(n,u){return n[0]==="view"?0:1}return a=l(s),i=f[a]=c[a](s),{c(){d&&d.c(),t=C(),o=b("div"),i.c(),this.h()},l(n){d&&d.l(n),t=D(n),o=v(n,"DIV",{class:!0});var u=A(o);i.l(u),u.forEach(_),this.h()},h(){$(o,"class","p-6 space-y-6")},m(n,u){d&&d.m(n,u),x(n,t,u),x(n,o,u),f[a].m(o,null),r=!0},p(n,u){u[0]&896&&(e=n[9]&&(Object.keys(n[8]).length>0||n[7].length>0)),e?d?(d.p(n,u),u[0]&896&&T(d,1)):(d=Et(n),d.c(),T(d,1),d.m(t.parentNode,t)):d&&($e(),F(d,1,1,()=>{d=null}),Ae());let g=a;a=l(n),a===g?f[a].p(n,u):($e(),F(f[g],1,1,()=>{f[g]=null}),Ae(),i=f[a],i?i.p(n,u):(i=f[a]=c[a](n),i.c()),T(i,1),i.m(o,null))},i(n){r||(T(d),T(i),r=!0)},o(n){F(d),F(i),r=!1},d(n){n&&(_(t),_(o)),d&&d.d(n),f[a].d()}}}function Uo(s){let e,t,o;return t=new uo({}),{c(){e=b("div"),de(t.$$.fragment),this.h()},l(a){e=v(a,"DIV",{class:!0});var i=A(e);se(t.$$.fragment,i),i.forEach(_),this.h()},h(){$(e,"class","flex justify-center items-center py-12")},m(a,i){x(a,e,i),ne(t,e,null),o=!0},p:ye,i(a){o||(T(t.$$.fragment,a),o=!0)},o(a){F(t.$$.fragment,a),o=!1},d(a){a&&_(e),le(t)}}}function Et(s){let e,t,o;return t=new eo({props:{color:"red",class:"rounded-sm",$$slots:{default:[Mo]},$$scope:{ctx:s}}}),{c(){e=b("div"),de(t.$$.fragment),this.h()},l(a){e=v(a,"DIV",{class:!0});var i=A(e);se(t.$$.fragment,i),i.forEach(_),this.h()},h(){$(e,"class","p-6 pb-0")},m(a,i){x(a,e,i),ne(t,e,null),o=!0},p(a,i){const r={};i[0]&384|i[2]&8&&(r.$$scope={dirty:i,ctx:a}),t.$set(r)},i(a){o||(T(t.$$.fragment,a),o=!0)},o(a){F(t.$$.fragment,a),o=!1},d(a){a&&_(e),le(t)}}}function $t(s){let e,t=s[60]+"",o;return{c(){e=b("li"),o=O(t)},l(a){e=v(a,"LI",{});var i=A(e);o=S(i,t),i.forEach(_)},m(a,i){x(a,e,i),m(e,o)},p(a,i){i[0]&256&&t!==(t=a[60]+"")&&W(o,t)},d(a){a&&_(e)}}}function At(s){let e,t=s[60]+"",o;return{c(){e=b("li"),o=O(t)},l(a){e=v(a,"LI",{});var i=A(e);o=S(i,t),i.forEach(_)},m(a,i){x(a,e,i),m(e,o)},p(a,i){i[0]&128&&t!==(t=a[60]+"")&&W(o,t)},d(a){a&&_(e)}}}function Mo(s){let e,t="Erros de valida√ß√£o:",o,a,i,r=Ie(Object.values(s[8])),d=[];for(let l=0;l<r.length;l+=1)d[l]=$t(bt(s,r,l));let c=Ie(s[7]),f=[];for(let l=0;l<c.length;l+=1)f[l]=At(vt(s,c,l));return{c(){e=b("span"),e.textContent=t,o=C(),a=b("ul");for(let l=0;l<d.length;l+=1)d[l].c();i=C();for(let l=0;l<f.length;l+=1)f[l].c();this.h()},l(l){e=v(l,"SPAN",{class:!0,"data-svelte-h":!0}),_e(e)!=="svelte-19ugpdw"&&(e.textContent=t),o=D(l),a=v(l,"UL",{class:!0});var n=A(a);for(let u=0;u<d.length;u+=1)d[u].l(n);i=D(n);for(let u=0;u<f.length;u+=1)f[u].l(n);n.forEach(_),this.h()},h(){$(e,"class","font-medium"),$(a,"class","mt-2 list-disc list-inside")},m(l,n){x(l,e,n),x(l,o,n),x(l,a,n);for(let u=0;u<d.length;u+=1)d[u]&&d[u].m(a,null);m(a,i);for(let u=0;u<f.length;u+=1)f[u]&&f[u].m(a,null)},p(l,n){if(n[0]&256){r=Ie(Object.values(l[8]));let u;for(u=0;u<r.length;u+=1){const g=bt(l,r,u);d[u]?d[u].p(g,n):(d[u]=$t(g),d[u].c(),d[u].m(a,i))}for(;u<d.length;u+=1)d[u].d(1);d.length=r.length}if(n[0]&128){c=Ie(l[7]);let u;for(u=0;u<c.length;u+=1){const g=vt(l,c,u);f[u]?f[u].p(g,n):(f[u]=At(g),f[u].c(),f[u].m(a,null))}for(;u<f.length;u+=1)f[u].d(1);f.length=c.length}},d(l){l&&(_(e),_(o),_(a)),Le(d,l),Le(f,l)}}}function zo(s){let e,t,o="Dados da Nota",a,i,r,d,c,f,l,n,u,g,p,E,w,V,P,U,h,y,L,M,X,I,j,H,G,ee,ie,ae,Q,ke,Y,ce,B;d=new Pe({props:{for:"tipo_nota",class:"mb-2 text-gray-900 dark:text-white",$$slots:{default:[Bo]},$$scope:{ctx:s}}});function K(k){s[34](k)}let fe={id:"tipo_nota",disabled:s[0]==="view",class:"rounded-sm "+(s[8].tipo_nota?"border-red-500":""),$$slots:{default:[Ho]},$$scope:{ctx:s}};s[1].tipo_nota!==void 0&&(fe.value=s[1].tipo_nota),f=new Yt({props:fe}),Oe.push(()=>Re(f,"value",K));let J=s[8].tipo_nota&&xt(s);p=new Pe({props:{for:"data_documento",class:"mb-2 text-gray-900 dark:text-white",$$slots:{default:[Qo]},$$scope:{ctx:s}}});function z(k){s[35](k)}let Z={id:"data_documento",type:"date",size:"md",disabled:s[0]==="view",class:"rounded-sm h-10 text-sm "+(s[8].data_documento?"border-red-500":"")};s[1].data_documento!==void 0&&(Z.value=s[1].data_documento),w=new He({props:Z}),Oe.push(()=>Re(w,"value",z));let N=s[8].data_documento&&kt(s);const oe=[Zo,Jo],me=[];function pe(k,R){return k[1].tipo_nota==="ENTRADA"?0:1}h=pe(s),y=me[h]=oe[h](s);let re=s[1].tipo_nota==="TRANSFERENCIA"&&qt(s);I=new Pe({props:{for:"observacoes",class:"mb-2 text-gray-900 dark:text-white",$$slots:{default:[ta]},$$scope:{ctx:s}}});function De(k){s[39](k)}let Ee={id:"observacoes",disabled:s[0]==="view",placeholder:"Observa√ß√µes sobre a movimenta√ß√£o...",rows:"3",class:"rounded-sm "+(s[8].observacoes?"border-red-500":"")};s[1].observacoes!==void 0&&(Ee.value=s[1].observacoes),H=new mo({props:Ee}),Oe.push(()=>Re(H,"value",De));let ge=s[8].observacoes&&Ot(s);function qe(k){s[40](k)}let Ce={tipo:s[1].tipo_nota,almoxarifadoId:s[1].tipo_nota==="ENTRADA"?s[1].almoxarifado_destino_id:s[1].almoxarifado_origem_id,readonly:s[0]==="view"};s[2]!==void 0&&(Ce.itens=s[2]),Q=new Fo({props:Ce}),Oe.push(()=>Re(Q,"itens",qe)),Q.$on("itensChanged",s[20]),Q.$on("validationError",s[21]);let q=s[5]>0&&Rt(s);return{c(){e=b("div"),t=b("h3"),t.textContent=o,a=C(),i=b("div"),r=b("div"),de(d.$$.fragment),c=C(),de(f.$$.fragment),n=C(),J&&J.c(),u=C(),g=b("div"),de(p.$$.fragment),E=C(),de(w.$$.fragment),P=C(),N&&N.c(),U=C(),y.c(),L=C(),re&&re.c(),M=C(),X=b("div"),de(I.$$.fragment),j=C(),de(H.$$.fragment),ee=C(),ge&&ge.c(),ie=C(),ae=b("div"),de(Q.$$.fragment),Y=C(),q&&q.c(),ce=xe(),this.h()},l(k){e=v(k,"DIV",{class:!0});var R=A(e);t=v(R,"H3",{class:!0,"data-svelte-h":!0}),_e(t)!=="svelte-in15tf"&&(t.textContent=o),a=D(R),i=v(R,"DIV",{class:!0});var ue=A(i);r=v(ue,"DIV",{});var be=A(r);se(d.$$.fragment,be),c=D(be),se(f.$$.fragment,be),n=D(be),J&&J.l(be),be.forEach(_),u=D(ue),g=v(ue,"DIV",{});var te=A(g);se(p.$$.fragment,te),E=D(te),se(w.$$.fragment,te),P=D(te),N&&N.l(te),te.forEach(_),U=D(ue),y.l(ue),L=D(ue),re&&re.l(ue),ue.forEach(_),M=D(R),X=v(R,"DIV",{});var he=A(X);se(I.$$.fragment,he),j=D(he),se(H.$$.fragment,he),ee=D(he),ge&&ge.l(he),he.forEach(_),R.forEach(_),ie=D(k),ae=v(k,"DIV",{class:!0});var we=A(ae);se(Q.$$.fragment,we),we.forEach(_),Y=D(k),q&&q.l(k),ce=xe(),this.h()},h(){$(t,"class","text-lg font-semibold text-gray-900 dark:text-white"),$(i,"class","grid grid-cols-1 md:grid-cols-2 gap-4"),$(e,"class","space-y-4"),$(ae,"class","border-t border-gray-200 dark:border-gray-700 pt-6")},m(k,R){x(k,e,R),m(e,t),m(e,a),m(e,i),m(i,r),ne(d,r,null),m(r,c),ne(f,r,null),m(r,n),J&&J.m(r,null),m(i,u),m(i,g),ne(p,g,null),m(g,E),ne(w,g,null),m(g,P),N&&N.m(g,null),m(i,U),me[h].m(i,null),m(i,L),re&&re.m(i,null),m(e,M),m(e,X),ne(I,X,null),m(X,j),ne(H,X,null),m(X,ee),ge&&ge.m(X,null),x(k,ie,R),x(k,ae,R),ne(Q,ae,null),x(k,Y,R),q&&q.m(k,R),x(k,ce,R),B=!0},p(k,R){const ue={};R[2]&8&&(ue.$$scope={dirty:R,ctx:k}),d.$set(ue);const be={};R[0]&1&&(be.disabled=k[0]==="view"),R[0]&256&&(be.class="rounded-sm "+(k[8].tipo_nota?"border-red-500":"")),R[2]&8&&(be.$$scope={dirty:R,ctx:k}),!l&&R[0]&2&&(l=!0,be.value=k[1].tipo_nota,Ve(()=>l=!1)),f.$set(be),k[8].tipo_nota?J?J.p(k,R):(J=xt(k),J.c(),J.m(r,null)):J&&(J.d(1),J=null);const te={};R[2]&8&&(te.$$scope={dirty:R,ctx:k}),p.$set(te);const he={};R[0]&1&&(he.disabled=k[0]==="view"),R[0]&256&&(he.class="rounded-sm h-10 text-sm "+(k[8].data_documento?"border-red-500":"")),!V&&R[0]&2&&(V=!0,he.value=k[1].data_documento,Ve(()=>V=!1)),w.$set(he),k[8].data_documento?N?N.p(k,R):(N=kt(k),N.c(),N.m(g,null)):N&&(N.d(1),N=null);let we=h;h=pe(k),h===we?me[h].p(k,R):($e(),F(me[we],1,1,()=>{me[we]=null}),Ae(),y=me[h],y?y.p(k,R):(y=me[h]=oe[h](k),y.c()),T(y,1),y.m(i,L)),k[1].tipo_nota==="TRANSFERENCIA"?re?(re.p(k,R),R[0]&2&&T(re,1)):(re=qt(k),re.c(),T(re,1),re.m(i,null)):re&&($e(),F(re,1,1,()=>{re=null}),Ae());const Te={};R[2]&8&&(Te.$$scope={dirty:R,ctx:k}),I.$set(Te);const Ne={};R[0]&1&&(Ne.disabled=k[0]==="view"),R[0]&256&&(Ne.class="rounded-sm "+(k[8].observacoes?"border-red-500":"")),!G&&R[0]&2&&(G=!0,Ne.value=k[1].observacoes,Ve(()=>G=!1)),H.$set(Ne),k[8].observacoes?ge?ge.p(k,R):(ge=Ot(k),ge.c(),ge.m(X,null)):ge&&(ge.d(1),ge=null);const Fe={};R[0]&2&&(Fe.tipo=k[1].tipo_nota),R[0]&2&&(Fe.almoxarifadoId=k[1].tipo_nota==="ENTRADA"?k[1].almoxarifado_destino_id:k[1].almoxarifado_origem_id),R[0]&1&&(Fe.readonly=k[0]==="view"),!ke&&R[0]&4&&(ke=!0,Fe.itens=k[2],Ve(()=>ke=!1)),Q.$set(Fe),k[5]>0?q?q.p(k,R):(q=Rt(k),q.c(),q.m(ce.parentNode,ce)):q&&(q.d(1),q=null)},i(k){B||(T(d.$$.fragment,k),T(f.$$.fragment,k),T(p.$$.fragment,k),T(w.$$.fragment,k),T(y),T(re),T(I.$$.fragment,k),T(H.$$.fragment,k),T(Q.$$.fragment,k),B=!0)},o(k){F(d.$$.fragment,k),F(f.$$.fragment,k),F(p.$$.fragment,k),F(w.$$.fragment,k),F(y),F(re),F(I.$$.fragment,k),F(H.$$.fragment,k),F(Q.$$.fragment,k),B=!1},d(k){k&&(_(e),_(ie),_(ae),_(Y),_(ce)),le(d),le(f),J&&J.d(),le(p),le(w),N&&N.d(),me[h].d(),re&&re.d(),le(I),le(H),ge&&ge.d(),le(Q),q&&q.d(k)}}}function jo(s){let e,t,o="Informa√ß√µes da Nota",a,i,r,d,c,f="Tipo de Nota",l,n,u,g,p,E,w="Data do Documento",V,P,U=new Date(s[1].data_documento).toLocaleDateString("pt-BR")+"",h,y,L,M,X,I,j,H,G,ee,ie,ae,Q,ke;u=new je({props:{color:_t(s[1].tipo_nota),class:"w-fit rounded-sm font-medium",$$slots:{default:[oa]},$$scope:{ctx:s}}});let Y=s[1].almoxarifado_origem_id&&Vt(s),ce=s[1].almoxarifado_destino_id&&Lt(s),B=s[1].observacoes&&Mt(s),K=s[5]>0&&zt(s);const fe=[ra,ia],J=[];function z(N,oe){return N[2].length===0?0:1}ee=z(s),ie=J[ee]=fe[ee](s);let Z=s[5]>0&&Ht(s);return{c(){e=b("div"),t=b("h3"),t.textContent=o,a=C(),i=b("div"),r=b("div"),d=b("div"),c=b("dt"),c.textContent=f,l=C(),n=b("dd"),de(u.$$.fragment),g=C(),p=b("div"),E=b("dt"),E.textContent=w,V=C(),P=b("dd"),h=O(U),y=C(),Y&&Y.c(),L=C(),ce&&ce.c(),M=C(),B&&B.c(),X=C(),I=b("div"),j=b("h3"),H=O(`Itens da Nota
            `),K&&K.c(),G=C(),ie.c(),ae=C(),Z&&Z.c(),Q=xe(),this.h()},l(N){e=v(N,"DIV",{class:!0});var oe=A(e);t=v(oe,"H3",{class:!0,"data-svelte-h":!0}),_e(t)!=="svelte-8lkdze"&&(t.textContent=o),a=D(oe),i=v(oe,"DIV",{class:!0});var me=A(i);r=v(me,"DIV",{class:!0});var pe=A(r);d=v(pe,"DIV",{});var re=A(d);c=v(re,"DT",{class:!0,"data-svelte-h":!0}),_e(c)!=="svelte-pciq5c"&&(c.textContent=f),l=D(re),n=v(re,"DD",{class:!0});var De=A(n);se(u.$$.fragment,De),De.forEach(_),re.forEach(_),g=D(pe),p=v(pe,"DIV",{});var Ee=A(p);E=v(Ee,"DT",{class:!0,"data-svelte-h":!0}),_e(E)!=="svelte-1vn6ac2"&&(E.textContent=w),V=D(Ee),P=v(Ee,"DD",{class:!0});var ge=A(P);h=S(ge,U),ge.forEach(_),Ee.forEach(_),y=D(pe),Y&&Y.l(pe),L=D(pe),ce&&ce.l(pe),M=D(pe),B&&B.l(pe),pe.forEach(_),me.forEach(_),oe.forEach(_),X=D(N),I=v(N,"DIV",{class:!0});var qe=A(I);j=v(qe,"H3",{class:!0});var Ce=A(j);H=S(Ce,`Itens da Nota
            `),K&&K.l(Ce),Ce.forEach(_),G=D(qe),ie.l(qe),qe.forEach(_),ae=D(N),Z&&Z.l(N),Q=xe(),this.h()},h(){$(t,"class","text-lg font-semibold text-gray-900 dark:text-white"),$(c,"class","text-sm font-medium text-gray-500 dark:text-gray-400"),$(n,"class","mt-1 text-sm text-gray-900 dark:text-white"),$(E,"class","text-sm font-medium text-gray-500 dark:text-gray-400"),$(P,"class","mt-1 text-sm text-gray-900 dark:text-white"),$(r,"class","grid grid-cols-1 md:grid-cols-2 gap-6"),$(i,"class","bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4"),$(e,"class","space-y-4"),$(j,"class","text-lg font-semibold text-gray-900 dark:text-white"),$(I,"class","space-y-4")},m(N,oe){x(N,e,oe),m(e,t),m(e,a),m(e,i),m(i,r),m(r,d),m(d,c),m(d,l),m(d,n),ne(u,n,null),m(r,g),m(r,p),m(p,E),m(p,V),m(p,P),m(P,h),m(r,y),Y&&Y.m(r,null),m(r,L),ce&&ce.m(r,null),m(r,M),B&&B.m(r,null),x(N,X,oe),x(N,I,oe),m(I,j),m(j,H),K&&K.m(j,null),m(I,G),J[ee].m(I,null),x(N,ae,oe),Z&&Z.m(N,oe),x(N,Q,oe),ke=!0},p(N,oe){const me={};oe[0]&2&&(me.color=_t(N[1].tipo_nota)),oe[0]&2|oe[2]&8&&(me.$$scope={dirty:oe,ctx:N}),u.$set(me),(!ke||oe[0]&2)&&U!==(U=new Date(N[1].data_documento).toLocaleDateString("pt-BR")+"")&&W(h,U),N[1].almoxarifado_origem_id?Y?Y.p(N,oe):(Y=Vt(N),Y.c(),Y.m(r,L)):Y&&(Y.d(1),Y=null),N[1].almoxarifado_destino_id?ce?ce.p(N,oe):(ce=Lt(N),ce.c(),ce.m(r,M)):ce&&(ce.d(1),ce=null),N[1].observacoes?B?B.p(N,oe):(B=Mt(N),B.c(),B.m(r,null)):B&&(B.d(1),B=null),N[5]>0?K?(K.p(N,oe),oe[0]&32&&T(K,1)):(K=zt(N),K.c(),T(K,1),K.m(j,null)):K&&($e(),F(K,1,1,()=>{K=null}),Ae());let pe=ee;ee=z(N),ee===pe?J[ee].p(N,oe):($e(),F(J[pe],1,1,()=>{J[pe]=null}),Ae(),ie=J[ee],ie?ie.p(N,oe):(ie=J[ee]=fe[ee](N),ie.c()),T(ie,1),ie.m(I,null)),N[5]>0?Z?Z.p(N,oe):(Z=Ht(N),Z.c(),Z.m(Q.parentNode,Q)):Z&&(Z.d(1),Z=null)},i(N){ke||(T(u.$$.fragment,N),T(K),T(ie),ke=!0)},o(N){F(u.$$.fragment,N),F(K),F(ie),ke=!1},d(N){N&&(_(e),_(X),_(I),_(ae),_(Q)),le(u),Y&&Y.d(),ce&&ce.d(),B&&B.d(),K&&K.d(),J[ee].d(),Z&&Z.d(N)}}}function Bo(s){let e;return{c(){e=O("Tipo de Nota")},l(t){e=S(t,"Tipo de Nota")},m(t,o){x(t,e,o)},d(t){t&&_(e)}}}function Ho(s){let e,t="Entrada",o,a,i="Transfer√™ncia",r,d,c="Descarte";return{c(){e=b("option"),e.textContent=t,o=C(),a=b("option"),a.textContent=i,r=C(),d=b("option"),d.textContent=c,this.h()},l(f){e=v(f,"OPTION",{"data-svelte-h":!0}),_e(e)!=="svelte-qgq2us"&&(e.textContent=t),o=D(f),a=v(f,"OPTION",{"data-svelte-h":!0}),_e(a)!=="svelte-4m889r"&&(a.textContent=i),r=D(f),d=v(f,"OPTION",{"data-svelte-h":!0}),_e(d)!=="svelte-urwv3a"&&(d.textContent=c),this.h()},h(){e.__value="ENTRADA",Ue(e,e.__value),a.__value="TRANSFERENCIA",Ue(a,a.__value),d.__value="DESCARTE",Ue(d,d.__value)},m(f,l){x(f,e,l),x(f,o,l),x(f,a,l),x(f,r,l),x(f,d,l)},p:ye,d(f){f&&(_(e),_(o),_(a),_(r),_(d))}}}function xt(s){let e,t=s[8].tipo_nota+"",o;return{c(){e=b("p"),o=O(t),this.h()},l(a){e=v(a,"P",{class:!0});var i=A(e);o=S(i,t),i.forEach(_),this.h()},h(){$(e,"class","text-red-500 dark:text-red-400 text-sm mt-1")},m(a,i){x(a,e,i),m(e,o)},p(a,i){i[0]&256&&t!==(t=a[8].tipo_nota+"")&&W(o,t)},d(a){a&&_(e)}}}function Qo(s){let e;return{c(){e=O("Data do Documento")},l(t){e=S(t,"Data do Documento")},m(t,o){x(t,e,o)},d(t){t&&_(e)}}}function kt(s){let e,t=s[8].data_documento+"",o;return{c(){e=b("p"),o=O(t),this.h()},l(a){e=v(a,"P",{class:!0});var i=A(e);o=S(i,t),i.forEach(_),this.h()},h(){$(e,"class","text-red-500 dark:text-red-400 text-sm mt-1")},m(a,i){x(a,e,i),m(e,o)},p(a,i){i[0]&256&&t!==(t=a[8].data_documento+"")&&W(o,t)},d(a){a&&_(e)}}}function Jo(s){let e,t,o,a,i,r;t=new Pe({props:{class:"mb-3 text-gray-900 dark:text-white",$$slots:{default:[Ko]},$$scope:{ctx:s}}});let d=Ie(s[10]),c=[];for(let n=0;n<d.length;n+=1)c[n]=wt(pt(s,d,n));const f=n=>F(c[n],1,1,()=>{c[n]=null});let l=s[8].almoxarifado_origem_id&&Dt(s);return{c(){e=b("div"),de(t.$$.fragment),o=C(),a=b("div");for(let n=0;n<c.length;n+=1)c[n].c();i=C(),l&&l.c(),this.h()},l(n){e=v(n,"DIV",{});var u=A(e);se(t.$$.fragment,u),o=D(u),a=v(u,"DIV",{class:!0});var g=A(a);for(let p=0;p<c.length;p+=1)c[p].l(g);g.forEach(_),i=D(u),l&&l.l(u),u.forEach(_),this.h()},h(){$(a,"class","space-y-2")},m(n,u){x(n,e,u),ne(t,e,null),m(e,o),m(e,a);for(let g=0;g<c.length;g+=1)c[g]&&c[g].m(a,null);m(e,i),l&&l.m(e,null),r=!0},p(n,u){const g={};if(u[2]&8&&(g.$$scope={dirty:u,ctx:n}),t.$set(g),u[0]&1027){d=Ie(n[10]);let p;for(p=0;p<d.length;p+=1){const E=pt(n,d,p);c[p]?(c[p].p(E,u),T(c[p],1)):(c[p]=wt(E),c[p].c(),T(c[p],1),c[p].m(a,null))}for($e(),p=d.length;p<c.length;p+=1)f(p);Ae()}n[8].almoxarifado_origem_id?l?l.p(n,u):(l=Dt(n),l.c(),l.m(e,null)):l&&(l.d(1),l=null)},i(n){if(!r){T(t.$$.fragment,n);for(let u=0;u<d.length;u+=1)T(c[u]);r=!0}},o(n){F(t.$$.fragment,n),c=c.filter(Boolean);for(let u=0;u<c.length;u+=1)F(c[u]);r=!1},d(n){n&&_(e),le(t),Le(c,n),l&&l.d()}}}function Zo(s){let e,t,o,a,i,r;t=new Pe({props:{class:"mb-3 text-gray-900 dark:text-white",$$slots:{default:[Xo]},$$scope:{ctx:s}}});let d=Ie(s[10]),c=[];for(let n=0;n<d.length;n+=1)c[n]=Nt(gt(s,d,n));const f=n=>F(c[n],1,1,()=>{c[n]=null});let l=s[8].almoxarifado_destino_id&&yt(s);return{c(){e=b("div"),de(t.$$.fragment),o=C(),a=b("div");for(let n=0;n<c.length;n+=1)c[n].c();i=C(),l&&l.c(),this.h()},l(n){e=v(n,"DIV",{});var u=A(e);se(t.$$.fragment,u),o=D(u),a=v(u,"DIV",{class:!0});var g=A(a);for(let p=0;p<c.length;p+=1)c[p].l(g);g.forEach(_),i=D(u),l&&l.l(u),u.forEach(_),this.h()},h(){$(a,"class","space-y-2")},m(n,u){x(n,e,u),ne(t,e,null),m(e,o),m(e,a);for(let g=0;g<c.length;g+=1)c[g]&&c[g].m(a,null);m(e,i),l&&l.m(e,null),r=!0},p(n,u){const g={};if(u[2]&8&&(g.$$scope={dirty:u,ctx:n}),t.$set(g),u[0]&1027){d=Ie(n[10]);let p;for(p=0;p<d.length;p+=1){const E=gt(n,d,p);c[p]?(c[p].p(E,u),T(c[p],1)):(c[p]=Nt(E),c[p].c(),T(c[p],1),c[p].m(a,null))}for($e(),p=d.length;p<c.length;p+=1)f(p);Ae()}n[8].almoxarifado_destino_id?l?l.p(n,u):(l=yt(n),l.c(),l.m(e,null)):l&&(l.d(1),l=null)},i(n){if(!r){T(t.$$.fragment,n);for(let u=0;u<d.length;u+=1)T(c[u]);r=!0}},o(n){F(t.$$.fragment,n),c=c.filter(Boolean);for(let u=0;u<c.length;u+=1)F(c[u]);r=!1},d(n){n&&_(e),le(t),Le(c,n),l&&l.d()}}}function Ko(s){let e;return{c(){e=O("Almoxarifado de Origem")},l(t){e=S(t,"Almoxarifado de Origem")},m(t,o){x(t,e,o)},d(t){t&&_(e)}}}function It(s){let e,t="(Principal)";return{c(){e=b("span"),e.textContent=t,this.h()},l(o){e=v(o,"SPAN",{class:!0,"data-svelte-h":!0}),_e(e)!=="svelte-quypfn"&&(e.textContent=t),this.h()},h(){$(e,"class","text-xs text-primary-600 dark:text-primary-400 font-medium ml-1")},m(o,a){x(o,e,a)},d(o){o&&_(e)}}}function Wo(s){let e=s[53].label+"",t,o,a,i=s[53].isPrincipal&&It();return{c(){t=O(e),o=C(),i&&i.c(),a=xe()},l(r){t=S(r,e),o=D(r),i&&i.l(r),a=xe()},m(r,d){x(r,t,d),x(r,o,d),i&&i.m(r,d),x(r,a,d)},p(r,d){d[0]&1024&&e!==(e=r[53].label+"")&&W(t,e),r[53].isPrincipal?i||(i=It(),i.c(),i.m(a.parentNode,a)):i&&(i.d(1),i=null)},d(r){r&&(_(t),_(o),_(a)),i&&i.d(r)}}}function wt(s){let e,t,o,a,i,r,d;function c(l){s[37](l)}let f={name:"almoxarifado_origem_id",value:s[53].value,disabled:s[0]==="view",class:"text-primary-600 focus:ring-primary-500"};return s[1].almoxarifado_origem_id!==void 0&&(f.group=s[1].almoxarifado_origem_id),t=new Be({props:f}),Oe.push(()=>Re(t,"group",c)),i=new Pe({props:{class:"ml-2 text-sm text-gray-900 dark:text-white",$$slots:{default:[Wo]},$$scope:{ctx:s}}}),{c(){e=b("div"),de(t.$$.fragment),a=C(),de(i.$$.fragment),r=C(),this.h()},l(l){e=v(l,"DIV",{class:!0});var n=A(e);se(t.$$.fragment,n),a=D(n),se(i.$$.fragment,n),r=D(n),n.forEach(_),this.h()},h(){$(e,"class","flex items-center")},m(l,n){x(l,e,n),ne(t,e,null),m(e,a),ne(i,e,null),m(e,r),d=!0},p(l,n){const u={};n[0]&1024&&(u.value=l[53].value),n[0]&1&&(u.disabled=l[0]==="view"),!o&&n[0]&2&&(o=!0,u.group=l[1].almoxarifado_origem_id,Ve(()=>o=!1)),t.$set(u);const g={};n[0]&1024|n[2]&8&&(g.$$scope={dirty:n,ctx:l}),i.$set(g)},i(l){d||(T(t.$$.fragment,l),T(i.$$.fragment,l),d=!0)},o(l){F(t.$$.fragment,l),F(i.$$.fragment,l),d=!1},d(l){l&&_(e),le(t),le(i)}}}function Dt(s){let e,t=s[8].almoxarifado_origem_id+"",o;return{c(){e=b("p"),o=O(t),this.h()},l(a){e=v(a,"P",{class:!0});var i=A(e);o=S(i,t),i.forEach(_),this.h()},h(){$(e,"class","text-red-500 dark:text-red-400 text-sm mt-2")},m(a,i){x(a,e,i),m(e,o)},p(a,i){i[0]&256&&t!==(t=a[8].almoxarifado_origem_id+"")&&W(o,t)},d(a){a&&_(e)}}}function Xo(s){let e;return{c(){e=O("Almoxarifado de Destino")},l(t){e=S(t,"Almoxarifado de Destino")},m(t,o){x(t,e,o)},d(t){t&&_(e)}}}function Ct(s){let e,t="(Principal)";return{c(){e=b("span"),e.textContent=t,this.h()},l(o){e=v(o,"SPAN",{class:!0,"data-svelte-h":!0}),_e(e)!=="svelte-quypfn"&&(e.textContent=t),this.h()},h(){$(e,"class","text-xs text-primary-600 dark:text-primary-400 font-medium ml-1")},m(o,a){x(o,e,a)},d(o){o&&_(e)}}}function Go(s){let e=s[53].label+"",t,o,a,i=s[53].isPrincipal&&Ct();return{c(){t=O(e),o=C(),i&&i.c(),a=xe()},l(r){t=S(r,e),o=D(r),i&&i.l(r),a=xe()},m(r,d){x(r,t,d),x(r,o,d),i&&i.m(r,d),x(r,a,d)},p(r,d){d[0]&1024&&e!==(e=r[53].label+"")&&W(t,e),r[53].isPrincipal?i||(i=Ct(),i.c(),i.m(a.parentNode,a)):i&&(i.d(1),i=null)},d(r){r&&(_(t),_(o),_(a)),i&&i.d(r)}}}function Nt(s){let e,t,o,a,i,r,d;function c(l){s[36](l)}let f={name:"almoxarifado_destino_id",value:s[53].value,disabled:s[0]==="view",class:"text-primary-600 focus:ring-primary-500"};return s[1].almoxarifado_destino_id!==void 0&&(f.group=s[1].almoxarifado_destino_id),t=new Be({props:f}),Oe.push(()=>Re(t,"group",c)),i=new Pe({props:{class:"ml-2 text-sm text-gray-900 dark:text-white",$$slots:{default:[Go]},$$scope:{ctx:s}}}),{c(){e=b("div"),de(t.$$.fragment),a=C(),de(i.$$.fragment),r=C(),this.h()},l(l){e=v(l,"DIV",{class:!0});var n=A(e);se(t.$$.fragment,n),a=D(n),se(i.$$.fragment,n),r=D(n),n.forEach(_),this.h()},h(){$(e,"class","flex items-center")},m(l,n){x(l,e,n),ne(t,e,null),m(e,a),ne(i,e,null),m(e,r),d=!0},p(l,n){const u={};n[0]&1024&&(u.value=l[53].value),n[0]&1&&(u.disabled=l[0]==="view"),!o&&n[0]&2&&(o=!0,u.group=l[1].almoxarifado_destino_id,Ve(()=>o=!1)),t.$set(u);const g={};n[0]&1024|n[2]&8&&(g.$$scope={dirty:n,ctx:l}),i.$set(g)},i(l){d||(T(t.$$.fragment,l),T(i.$$.fragment,l),d=!0)},o(l){F(t.$$.fragment,l),F(i.$$.fragment,l),d=!1},d(l){l&&_(e),le(t),le(i)}}}function yt(s){let e,t=s[8].almoxarifado_destino_id+"",o;return{c(){e=b("p"),o=O(t),this.h()},l(a){e=v(a,"P",{class:!0});var i=A(e);o=S(i,t),i.forEach(_),this.h()},h(){$(e,"class","text-red-500 dark:text-red-400 text-sm mt-2")},m(a,i){x(a,e,i),m(e,o)},p(a,i){i[0]&256&&t!==(t=a[8].almoxarifado_destino_id+"")&&W(o,t)},d(a){a&&_(e)}}}function qt(s){let e,t,o,a,i,r;t=new Pe({props:{class:"mb-3 text-gray-900 dark:text-white",$$slots:{default:[Yo]},$$scope:{ctx:s}}});let d=Ie(s[11]),c=[];for(let n=0;n<d.length;n+=1)c[n]=Pt(mt(s,d,n));const f=n=>F(c[n],1,1,()=>{c[n]=null});let l=s[8].almoxarifado_destino_id&&St(s);return{c(){e=b("div"),de(t.$$.fragment),o=C(),a=b("div");for(let n=0;n<c.length;n+=1)c[n].c();i=C(),l&&l.c(),this.h()},l(n){e=v(n,"DIV",{});var u=A(e);se(t.$$.fragment,u),o=D(u),a=v(u,"DIV",{class:!0});var g=A(a);for(let p=0;p<c.length;p+=1)c[p].l(g);g.forEach(_),i=D(u),l&&l.l(u),u.forEach(_),this.h()},h(){$(a,"class","space-y-2")},m(n,u){x(n,e,u),ne(t,e,null),m(e,o),m(e,a);for(let g=0;g<c.length;g+=1)c[g]&&c[g].m(a,null);m(e,i),l&&l.m(e,null),r=!0},p(n,u){const g={};if(u[2]&8&&(g.$$scope={dirty:u,ctx:n}),t.$set(g),u[0]&2051){d=Ie(n[11]);let p;for(p=0;p<d.length;p+=1){const E=mt(n,d,p);c[p]?(c[p].p(E,u),T(c[p],1)):(c[p]=Pt(E),c[p].c(),T(c[p],1),c[p].m(a,null))}for($e(),p=d.length;p<c.length;p+=1)f(p);Ae()}n[8].almoxarifado_destino_id?l?l.p(n,u):(l=St(n),l.c(),l.m(e,null)):l&&(l.d(1),l=null)},i(n){if(!r){T(t.$$.fragment,n);for(let u=0;u<d.length;u+=1)T(c[u]);r=!0}},o(n){F(t.$$.fragment,n),c=c.filter(Boolean);for(let u=0;u<c.length;u+=1)F(c[u]);r=!1},d(n){n&&_(e),le(t),Le(c,n),l&&l.d()}}}function Yo(s){let e;return{c(){e=O("Almoxarifado de Destino")},l(t){e=S(t,"Almoxarifado de Destino")},m(t,o){x(t,e,o)},d(t){t&&_(e)}}}function Tt(s){let e,t="(Principal)";return{c(){e=b("span"),e.textContent=t,this.h()},l(o){e=v(o,"SPAN",{class:!0,"data-svelte-h":!0}),_e(e)!=="svelte-quypfn"&&(e.textContent=t),this.h()},h(){$(e,"class","text-xs text-primary-600 dark:text-primary-400 font-medium ml-1")},m(o,a){x(o,e,a)},d(o){o&&_(e)}}}function ea(s){let e=s[53].label+"",t,o,a,i=s[53].isPrincipal&&Tt();return{c(){t=O(e),o=C(),i&&i.c(),a=xe()},l(r){t=S(r,e),o=D(r),i&&i.l(r),a=xe()},m(r,d){x(r,t,d),x(r,o,d),i&&i.m(r,d),x(r,a,d)},p(r,d){d[0]&2048&&e!==(e=r[53].label+"")&&W(t,e),r[53].isPrincipal?i||(i=Tt(),i.c(),i.m(a.parentNode,a)):i&&(i.d(1),i=null)},d(r){r&&(_(t),_(o),_(a)),i&&i.d(r)}}}function Pt(s){let e,t,o,a,i,r,d;function c(l){s[38](l)}let f={name:"almoxarifado_destino_id",value:s[53].value,disabled:s[0]==="view",class:"text-primary-600 focus:ring-primary-500"};return s[1].almoxarifado_destino_id!==void 0&&(f.group=s[1].almoxarifado_destino_id),t=new Be({props:f}),Oe.push(()=>Re(t,"group",c)),i=new Pe({props:{class:"ml-2 text-sm text-gray-900 dark:text-white",$$slots:{default:[ea]},$$scope:{ctx:s}}}),{c(){e=b("div"),de(t.$$.fragment),a=C(),de(i.$$.fragment),r=C(),this.h()},l(l){e=v(l,"DIV",{class:!0});var n=A(e);se(t.$$.fragment,n),a=D(n),se(i.$$.fragment,n),r=D(n),n.forEach(_),this.h()},h(){$(e,"class","flex items-center")},m(l,n){x(l,e,n),ne(t,e,null),m(e,a),ne(i,e,null),m(e,r),d=!0},p(l,n){const u={};n[0]&2048&&(u.value=l[53].value),n[0]&1&&(u.disabled=l[0]==="view"),!o&&n[0]&2&&(o=!0,u.group=l[1].almoxarifado_destino_id,Ve(()=>o=!1)),t.$set(u);const g={};n[0]&2048|n[2]&8&&(g.$$scope={dirty:n,ctx:l}),i.$set(g)},i(l){d||(T(t.$$.fragment,l),T(i.$$.fragment,l),d=!0)},o(l){F(t.$$.fragment,l),F(i.$$.fragment,l),d=!1},d(l){l&&_(e),le(t),le(i)}}}function St(s){let e,t=s[8].almoxarifado_destino_id+"",o;return{c(){e=b("p"),o=O(t),this.h()},l(a){e=v(a,"P",{class:!0});var i=A(e);o=S(i,t),i.forEach(_),this.h()},h(){$(e,"class","text-red-500 dark:text-red-400 text-sm mt-2")},m(a,i){x(a,e,i),m(e,o)},p(a,i){i[0]&256&&t!==(t=a[8].almoxarifado_destino_id+"")&&W(o,t)},d(a){a&&_(e)}}}function ta(s){let e,t,o="(opcional)";return{c(){e=O(`Observa√ß√µes 
              `),t=b("span"),t.textContent=o,this.h()},l(a){e=S(a,`Observa√ß√µes 
              `),t=v(a,"SPAN",{class:!0,"data-svelte-h":!0}),_e(t)!=="svelte-1313n1d"&&(t.textContent=o),this.h()},h(){$(t,"class","text-xs text-gray-500 dark:text-gray-400")},m(a,i){x(a,e,i),x(a,t,i)},p:ye,d(a){a&&(_(e),_(t))}}}function Ot(s){let e,t=s[8].observacoes+"",o;return{c(){e=b("p"),o=O(t),this.h()},l(a){e=v(a,"P",{class:!0});var i=A(e);o=S(i,t),i.forEach(_),this.h()},h(){$(e,"class","text-red-500 dark:text-red-400 text-sm mt-1")},m(a,i){x(a,e,i),m(e,o)},p(a,i){i[0]&256&&t!==(t=a[8].observacoes+"")&&W(o,t)},d(a){a&&_(e)}}}function Rt(s){let e,t,o="Resumo",a,i,r,d,c="Total de itens:",f,l,n,u,g,p,E="Valor total:",w,V,P,U=s[4].toFixed(2)+"",h;return{c(){e=b("div"),t=b("h4"),t.textContent=o,a=C(),i=b("div"),r=b("div"),d=b("span"),d.textContent=c,f=C(),l=b("span"),n=O(s[5]),u=C(),g=b("div"),p=b("span"),p.textContent=E,w=C(),V=b("span"),P=O("R$ "),h=O(U),this.h()},l(y){e=v(y,"DIV",{class:!0});var L=A(e);t=v(L,"H4",{class:!0,"data-svelte-h":!0}),_e(t)!=="svelte-3i5efz"&&(t.textContent=o),a=D(L),i=v(L,"DIV",{class:!0});var M=A(i);r=v(M,"DIV",{});var X=A(r);d=v(X,"SPAN",{class:!0,"data-svelte-h":!0}),_e(d)!=="svelte-18up8m1"&&(d.textContent=c),f=D(X),l=v(X,"SPAN",{class:!0});var I=A(l);n=S(I,s[5]),I.forEach(_),X.forEach(_),u=D(M),g=v(M,"DIV",{});var j=A(g);p=v(j,"SPAN",{class:!0,"data-svelte-h":!0}),_e(p)!=="svelte-j9jcfb"&&(p.textContent=E),w=D(j),V=v(j,"SPAN",{class:!0});var H=A(V);P=S(H,"R$ "),h=S(H,U),H.forEach(_),j.forEach(_),M.forEach(_),L.forEach(_),this.h()},h(){$(t,"class","font-medium text-gray-900 dark:text-white mb-2"),$(d,"class","text-gray-600 dark:text-gray-400"),$(l,"class","font-medium ml-2"),$(p,"class","text-gray-600 dark:text-gray-400"),$(V,"class","font-medium ml-2 text-green-600 dark:text-green-400"),$(i,"class","grid grid-cols-2 gap-4 text-sm"),$(e,"class","bg-gray-50 dark:bg-gray-800 rounded-lg p-4")},m(y,L){x(y,e,L),m(e,t),m(e,a),m(e,i),m(i,r),m(r,d),m(r,f),m(r,l),m(l,n),m(i,u),m(i,g),m(g,p),m(g,w),m(g,V),m(V,P),m(V,h)},p(y,L){L[0]&32&&W(n,y[5]),L[0]&16&&U!==(U=y[4].toFixed(2)+"")&&W(h,U)},d(y){y&&_(e)}}}function oa(s){let e=Me(s[1].tipo_nota)+"",t;return{c(){t=O(e)},l(o){t=S(o,e)},m(o,a){x(o,t,a)},p(o,a){a[0]&2&&e!==(e=Me(o[1].tipo_nota)+"")&&W(t,e)},d(o){o&&_(t)}}}function Vt(s){var n,u;let e,t,o="Almoxarifado de Origem",a,i,r=(((n=s[10].find(s[32]))==null?void 0:n.label)||"N√£o identificado")+"",d,c,f=(u=s[10].find(s[31]))==null?void 0:u.isPrincipal,l=f&&Ft();return{c(){e=b("div"),t=b("dt"),t.textContent=o,a=C(),i=b("dd"),d=O(r),c=C(),l&&l.c(),this.h()},l(g){e=v(g,"DIV",{});var p=A(e);t=v(p,"DT",{class:!0,"data-svelte-h":!0}),_e(t)!=="svelte-h81xpe"&&(t.textContent=o),a=D(p),i=v(p,"DD",{class:!0});var E=A(i);d=S(E,r),c=D(E),l&&l.l(E),E.forEach(_),p.forEach(_),this.h()},h(){$(t,"class","text-sm font-medium text-gray-500 dark:text-gray-400"),$(i,"class","mt-1 text-sm text-gray-900 dark:text-white")},m(g,p){x(g,e,p),m(e,t),m(e,a),m(e,i),m(i,d),m(i,c),l&&l.m(i,null)},p(g,p){var E,w;p[0]&1026&&r!==(r=(((E=g[10].find(g[32]))==null?void 0:E.label)||"N√£o identificado")+"")&&W(d,r),p[0]&1026&&(f=(w=g[10].find(g[31]))==null?void 0:w.isPrincipal),f?l||(l=Ft(),l.c(),l.m(i,null)):l&&(l.d(1),l=null)},d(g){g&&_(e),l&&l.d()}}}function Ft(s){let e,t="(Principal)";return{c(){e=b("span"),e.textContent=t,this.h()},l(o){e=v(o,"SPAN",{class:!0,"data-svelte-h":!0}),_e(e)!=="svelte-quypfn"&&(e.textContent=t),this.h()},h(){$(e,"class","text-xs text-primary-600 dark:text-primary-400 font-medium ml-1")},m(o,a){x(o,e,a)},d(o){o&&_(e)}}}function Lt(s){var n,u;let e,t,o="Almoxarifado de Destino",a,i,r=(((n=s[10].find(s[33]))==null?void 0:n.label)||"N√£o identificado")+"",d,c,f=(u=s[10].find(s[30]))==null?void 0:u.isPrincipal,l=f&&Ut();return{c(){e=b("div"),t=b("dt"),t.textContent=o,a=C(),i=b("dd"),d=O(r),c=C(),l&&l.c(),this.h()},l(g){e=v(g,"DIV",{});var p=A(e);t=v(p,"DT",{class:!0,"data-svelte-h":!0}),_e(t)!=="svelte-11el58n"&&(t.textContent=o),a=D(p),i=v(p,"DD",{class:!0});var E=A(i);d=S(E,r),c=D(E),l&&l.l(E),E.forEach(_),p.forEach(_),this.h()},h(){$(t,"class","text-sm font-medium text-gray-500 dark:text-gray-400"),$(i,"class","mt-1 text-sm text-gray-900 dark:text-white")},m(g,p){x(g,e,p),m(e,t),m(e,a),m(e,i),m(i,d),m(i,c),l&&l.m(i,null)},p(g,p){var E,w;p[0]&1026&&r!==(r=(((E=g[10].find(g[33]))==null?void 0:E.label)||"N√£o identificado")+"")&&W(d,r),p[0]&1026&&(f=(w=g[10].find(g[30]))==null?void 0:w.isPrincipal),f?l||(l=Ut(),l.c(),l.m(i,null)):l&&(l.d(1),l=null)},d(g){g&&_(e),l&&l.d()}}}function Ut(s){let e,t="(Principal)";return{c(){e=b("span"),e.textContent=t,this.h()},l(o){e=v(o,"SPAN",{class:!0,"data-svelte-h":!0}),_e(e)!=="svelte-quypfn"&&(e.textContent=t),this.h()},h(){$(e,"class","text-xs text-primary-600 dark:text-primary-400 font-medium ml-1")},m(o,a){x(o,e,a)},d(o){o&&_(e)}}}function Mt(s){let e,t,o="Observa√ß√µes",a,i,r=s[1].observacoes+"",d;return{c(){e=b("div"),t=b("dt"),t.textContent=o,a=C(),i=b("dd"),d=O(r),this.h()},l(c){e=v(c,"DIV",{class:!0});var f=A(e);t=v(f,"DT",{class:!0,"data-svelte-h":!0}),_e(t)!=="svelte-1sl8lih"&&(t.textContent=o),a=D(f),i=v(f,"DD",{class:!0});var l=A(i);d=S(l,r),l.forEach(_),f.forEach(_),this.h()},h(){$(t,"class","text-sm font-medium text-gray-500 dark:text-gray-400"),$(i,"class","mt-1 text-sm text-gray-900 dark:text-white"),$(e,"class","md:col-span-2")},m(c,f){x(c,e,f),m(e,t),m(e,a),m(e,i),m(i,d)},p(c,f){f[0]&2&&r!==(r=c[1].observacoes+"")&&W(d,r)},d(c){c&&_(e)}}}function zt(s){let e,t;return e=new je({props:{color:"gray",class:"ml-2 rounded-sm",$$slots:{default:[aa]},$$scope:{ctx:s}}}),{c(){de(e.$$.fragment)},l(o){se(e.$$.fragment,o)},m(o,a){ne(e,o,a),t=!0},p(o,a){const i={};a[0]&32|a[2]&8&&(i.$$scope={dirty:a,ctx:o}),e.$set(i)},i(o){t||(T(e.$$.fragment,o),t=!0)},o(o){F(e.$$.fragment,o),t=!1},d(o){le(e,o)}}}function aa(s){let e;return{c(){e=O(s[5])},l(t){e=S(t,s[5])},m(t,o){x(t,e,o)},p(t,o){o[0]&32&&W(e,t[5])},d(t){t&&_(e)}}}function ia(s){let e,t=Ie(s[2]),o=[];for(let a=0;a<t.length;a+=1)o[a]=Bt(ht(s,t,a));return{c(){e=b("div");for(let a=0;a<o.length;a+=1)o[a].c();this.h()},l(a){e=v(a,"DIV",{class:!0});var i=A(e);for(let r=0;r<o.length;r+=1)o[r].l(i);i.forEach(_),this.h()},h(){$(e,"class","space-y-3")},m(a,i){x(a,e,i);for(let r=0;r<o.length;r+=1)o[r]&&o[r].m(e,null)},p(a,i){if(i[0]&6){t=Ie(a[2]);let r;for(r=0;r<t.length;r+=1){const d=ht(a,t,r);o[r]?o[r].p(d,i):(o[r]=Bt(d),o[r].c(),o[r].m(e,null))}for(;r<o.length;r+=1)o[r].d(1);o.length=t.length}},i:ye,o:ye,d(a){a&&_(e),Le(o,a)}}}function ra(s){let e,t,o,a,i,r="Nenhum item encontrado",d,c,f="Esta nota n√£o possui itens registrados",l;return o=new po({props:{class:"w-6 h-6 text-gray-400"}}),{c(){e=b("div"),t=b("div"),de(o.$$.fragment),a=C(),i=b("h4"),i.textContent=r,d=C(),c=b("p"),c.textContent=f,this.h()},l(n){e=v(n,"DIV",{class:!0});var u=A(e);t=v(u,"DIV",{class:!0});var g=A(t);se(o.$$.fragment,g),g.forEach(_),a=D(u),i=v(u,"H4",{class:!0,"data-svelte-h":!0}),_e(i)!=="svelte-6duyuw"&&(i.textContent=r),d=D(u),c=v(u,"P",{class:!0,"data-svelte-h":!0}),_e(c)!=="svelte-1ej1x9"&&(c.textContent=f),u.forEach(_),this.h()},h(){$(t,"class","w-12 h-12 mx-auto mb-4 bg-gray-200 dark:bg-gray-700 rounded-full flex items-center justify-center"),$(i,"class","text-sm font-medium text-gray-900 dark:text-white mb-1"),$(c,"class","text-xs text-gray-500 dark:text-gray-400"),$(e,"class","bg-gray-50 dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6 text-center")},m(n,u){x(n,e,u),m(e,t),ne(o,t,null),m(e,a),m(e,i),m(e,d),m(e,c),l=!0},p:ye,i(n){l||(T(o.$$.fragment,n),l=!0)},o(n){F(o.$$.fragment,n),l=!1},d(n){n&&_(e),le(o)}}}function jt(s){let e,t,o="Custo Unit√°rio",a,i,r,d=s[50].custo_unitario.toFixed(2)+"",c,f,l,n,u="Valor Total",g,p,E,w=(s[50].quantidade*s[50].custo_unitario).toFixed(2)+"",V;return{c(){e=b("div"),t=b("dt"),t.textContent=o,a=C(),i=b("dd"),r=O("R$ "),c=O(d),f=C(),l=b("div"),n=b("dt"),n.textContent=u,g=C(),p=b("dd"),E=O("R$ "),V=O(w),this.h()},l(P){e=v(P,"DIV",{});var U=A(e);t=v(U,"DT",{class:!0,"data-svelte-h":!0}),_e(t)!=="svelte-yy8rn"&&(t.textContent=o),a=D(U),i=v(U,"DD",{class:!0});var h=A(i);r=S(h,"R$ "),c=S(h,d),h.forEach(_),U.forEach(_),f=D(P),l=v(P,"DIV",{});var y=A(l);n=v(y,"DT",{class:!0,"data-svelte-h":!0}),_e(n)!=="svelte-11k0zp4"&&(n.textContent=u),g=D(y),p=v(y,"DD",{class:!0});var L=A(p);E=S(L,"R$ "),V=S(L,w),L.forEach(_),y.forEach(_),this.h()},h(){$(t,"class","text-gray-500 dark:text-gray-400"),$(i,"class","text-gray-900 dark:text-white"),$(n,"class","text-gray-500 dark:text-gray-400"),$(p,"class","text-green-600 dark:text-green-400 font-medium")},m(P,U){x(P,e,U),m(e,t),m(e,a),m(e,i),m(i,r),m(i,c),x(P,f,U),x(P,l,U),m(l,n),m(l,g),m(l,p),m(p,E),m(p,V)},p(P,U){U[0]&4&&d!==(d=P[50].custo_unitario.toFixed(2)+"")&&W(c,d),U[0]&4&&w!==(w=(P[50].quantidade*P[50].custo_unitario).toFixed(2)+"")&&W(V,w)},d(P){P&&(_(e),_(f),_(l))}}}function Bt(s){let e,t,o,a,i,r,d=s[52]+1+"",c,f,l,n=(s[50].equipamento_nome||"Equipamento n√£o identificado")+"",u,g,p,E,w,V="Categoria",P,U,h=(s[50].categoria||"N√£o informado")+"",y,L,M,X,I="N√∫mero CA",j,H,G=(s[50].numero_ca||"N√£o informado")+"",ee,ie,ae,Q,ke="Quantidade",Y,ce,B=s[50].quantidade+"",K,fe,J,z=s[1].tipo_nota==="ENTRADA"&&s[50].custo_unitario&&jt(s);return{c(){e=b("div"),t=b("div"),o=b("div"),a=b("div"),i=b("span"),r=O("Item "),c=O(d),f=C(),l=b("h4"),u=O(n),g=C(),p=b("div"),E=b("div"),w=b("dt"),w.textContent=V,P=C(),U=b("dd"),y=O(h),L=C(),M=b("div"),X=b("dt"),X.textContent=I,j=C(),H=b("dd"),ee=O(G),ie=C(),ae=b("div"),Q=b("dt"),Q.textContent=ke,Y=C(),ce=b("dd"),K=O(B),fe=C(),z&&z.c(),J=C(),this.h()},l(Z){e=v(Z,"DIV",{class:!0});var N=A(e);t=v(N,"DIV",{class:!0});var oe=A(t);o=v(oe,"DIV",{class:!0});var me=A(o);a=v(me,"DIV",{class:!0});var pe=A(a);i=v(pe,"SPAN",{class:!0});var re=A(i);r=S(re,"Item "),c=S(re,d),re.forEach(_),f=D(pe),l=v(pe,"H4",{class:!0});var De=A(l);u=S(De,n),De.forEach(_),pe.forEach(_),g=D(me),p=v(me,"DIV",{class:!0});var Ee=A(p);E=v(Ee,"DIV",{});var ge=A(E);w=v(ge,"DT",{class:!0,"data-svelte-h":!0}),_e(w)!=="svelte-14lljjz"&&(w.textContent=V),P=D(ge),U=v(ge,"DD",{class:!0});var qe=A(U);y=S(qe,h),qe.forEach(_),ge.forEach(_),L=D(Ee),M=v(Ee,"DIV",{});var Ce=A(M);X=v(Ce,"DT",{class:!0,"data-svelte-h":!0}),_e(X)!=="svelte-1pq153"&&(X.textContent=I),j=D(Ce),H=v(Ce,"DD",{class:!0});var q=A(H);ee=S(q,G),q.forEach(_),Ce.forEach(_),ie=D(Ee),ae=v(Ee,"DIV",{});var k=A(ae);Q=v(k,"DT",{class:!0,"data-svelte-h":!0}),_e(Q)!=="svelte-6gds52"&&(Q.textContent=ke),Y=D(k),ce=v(k,"DD",{class:!0});var R=A(ce);K=S(R,B),R.forEach(_),k.forEach(_),fe=D(Ee),z&&z.l(Ee),Ee.forEach(_),me.forEach(_),oe.forEach(_),J=D(N),N.forEach(_),this.h()},h(){$(i,"class","text-xs bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 px-2 py-1 rounded"),$(l,"class","font-medium text-gray-900 dark:text-white"),$(a,"class","flex items-center gap-3 mb-2"),$(w,"class","text-gray-500 dark:text-gray-400"),$(U,"class","text-gray-900 dark:text-white"),$(X,"class","text-gray-500 dark:text-gray-400"),$(H,"class","text-gray-900 dark:text-white"),$(Q,"class","text-gray-500 dark:text-gray-400"),$(ce,"class","text-gray-900 dark:text-white font-medium"),$(p,"class","grid grid-cols-1 md:grid-cols-3 gap-4 text-sm"),$(o,"class","flex-1"),$(t,"class","flex items-start justify-between"),$(e,"class","bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4")},m(Z,N){x(Z,e,N),m(e,t),m(t,o),m(o,a),m(a,i),m(i,r),m(i,c),m(a,f),m(a,l),m(l,u),m(o,g),m(o,p),m(p,E),m(E,w),m(E,P),m(E,U),m(U,y),m(p,L),m(p,M),m(M,X),m(M,j),m(M,H),m(H,ee),m(p,ie),m(p,ae),m(ae,Q),m(ae,Y),m(ae,ce),m(ce,K),m(p,fe),z&&z.m(p,null),m(e,J)},p(Z,N){N[0]&4&&n!==(n=(Z[50].equipamento_nome||"Equipamento n√£o identificado")+"")&&W(u,n),N[0]&4&&h!==(h=(Z[50].categoria||"N√£o informado")+"")&&W(y,h),N[0]&4&&G!==(G=(Z[50].numero_ca||"N√£o informado")+"")&&W(ee,G),N[0]&4&&B!==(B=Z[50].quantidade+"")&&W(K,B),Z[1].tipo_nota==="ENTRADA"&&Z[50].custo_unitario?z?z.p(Z,N):(z=jt(Z),z.c(),z.m(p,null)):z&&(z.d(1),z=null)},d(Z){Z&&_(e),z&&z.d()}}}function Ht(s){let e,t,o,a,i,r,d,c,f=s[5]===1?"Item":"Itens",l,n,u=s[4]>0&&Qt(s);return{c(){e=b("div"),t=b("div"),o=b("div"),a=b("div"),i=b("div"),r=O(s[5]),d=C(),c=b("div"),l=O(f),n=C(),u&&u.c(),this.h()},l(g){e=v(g,"DIV",{class:!0});var p=A(e);t=v(p,"DIV",{class:!0});var E=A(t);o=v(E,"DIV",{class:!0});var w=A(o);a=v(w,"DIV",{class:!0});var V=A(a);i=v(V,"DIV",{class:!0});var P=A(i);r=S(P,s[5]),P.forEach(_),d=D(V),c=v(V,"DIV",{class:!0});var U=A(c);l=S(U,f),U.forEach(_),V.forEach(_),n=D(w),u&&u.l(w),w.forEach(_),E.forEach(_),p.forEach(_),this.h()},h(){$(i,"class","text-2xl font-bold text-primary-600 dark:text-primary-400"),$(c,"class","text-xs text-primary-600 dark:text-primary-400 font-medium"),$(a,"class","text-center"),$(o,"class","flex items-center gap-6"),$(t,"class","flex items-center justify-between"),$(e,"class","bg-primary-50 dark:bg-primary-900/20 rounded-lg border border-primary-200 dark:border-primary-800 p-4")},m(g,p){x(g,e,p),m(e,t),m(t,o),m(o,a),m(a,i),m(i,r),m(a,d),m(a,c),m(c,l),m(o,n),u&&u.m(o,null)},p(g,p){p[0]&32&&W(r,g[5]),p[0]&32&&f!==(f=g[5]===1?"Item":"Itens")&&W(l,f),g[4]>0?u?u.p(g,p):(u=Qt(g),u.c(),u.m(o,null)):u&&(u.d(1),u=null)},d(g){g&&_(e),u&&u.d()}}}function Qt(s){let e,t,o,a=s[4].toFixed(2)+"",i,r,d,c="Valor Total";return{c(){e=b("div"),t=b("div"),o=O("R$ "),i=O(a),r=C(),d=b("div"),d.textContent=c,this.h()},l(f){e=v(f,"DIV",{class:!0});var l=A(e);t=v(l,"DIV",{class:!0});var n=A(t);o=S(n,"R$ "),i=S(n,a),n.forEach(_),r=D(l),d=v(l,"DIV",{class:!0,"data-svelte-h":!0}),_e(d)!=="svelte-1vt3ayj"&&(d.textContent=c),l.forEach(_),this.h()},h(){$(t,"class","text-2xl font-bold text-green-600 dark:text-green-400"),$(d,"class","text-xs text-green-600 dark:text-green-400 font-medium"),$(e,"class","text-center")},m(f,l){x(f,e,l),m(e,t),m(t,o),m(t,i),m(e,r),m(e,d)},p(f,l){l[0]&16&&a!==(a=f[4].toFixed(2)+"")&&W(i,a)},d(f){f&&_(e)}}}function la(s){let e,t,o,a,i,r;e=new _o({props:{title:s[16],objectType:"NOTA DE MOVIMENTA√á√ÉO",iconName:"FileDocOutline",status:s[13],statusType:"movimento",additionalInfo:s[12],primaryAction:s[15],secondaryAction:s[14]}}),e.$on("close",s[19]),e.$on("primaryAction",s[18]),e.$on("secondaryAction",s[17]);const d=[Uo,Lo],c=[];function f(l,n){return l[3]?0:1}return o=f(s),a=c[o]=d[o](s),{c(){de(e.$$.fragment),t=C(),a.c(),i=xe()},l(l){se(e.$$.fragment,l),t=D(l),a.l(l),i=xe()},m(l,n){ne(e,l,n),x(l,t,n),c[o].m(l,n),x(l,i,n),r=!0},p(l,n){const u={};n[0]&65536&&(u.title=l[16]),n[0]&8192&&(u.status=l[13]),n[0]&4096&&(u.additionalInfo=l[12]),n[0]&32768&&(u.primaryAction=l[15]),n[0]&16384&&(u.secondaryAction=l[14]),e.$set(u);let g=o;o=f(l),o===g?c[o].p(l,n):($e(),F(c[g],1,1,()=>{c[g]=null}),Ae(),a=c[o],a?a.p(l,n):(a=c[o]=d[o](l),a.c()),T(a,1),a.m(i.parentNode,i))},i(l){r||(T(e.$$.fragment,l),T(a),r=!0)},o(l){F(e.$$.fragment,l),F(a),r=!1},d(l){l&&(_(t),_(i)),le(e,l),c[o].d(l)}}}function na(s){let e,t,o;function a(r){s[41](r)}let i={placement:"right",width:"w-full max-w-[940px]",backdrop:!0,activateClickOutside:!0,bgOpacity:"bg-black/50",position:"fixed",id:"notas-detail-drawer",class:"drawer-notas",$$slots:{default:[la]},$$scope:{ctx:s}};return s[6]!==void 0&&(i.hidden=s[6]),e=new fo({props:i}),Oe.push(()=>Re(e,"hidden",a)),{c(){de(e.$$.fragment)},l(r){se(e.$$.fragment,r)},m(r,d){ne(e,r,d),o=!0},p(r,d){const c={};d[0]&131007|d[2]&8&&(c.$$scope={dirty:d,ctx:r}),!t&&d[0]&64&&(t=!0,c.hidden=r[6],Ve(()=>t=!1)),e.$set(c)},i(r){o||(T(e.$$.fragment,r),o=!0)},o(r){F(e.$$.fragment,r),o=!1},d(r){le(e,r)}}}function sa(s,e,t){let o,a,i,r,d,c,f,l,n,{open:u=!1}=e,{mode:g="create"}=e,{tipo:p="ENTRADA"}=e,{nota:E=null}=e;const w=!1,V=Wt();let P=!u,U=u,h={tipo_nota:"ENTRADA",almoxarifado_origem_id:"",almoxarifado_destino_id:"",observacoes:"",data_documento:new Date().toISOString().split("T")[0],itens:[]},y=[],L=[],M={},X=!1,I=[],j=[],H=!1,G=!1;Xt(async()=>{await ee()});async function ee(){var q;t(3,G=!0);try{const k=await bo.listarAlmoxarifados();if(t(10,I=k.map(R=>{var ue;return{value:R.id,label:R.nome,isPrincipal:R.isPrincipal,unidadeNegocio:(ue=R.unidadeNegocio)==null?void 0:ue.nome}})),I.sort((R,ue)=>R.isPrincipal&&!ue.isPrincipal?-1:!R.isPrincipal&&ue.isPrincipal?1:R.label.localeCompare(ue.label)),t(27,j=I),console.log("üìã NotesDetailDrawer: Almoxarifados carregados:",{original:k.length,options:I.length,principal:((q=I.find(R=>R.isPrincipal))==null?void 0:q.label)||"Nenhum",samples:I.slice(0,2).map(R=>({value:R.value,label:R.label,isPrincipal:R.isPrincipal}))}),(g==="edit"||g==="view")&&E)await ie();else if(t(1,h.tipo_nota=p,h),I.length>0){const R=I.find(ue=>ue.isPrincipal)||I[0];h.tipo_nota==="ENTRADA"?h.almoxarifado_destino_id||t(1,h.almoxarifado_destino_id=R.value,h):(h.tipo_nota==="TRANSFERENCIA"||h.tipo_nota==="DESCARTE")&&(h.almoxarifado_origem_id||t(1,h.almoxarifado_origem_id=R.value,h))}}catch(k){if(console.error("Erro ao carregar dados do formul√°rio:",k),t(10,I=[{value:"567a1885-0763-4a13-b9f6-157daa39ddc3",label:"Almoxarifado Central SP",isPrincipal:!0},{value:"1a743859-33e6-4ce3-9158-025dee47922b",label:"Almoxarifado RJ",isPrincipal:!1}]),t(27,j=I),g!=="edit"){t(1,h.tipo_nota=p,h);const R=I[0];p==="ENTRADA"&&!h.almoxarifado_destino_id?t(1,h.almoxarifado_destino_id=R.value,h):(p==="TRANSFERENCIA"&&!h.almoxarifado_origem_id||p==="DESCARTE"&&!h.almoxarifado_origem_id)&&t(1,h.almoxarifado_origem_id=R.value,h)}}finally{t(3,G=!1)}}async function ie(){var q;if(E)try{t(1,h={tipo_nota:E.tipo||E.tipo_nota,almoxarifado_origem_id:E.almoxarifado_id||E.almoxarifadoOrigemId||"",almoxarifado_destino_id:E.almoxarifado_destino_id||E.almoxarifadoDestinoId||"",observacoes:E.observacoes||"",data_documento:((q=E.data_documento)==null?void 0:q.split("T")[0])||new Date().toISOString().split("T")[0],itens:[]});const k=E.itens||E._itens||[];if(console.log("üîç Items do backend para processar:",k),k&&k.length>0){const{tiposEpiAdapter:R}=await Je(async()=>{const{tiposEpiAdapter:te}=await Promise.resolve().then(()=>$o);return{tiposEpiAdapter:te}},void 0,import.meta.url),{estoqueItensAdapter:ue}=await Je(async()=>{const{estoqueItensAdapter:te}=await Promise.resolve().then(()=>xo);return{estoqueItensAdapter:te}},void 0,import.meta.url),be=await Promise.all(k.map(async te=>{console.log("üîç Processando item:",te);const he={temp_id:`existing_${te.id}`,tipo_epi_id:te.tipoEpiId||te.tipo_epi_id,estoque_item_id:te.estoque_item_id,quantidade:te.quantidade,custo_unitario:te.custo_unitario||0,equipamento_nome:"Equipamento n√£o identificado",categoria:"",numero_ca:"N√£o informado"};try{if(te.tipoEpiId||te.tipo_epi_id){const we=te.tipoEpiId||te.tipo_epi_id;console.log("üîç Buscando dados do tipo EPI:",we);const Ne=(await R.obterOpcoesSelectComCache({apenasAtivos:!1})).find(Fe=>Fe.value===we);Ne?(he.equipamento_nome=Ne.label,he.categoria=Ne.categoria||"",he.numero_ca=Ne.numeroCA||"N√£o informado",console.log("‚úÖ Dados do tipo EPI encontrados:",Ne.label)):console.warn("‚ö†Ô∏è Tipo EPI n√£o encontrado para ID:",we)}if(te.estoque_item_id&&h.almoxarifado_origem_id){const Te=(await ue.obterItensDisponiveisComCache(h.almoxarifado_origem_id)).find(Ne=>Ne.value===te.estoque_item_id);Te&&(he.equipamento_nome=Te.label,he.categoria=Te.categoria||"",he.numero_ca=Te.numeroCA||"N√£o informado",console.log("‚úÖ Dados do estoque encontrados:",Te.label))}}catch(we){console.error("‚ùå Erro ao enriquecer item:",we)}return he}));t(2,y=be),console.log("‚úÖ Itens enriquecidos processados:",y.length)}}catch(k){console.error("Erro ao carregar dados da nota:",k)}}function ae(){const q={tipo_nota:p,almoxarifado_origem_id:"",almoxarifado_destino_id:"",observacoes:"",data_documento:new Date().toISOString().split("T")[0],itens:[]};t(1,h=q),t(2,y=[]),t(8,M={}),t(9,X=!1),t(7,L=[])}function Q(){return t(8,M={}),t(7,L=[]),h.tipo_nota==="TRANSFERENCIA"&&h.almoxarifado_origem_id&&h.almoxarifado_destino_id&&h.almoxarifado_origem_id===h.almoxarifado_destino_id&&t(8,M.almoxarifado_destino_id="Almoxarifado de destino deve ser diferente do origem",M),y.length===0&&t(7,L=["‚ö†Ô∏è Rascunho salvo sem itens - adicione itens antes de concluir"]),Object.keys(M).length===0}function ke(){if(t(8,M={}),t(7,L=[]),h.tipo_nota==="ENTRADA"?h.almoxarifado_destino_id||t(8,M.almoxarifado_destino_id="Almoxarifado de destino √© obrigat√≥rio para entrada",M):h.tipo_nota==="TRANSFERENCIA"?(h.almoxarifado_origem_id||t(8,M.almoxarifado_origem_id="Almoxarifado de origem √© obrigat√≥rio para transfer√™ncia",M),h.almoxarifado_destino_id||t(8,M.almoxarifado_destino_id="Almoxarifado de destino √© obrigat√≥rio para transfer√™ncia",M),h.almoxarifado_origem_id===h.almoxarifado_destino_id&&t(8,M.almoxarifado_destino_id="Almoxarifado de destino deve ser diferente do origem",M)):h.tipo_nota==="DESCARTE"&&(h.almoxarifado_origem_id||t(8,M.almoxarifado_origem_id="Almoxarifado de origem √© obrigat√≥rio para descarte",M)),h.data_documento||t(8,M.data_documento="Data do documento √© obrigat√≥ria",M),y.length===0)return t(7,L=["Pelo menos um item deve ser adicionado para concluir a nota"]),!1;if(h.tipo_nota==="ENTRADA"){const q=y.filter(k=>!k.custo_unitario||k.custo_unitario<=0);if(q.length>0)return t(7,L=[`${q.length} ${q.length===1?"item n√£o possui":"itens n√£o possuem"} custo unit√°rio v√°lido`]),!1}return Object.keys(M).length===0}async function Y(){if(!Q()){t(9,X=!0);return}t(9,X=L.length>0),await B("rascunho")}async function ce(){if(!ke()){t(9,X=!0);return}await B("concluida")}async function B(q){var k,R;t(28,H=!0);try{const ue={tipo_nota:h.tipo_nota,data_documento:h.data_documento};h.observacoes&&h.observacoes.trim()!==""&&(ue.observacoes=h.observacoes.trim()),h.tipo_nota==="ENTRADA"?h.almoxarifado_destino_id&&(ue.almoxarifado_destino_id=h.almoxarifado_destino_id):h.tipo_nota==="TRANSFERENCIA"?(h.almoxarifado_origem_id&&(ue.almoxarifado_origem_id=h.almoxarifado_origem_id),h.almoxarifado_destino_id&&(ue.almoxarifado_destino_id=h.almoxarifado_destino_id)):h.tipo_nota==="DESCARTE"&&h.almoxarifado_origem_id&&(ue.almoxarifado_origem_id=h.almoxarifado_origem_id);let be;if(g==="create"){const te=await ze.criarNota(ue);if(console.log("üìù Resposta da cria√ß√£o da nota:",te),be=((k=te==null?void 0:te.data)==null?void 0:k.id)||(te==null?void 0:te.id)||((R=te==null?void 0:te.data)==null?void 0:R.uuid)||(te==null?void 0:te.uuid),!be)throw console.error("‚ùå N√£o foi poss√≠vel extrair o ID da nota criada:",te),new Error("Erro: ID da nota n√£o encontrado na resposta do servidor");if(console.log("‚úÖ Nota criada com ID:",be),y.length>0)for(const he of y){const we={tipo_epi_id:he.tipo_epi_id,estoque_item_id:he.estoque_item_id,quantidade:he.quantidade,custo_unitario:he.custo_unitario};await ze.adicionarItem(be,we)}q==="concluida"&&await ze.concluirNota(be)}else{if(!(E!=null&&E.id))throw new Error("ID da nota n√£o encontrado");await ze.atualizarNota(E.id,{data_documento:ue.data_documento,observacoes:ue.observacoes}),be=E.id}V("salvar",{notaId:be,modo:q})}catch(ue){throw console.error("Erro ao salvar nota:",ue),ue}finally{t(28,H=!1)}}function K(){V("close")}function fe(q){t(2,y=q.detail),t(1,h.itens=y,h),y.length>0&&t(7,L=[])}function J(q){q.detail?t(7,L=[q.detail]):t(7,L=[])}const z=q=>q.value===h.almoxarifado_destino_id,Z=q=>q.value===h.almoxarifado_origem_id,N=q=>q.value===h.almoxarifado_origem_id,oe=q=>q.value===h.almoxarifado_destino_id;function me(q){s.$$.not_equal(h.tipo_nota,q)&&(h.tipo_nota=q,t(1,h))}function pe(q){s.$$.not_equal(h.data_documento,q)&&(h.data_documento=q,t(1,h))}function re(q){s.$$.not_equal(h.almoxarifado_destino_id,q)&&(h.almoxarifado_destino_id=q,t(1,h))}function De(q){s.$$.not_equal(h.almoxarifado_origem_id,q)&&(h.almoxarifado_origem_id=q,t(1,h))}function Ee(q){s.$$.not_equal(h.almoxarifado_destino_id,q)&&(h.almoxarifado_destino_id=q,t(1,h))}function ge(q){s.$$.not_equal(h.observacoes,q)&&(h.observacoes=q,t(1,h))}function qe(q){y=q,t(2,y)}function Ce(q){P=q,t(6,P),t(22,u),t(26,U)}return s.$$set=q=>{"open"in q&&t(22,u=q.open),"mode"in q&&t(0,g=q.mode),"tipo"in q&&t(23,p=q.tipo),"nota"in q&&t(24,E=q.nota)},s.$$.update=()=>{s.$$.dirty[0]&71303168&&u!==U&&(t(6,P=!u),t(26,U=u)),s.$$.dirty[0]&4194305&&u&&(g==="create"&&ae(),ee()),s.$$.dirty[0]&3&&t(16,o=g==="create"?`Nova Nota - ${Me(h.tipo_nota)}`:g==="edit"?`Editar Nota - ${Me(h.tipo_nota)}`:`Visualizar Nota - ${Me(h.tipo_nota)}`),s.$$.dirty[0]&4&&t(5,a=y.length),s.$$.dirty[0]&4&&t(4,i=y.reduce((q,k)=>{const R=typeof k.custo_unitario=="number"?k.custo_unitario:0;return q+k.quantidade*R},0)),s.$$.dirty[0]&268435465&&t(29,r=!H&&!G&&g!=="view"),s.$$.dirty[0]&536870913&&t(15,d=g==="view"?null:{text:"Concluir",icon:"CheckOutline",disabled:!r}),s.$$.dirty[0]&536870913&&t(14,c=g==="view"?null:{text:"Salvar Rascunho",icon:"FloppyDiskOutline",disabled:!r}),s.$$.dirty[0]&16777217&&t(13,f=g==="create"?"NOVA":g==="edit"?"EDITANDO":(E==null?void 0:E.status)||"VISUALIZANDO"),s.$$.dirty[0]&48&&t(12,l=[`${a} ${a===1?"item":"itens"}`,i>0?`R$ ${i.toFixed(2)}`:"Sem valor"]),s.$$.dirty[0]&134217730&&t(11,n=j.filter(q=>q.value!==h.almoxarifado_origem_id))},[g,h,y,G,i,a,P,L,M,X,I,n,l,f,c,d,o,Y,ce,K,fe,J,u,p,E,w,U,j,H,r,z,Z,N,oe,me,pe,re,De,Ee,ge,qe,Ce]}class xa extends Jt{constructor(e){super(),Zt(this,e,sa,na,Kt,{open:22,mode:0,tipo:23,nota:24,loading:25},null,[-1,-1,-1])}get loading(){return this.$$.ctx[25]}}export{xa as N,Aa as a,$a as b,Me as g,ze as n};
