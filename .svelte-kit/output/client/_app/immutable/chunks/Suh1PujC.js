import{c as u,a as i}from"./INiUvie6.js";import{i as g}from"./Rh-Jv65z.js";class C{async getContratadas(a){var t,o,c;try{console.log("ğŸ¢ Carregando contratadas...",a);const s={page:a.page||1,limit:a.limit||10};a.searchTerm&&(s.search=a.searchTerm),a.statusFilter&&a.statusFilter!=="todos"&&(s.status=a.statusFilter.toUpperCase());const d=u("/contratadas",s),e=await i.get(d);if(console.log("ğŸ“¦ Contratadas response real:",e),console.log("ğŸ“¦ Estrutura dos dados:",{success:e.success,contratadas:((o=(t=e.data)==null?void 0:t.contratadas)==null?void 0:o.length)||0,total:((c=e.data)==null?void 0:c.total)||0}),e.success&&e.data){const n=e.data.contratadas.map(r=>{var l;return{id:r.id,nome:r.nome,cnpj:r.cnpjFormatado||r.cnpj,endereco:r.endereco||"",contato:r.contato||"",status:r.status||"ativa",colaboradores:r.colaboradores||0,dataContrato:r.dataContrato||((l=r.createdAt)==null?void 0:l.split("T")[0])||"",createdAt:r.createdAt,updatedAt:r.updatedAt||r.createdAt}});return console.log("âœ… Contratadas mapeadas:",n.length),{contratadas:n,total:e.data.total||0,page:a.page||1,limit:a.limit||10}}}catch(s){console.error("âŒ Erro ao carregar contratadas, usando fallback mock:",s),await new Promise(n=>setTimeout(n,500));let e=[{id:"1",nome:"Alpha ConstruÃ§Ãµes Ltda",cnpj:"12.345.678/0001-90",endereco:"Rua das ConstruÃ§Ãµes, 123",contato:"(11) 99999-9999",status:"ativa",colaboradores:15,dataContrato:"2024-01-15",createdAt:"2024-01-15T10:00:00Z",updatedAt:"2024-01-15T10:00:00Z"},{id:"2",nome:"Beta Engenharia S.A.",cnpj:"98.765.432/0001-10",endereco:"Av. Engenharia, 456",contato:"contato@betaeng.com.br",status:"ativa",colaboradores:8,dataContrato:"2024-03-22",createdAt:"2024-03-22T14:30:00Z",updatedAt:"2024-03-22T14:30:00Z"}];if(a.searchTerm){const n=a.searchTerm.toLowerCase();e=e.filter(r=>r.nome.toLowerCase().includes(n)||r.cnpj.includes(a.searchTerm))}return a.statusFilter&&a.statusFilter!=="todos"&&(e=e.filter(n=>n.status===a.statusFilter)),console.log("âœ… Contratadas carregadas (fallback):",e.length),{contratadas:e,total:e.length,page:a.page||1,limit:a.limit||10}}}async getContratadaById(a){try{console.log("ğŸ¢ Buscando contratada:",a),await new Promise(o=>setTimeout(o,500));const t={id:a,nome:"Alpha ConstruÃ§Ãµes Ltda",cnpj:"12.345.678/0001-90",endereco:"Rua das ConstruÃ§Ãµes, 123",contato:"(11) 99999-9999",status:"ativa",colaboradores:15,dataContrato:"2024-01-15",createdAt:"2024-01-15T10:00:00Z",updatedAt:"2024-01-15T10:00:00Z"};return console.log("âœ… Contratada encontrada:",t.nome),t}catch(t){throw console.error("âŒ Erro ao buscar contratada:",t),t}}async createContratada(a){try{if(console.log("ğŸ’¾ Criando contratada:",a),a.cnpj&&!g(a.cnpj))throw new Error("CNPJ invÃ¡lido. Verifique o formato e os dÃ­gitos verificadores.");const t={...a,cnpj:a.cnpj?a.cnpj.replace(/\D/g,""):void 0},o=await i.post("/contratadas",t);if(o.success&&o.data)return console.log("âœ… Contratada criada no backend:",o.data.id),o.data;throw new Error("Resposta invÃ¡lida do backend")}catch(t){if(console.error("âŒ Erro ao criar contratada no backend, usando fallback:",t),t instanceof Error&&t.message.includes("CNPJ invÃ¡lido"))throw t;await new Promise(c=>setTimeout(c,1e3));const o={id:`contratada-mock-${Date.now()}`,nome:a.nome,cnpj:a.cnpj,endereco:a.endereco,contato:a.contato,status:"ativa",colaboradores:0,dataContrato:new Date().toISOString().split("T")[0],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};return console.log("âœ… Contratada criada (fallback):",o.id),o}}async updateContratada(a,t){try{console.log("ğŸ’¾ Atualizando contratada:",a,t),await new Promise(c=>setTimeout(c,800));const o={id:a,nome:t.nome||"Nome Atualizado",cnpj:t.cnpj||"12.345.678/0001-90",endereco:t.endereco,contato:t.contato,status:t.status||"ativa",colaboradores:15,dataContrato:"2024-01-15",createdAt:"2024-01-15T10:00:00Z",updatedAt:new Date().toISOString()};return console.log("âœ… Contratada atualizada:",o.id),o}catch(o){throw console.error("âŒ Erro ao atualizar contratada:",o),o}}async deleteContratada(a){try{console.log("ğŸ—‘ï¸ Deletando contratada:",a),await new Promise(t=>setTimeout(t,600)),console.log("âœ… Contratada deletada:",a)}catch(t){throw console.error("âŒ Erro ao deletar contratada:",t),t}}async toggleStatusContratada(a,t){try{console.log("ğŸ”„ Alterando status da contratada:",a,t),await new Promise(o=>setTimeout(o,500)),console.log("âœ… Status da contratada alterado:",a,t)}catch(o){throw console.error("âŒ Erro ao alterar status da contratada:",o),o}}}const A=new C;export{A as contratadasAdapter};
