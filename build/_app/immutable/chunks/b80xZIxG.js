import{c as h,a as s}from"./D8PmxC0_.js";class w{async getInventoryItems(o={}){var t,r,d,n,g,p,u,m;console.log("üö® ADAPTER CHAMADO: Buscando itens do invent√°rio:",o),console.log("üö® API_BASE_URL atual:","production");try{const c={page:o.page||1,pageSize:o.pageSize||20,...o.search&&{search:o.search},...o.status&&{status:o.status},...o.categoria&&{categoria:o.categoria},...o.includeExpanded&&{includeExpanded:!0}},I=h("/estoque/itens",c);console.log("üîó URL constru√≠da:",I);const a=await s.get(I);console.log("üîç Resposta bruta do backend estoque:",a),console.log("üîç Estrutura dos dados:",{hasData:!!a.data,hasItems:!!((t=a.data)!=null&&t.items),itemsLength:(d=(r=a.data)==null?void 0:r.items)==null?void 0:d.length,firstItem:(g=(n=a.data)==null?void 0:n.items)==null?void 0:g[0],pagination:(p=a.data)==null?void 0:p.pagination});const E=((u=a.data)==null?void 0:u.items)||a.items||[];console.log("üîç Items encontrados no backend:",E.length);const l=E.map(e=>{var A,v;return{...e,almoxarifadoId:e.almoxarifadoId||((A=e.almoxarifado)==null?void 0:A.id),tipoEPIId:e.tipoEPIId||e.tipoEpiId||((v=e.tipoEpi)==null?void 0:v.id),tipoEPI:e.tipoEpi?{...e.tipoEpi,id:e.tipoEpi.id,numeroCA:e.tipoEpi.numeroCa||e.tipoEpi.numeroCA,nomeEquipamento:e.tipoEpi.nomeEquipamento||e.tipoEpi.nome,categoria:e.tipoEpi.categoriaEpi||e.tipoEpi.categoria}:void 0,status:(e.status||"DISPONIVEL").toLowerCase(),almoxarifado:e.almoxarifado?{...e.almoxarifado,id:e.almoxarifado.id}:void 0}}),i=((m=a.data)==null?void 0:m.pagination)||a.pagination||{},S={data:l,total:i.total||l.length,page:i.page||o.page||1,pageSize:i.limit||i.pageSize||o.pageSize||20,totalPages:i.totalPages||Math.ceil((i.total||l.length)/(i.limit||i.pageSize||o.pageSize||20))};return console.log("‚úÖ Itens do invent√°rio mapeados:",S),S}catch(c){return console.error("‚ùå Erro ao buscar itens do invent√°rio:",c),console.log("üîÑ Usando dados mockados para desenvolvimento"),{data:[{id:"1",tipoEPIId:"tipo-1",almoxarifadoId:"alm-1",quantidade:25,status:"disponivel",dataUltimaMovimentacao:new Date().toISOString(),createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),tipoEPI:{id:"tipo-1",nomeEquipamento:"Capacete de Seguran√ßa",numeroCA:"12345",categoria:"Prote√ß√£o da Cabe√ßa",ativo:!0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},almoxarifado:{id:"alm-1",nome:"Almoxarifado Principal",codigo:"ALMP001",ativo:!0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}},{id:"2",tipoEPIId:"tipo-2",almoxarifadoId:"alm-1",quantidade:15,status:"baixo",dataUltimaMovimentacao:new Date().toISOString(),createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),tipoEPI:{id:"tipo-2",nomeEquipamento:"Luvas de Prote√ß√£o",numeroCA:"67890",categoria:"Prote√ß√£o das M√£os",ativo:!0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},almoxarifado:{id:"alm-1",nome:"Almoxarifado Principal",codigo:"ALMP001",ativo:!0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}}],total:2,page:1,pageSize:20,totalPages:1}}}async getItemMovementHistory(o,t={}){console.log("üìä Buscando hist√≥rico do item:",o,t);try{const r={limit:t.limit||100,...t.dataInicio&&{dataInicio:t.dataInicio},...t.dataFim&&{dataFim:t.dataFim}},d=h(`/estoque/itens/${o}/movimentacoes`,r),n=await s.get(d);return console.log("‚úÖ Hist√≥rico do item obtido com sucesso:",n.length),n}catch(r){throw console.error("‚ùå Erro ao buscar hist√≥rico do item:",r),r}}async registerMovement(o){console.log("üìù Registrando movimenta√ß√£o:",o);try{const t=await s.post("/estoque/movimentacoes",o);return console.log("‚úÖ Movimenta√ß√£o registrada com sucesso:",t),t}catch(t){throw console.error("‚ùå Erro ao registrar movimenta√ß√£o:",t),t}}async registerEntry(o){const t={...o,tipoMovimentacao:"ENTRADA_COMPRA"};return this.registerMovement(t)}async registerExit(o){const t={...o,tipoMovimentacao:"SAIDA_ENTREGA"};return this.registerMovement(t)}async registerAdjustment(o){const t={tipoEpiId:o.tipoEpiId,almoxarifadoId:o.almoxarifadoId,quantidade:o.quantidade,observacoes:o.motivo,responsavelId:o.responsavelId,tipoMovimentacao:"AJUSTE_INVENTARIO"};return this.registerMovement(t)}async registerTransfer(o){try{const t=await s.post("/estoque/transferencias",o);return console.log("‚úÖ Transfer√™ncia registrada com sucesso:",t),t}catch(t){throw console.error("‚ùå Erro ao registrar transfer√™ncia:",t),t}}async criarEstorno(o){try{const t=await s.post("/estoque/estornos",o);return console.log("‚úÖ Estorno registrado com sucesso:",t),t}catch(t){throw console.error("‚ùå Erro ao criar estorno:",t),t}}clearCache(){console.log("üóëÔ∏è Cache do InventoryCommandAdapter limpo")}}const D=new w;export{D as i};
