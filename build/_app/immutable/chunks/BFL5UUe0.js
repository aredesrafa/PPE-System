var E=Object.defineProperty;var f=(a,e,o)=>e in a?E(a,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):a[e]=o;var n=(a,e,o)=>f(a,typeof e!="symbol"?e+"":e,o);import{d as s,w as b}from"./D3FebGYg.js";import{a as l}from"./D8PmxC0_.js";const d={tiposMovimentacao:[{code:"entrada_nota",label:"Entrada por Nota",description:"Entrada de itens via nota fiscal"},{code:"saida_entrega",label:"Sa√≠da por Entrega",description:"Sa√≠da para entrega a colaborador"},{code:"transferencia",label:"Transfer√™ncia",description:"Transfer√™ncia entre almoxarifados"},{code:"ajuste_positivo",label:"Ajuste Positivo",description:"Ajuste para aumentar estoque"},{code:"ajuste_negativo",label:"Ajuste Negativo",description:"Ajuste para diminuir estoque"},{code:"devolucao",label:"Devolu√ß√£o",description:"Devolu√ß√£o de item por colaborador"},{code:"descarte",label:"Descarte",description:"Descarte de item vencido ou danificado"},{code:"estorno",label:"Estorno",description:"Estorno de movimenta√ß√£o anterior"}],categoriasEPI:[{code:"PROTECAO_CABECA",label:"Prote√ß√£o da Cabe√ßa",description:"Capacetes, bon√©s, etc."},{code:"PROTECAO_OLHOS_ROSTO",label:"Prote√ß√£o dos Olhos",description:"√ìculos, viseiras, etc."},{code:"PROTECAO_OUVIDOS",label:"Prote√ß√£o Auditiva",description:"Protetores auriculares"},{code:"PROTECAO_RESPIRATORIA",label:"Prote√ß√£o Respirat√≥ria",description:"M√°scaras, respiradores"},{code:"PROTECAO_MAOS_BRACCOS",label:"Prote√ß√£o das M√£os",description:"Luvas de diversos tipos"},{code:"PROTECAO_PES",label:"Prote√ß√£o dos P√©s",description:"Cal√ßados de seguran√ßa"},{code:"PROTECAO_CLIMATICA",label:"Prote√ß√£o Clim√°tica",description:"Prote√ß√£o contra intemp√©ries"},{code:"ROUPA_APROXIMACAO",label:"Roupa de Aproxima√ß√£o",description:"Roupas especiais para aproxima√ß√£o"}],statusEntrega:[{code:"pendente_assinatura",label:"Pendente de Assinatura",description:"Aguardando assinatura do colaborador"},{code:"assinada",label:"Assinada",description:"Entrega confirmada e assinada"},{code:"devolvido",label:"Devolvido",description:"Item devolvido pelo colaborador"},{code:"vencido",label:"Vencido",description:"Item vencido e deve ser substitu√≠do"},{code:"cancelada",label:"Cancelada",description:"Entrega cancelada"}],statusFicha:[{code:"ativa",label:"Ativa",description:"Ficha ativa do colaborador"},{code:"inativa",label:"Inativa",description:"Ficha inativada"},{code:"pendente",label:"Pendente",description:"Ficha com pend√™ncias"},{code:"completa",label:"Completa",description:"Ficha com todos os EPIs entregues"}],statusEstoque:[{code:"disponivel",label:"Dispon√≠vel",description:"Item dispon√≠vel em estoque"},{code:"baixo",label:"Estoque Baixo",description:"Quantidade abaixo do m√≠nimo"},{code:"vencendo",label:"Pr√≥ximo ao Vencimento",description:"Vence em at√© 30 dias"},{code:"vencido",label:"Vencido",description:"Item com validade expirada"},{code:"esgotado",label:"Esgotado",description:"Sem itens em estoque"},{code:"bloqueado",label:"Bloqueado",description:"Item bloqueado para uso"},{code:"quarentena",label:"Em Quarentena",description:"Item devolvido aguardando an√°lise"},{code:"aguarda_inspecao",label:"Aguarda Inspe√ß√£o",description:"Item aguardando inspe√ß√£o t√©cnica"}],tiposNota:[{code:"entrada",label:"Entrada",description:"Nota de entrada de mercadorias"},{code:"transferencia",label:"Transfer√™ncia",description:"Nota de transfer√™ncia"},{code:"devolucao",label:"Devolu√ß√£o",description:"Nota de devolu√ß√£o"},{code:"descarte",label:"Descarte",description:"Nota de descarte"}]};class m{constructor(){n(this,"cache",null);n(this,"cacheExpiry",0);n(this,"CACHE_DURATION",5*60*1e3)}async loadBusinessRules(){if(this.cache&&Date.now()<this.cacheExpiry)return this.cache;try{console.log("üîß Tentando carregar configura√ß√µes do backend...");const e=await l.get("/configuracoes");if(e!=null&&e.success&&e.data){console.log("‚úÖ Configura√ß√µes carregadas do backend");const o=d;return this.cache=o,this.cacheExpiry=Date.now()+this.CACHE_DURATION,o}else throw new Error("Formato de resposta inesperado")}catch(e){return console.warn("‚ö†Ô∏è Endpoint /api/configuracoes n√£o encontrado ou erro:",e),this.cache?(console.warn("üìã Usando configura√ß√µes do cache devido ao erro"),this.cache):(console.warn("üìã Usando configura√ß√µes padr√£o (mock)"),this.cache=d,this.cacheExpiry=Date.now()+this.CACHE_DURATION,d)}}async getConfigByCategory(e){return(await this.loadBusinessRules())[e]||[]}async getConfigItem(e,o){return(await this.getConfigByCategory(e)).find(r=>r.code===o)||null}clearCache(){this.cache=null,this.cacheExpiry=0}isCacheValid(){return this.cache!==null&&Date.now()<this.cacheExpiry}}const u=new m;async function _(){try{console.log("‚öôÔ∏è Carregando configura√ß√µes do sistema...");const a=await l.get("/configuracoes");return console.log("‚úÖ Configura√ß√µes do sistema carregadas:",a.data.length),a.data}catch(a){throw console.error("‚ùå Erro ao carregar configura√ß√µes do sistema:",a),a}}async function h(a,e){try{console.log("üíæ Atualizando configura√ß√£o do sistema:",a,"‚Üí",e);const o=await l.put(`/configuracoes/${a}`,{valor:e});return console.log("‚úÖ Configura√ß√£o do sistema atualizada:",{chave:a,valorAnterior:o.data.valorAnterior,valorNovo:o.data.configuracao.valor}),o.data.configuracao}catch(o){throw console.error("‚ùå Erro ao atualizar configura√ß√£o do sistema:",o),o}}async function T(a,e){return h(a,e.toString())}const y={PERMITIR_ESTOQUE_NEGATIVO:"PERMITIR_ESTOQUE_NEGATIVO",PERMITIR_AJUSTES_FORCADOS:"PERMITIR_AJUSTES_FORCADOS",ESTOQUE_MINIMO_EQUIPAMENTO:"ESTOQUE_MINIMO_EQUIPAMENTO"},p={data:null,loading:!1,error:null,lastUpdated:null};function v(){const{subscribe:a,set:e,update:o}=b(p);return{subscribe:a,async initialize(){o(t=>({...t,loading:!0,error:null}));try{const t=await u.loadBusinessRules();e({data:t,loading:!1,error:null,lastUpdated:Date.now()}),console.log("‚úÖ Configura√ß√µes de neg√≥cio carregadas com sucesso")}catch(t){const r=t instanceof Error?t.message:"Erro desconhecido";o(g=>({...g,loading:!1,error:`Erro ao carregar configura√ß√µes: ${r}`})),console.error("‚ùå Erro ao carregar configura√ß√µes de neg√≥cio:",t)}},async reload(){u.clearCache(),await this.initialize()},reset(){e(p)},isReady(){let t=!1;return a(r=>{t=r.data!==null&&!r.loading&&!r.error})(),t}}}const i=v(),C=s(i,a=>{var e;return((e=a.data)==null?void 0:e.tiposMovimentacao)||[]}),O=s(i,a=>{var e;return((e=a.data)==null?void 0:e.categoriasEPI)||[]}),A=s(i,a=>{var e;return((e=a.data)==null?void 0:e.statusEntrega)||[]}),w=s(i,a=>{var e;return((e=a.data)==null?void 0:e.statusFicha)||[]}),I=s(i,a=>{var e;return((e=a.data)==null?void 0:e.statusEstoque)||[]}),N=s(i,a=>{var e;return((e=a.data)==null?void 0:e.tiposNota)||[]}),M=s(i,a=>a.data!==null&&!a.loading&&!a.error);async function D(){await i.initialize()}function c(a,e=!0){const o=a.map(t=>({value:t.code,label:t.label}));return e?[{value:"",label:"Selecionar..."},...o]:o}const U=s(C,a=>c(a)),x=s(O,a=>c(a)),q=s(A,a=>c(a)),B=s(I,a=>c(a));export{y as C,u as a,i as b,x as c,O as d,A as e,w as f,I as g,N as h,M as i,U as j,q as k,D as l,c as m,_ as n,B as s,C as t,T as u};
