import{S as ue,i as fe,s as me,d as $,A as L,m as R,o as D,q as ie,b as P,c,B as H,O as v,a4 as ve,h as C,e as g,f as b,C as O,T as q,k,j as x,D as N,r as se,a as X,g as U,t as Q,n as pe,p as le,Q as Z,R as ee}from"../chunks/BMdB51sm.js";import"../chunks/IHki7fMi.js";import{A as $e}from"../chunks/BMFRB0f-.js";import{a as he,B as te,e as ge}from"../chunks/Dwq3Do7L.js";import{C as J}from"../chunks/BVvHLR6M.js";import{C as de}from"../chunks/BDKByL26.js";import{C as ce}from"../chunks/BIt5QlSh.js";import{i as xe,k as _e}from"../chunks/J1Pyr5dP.js";class Ie{async detectInconsistencies(){console.log("üîç INICIANDO: Detec√ß√£o de inconsist√™ncias de estoque...");const e=[];try{const t=await xe.getInventoryItems({pageSize:1e3,includeExpanded:!0});console.log(`üì¶ ESTOQUE: ${t.data.length} itens encontrados para verifica√ß√£o`);for(const a of t.data)try{await this.checkItemConsistency(a,e),await new Promise(o=>setTimeout(o,100))}catch(o){console.warn(`‚ö†Ô∏è Erro ao verificar item ${a.id}:`,o);continue}return console.log(`üö® RESULTADO: ${e.length} inconsist√™ncias detectadas`),e.sort((a,o)=>{const s={critica:0,alta:1,media:2,baixa:3};return s[a.severidade]-s[o.severidade]}),e}catch(t){throw console.error("‚ùå Erro fatal na detec√ß√£o de inconsist√™ncias:",t),t}}async checkItemConsistency(e,t){var s,r,u;const a=e.almoxarifadoId||((s=e.almoxarifado)==null?void 0:s.id),o=e.tipoEPIId||e.tipoEpiId||((r=e.tipoEPI)==null?void 0:r.id);if(!a||!o){console.warn(`‚ö†Ô∏è SKIP: Item ${e.id} sem IDs necess√°rios`,{almoxarifadoId:a,tipoEpiId:o});return}try{const l=await _e.obterKardex({almoxarifadoId:a,tipoEpiId:o}),f=e.quantidade,n=l.saldoFinal,d=f-n;if(d!==0){const i={item:e,estoqueAtual:f,saldoKardex:n,diferenca:d,tipo:d>0?"read_model_maior":"event_log_maior",severidade:this.calculateSeverity(Math.abs(d),f),recomendacao:this.generateRecommendation(d,e)};t.push(i),console.log(`üö® INCONSIST√äNCIA: ${(u=e.tipoEPI)==null?void 0:u.nomeEquipamento}`,{atual:f,kardex:n,diferenca:d,tipo:i.tipo})}}catch(l){console.warn(`‚ö†Ô∏è Erro ao buscar kardex para item ${e.id}:`,l)}}calculateSeverity(e,t){const a=t>0?e/t*100:100;return t===0||a>=100?"critica":a>=50?"alta":a>=20?"media":"baixa"}generateRecommendation(e,t){return e>0?`Aplicar ajuste de -${e} unidades (Read Model tem ${e} a mais que Event Log)`:`Aplicar ajuste de +${Math.abs(e)} unidades (Event Log tem ${Math.abs(e)} a mais que Read Model)`}async fixInconsistency(e){var s,r,u,l,f,n,d;const{item:t,saldoKardex:a,estoqueAtual:o}=e;console.log(`üîß CORRIGINDO: ${((s=t.tipoEPI)==null?void 0:s.nomeEquipamento)||t.id}`);try{const i={almoxarifadoId:t.almoxarifadoId||((r=t.almoxarifado)==null?void 0:r.id),tipoEpiId:t.tipoEPIId||t.tipoEpiId||((u=t.tipoEPI)==null?void 0:u.id),novaQuantidade:a,motivo:`Corre√ß√£o autom√°tica de inconsist√™ncia: estoque estava ${o}, kardex indica ${a}. Causa prov√°vel: importa√ß√£o de dados seed sem gera√ß√£o de eventos.`,validarPermissao:!0};console.log("üì§ PAYLOAD ajuste-direto:",i);const m=await he.post("/estoque/ajuste-direto",i),p={success:!0,itemId:t.id,nomeEquipamento:((l=t.tipoEPI)==null?void 0:l.nomeEquipamento)||"N/A",valorAnterior:o,valorCorrigido:a,ajusteId:m.id||((f=m.data)==null?void 0:f.id)};return console.log(`‚úÖ CORRIGIDO: ${p.nomeEquipamento}`,{de:o,para:a,ajusteId:p.ajusteId}),p}catch(i){return console.error(`‚ùå ERRO na corre√ß√£o de ${(n=t.tipoEPI)==null?void 0:n.nomeEquipamento}:`,i),{success:!1,itemId:t.id,nomeEquipamento:((d=t.tipoEPI)==null?void 0:d.nomeEquipamento)||"N/A",valorAnterior:o,valorCorrigido:a,error:i instanceof Error?i.message:"Erro desconhecido"}}}async fixAllInconsistencies(e,t={}){const{confirmarCriticas:a=!0,maxCorrecoesSimultaneas:o=5,delayEntreCorrecoes:s=1e3}=t;console.log(`üîß CORRE√á√ÉO EM MASSA: ${e.length} inconsist√™ncias`);const r=[];let u=e;if(a){const n=e.filter(d=>d.severidade==="critica");n.length>0&&(console.warn(`‚ö†Ô∏è ${n.length} inconsist√™ncias CR√çTICAS detectadas. Avalie manualmente antes de corrigir automaticamente.`),u=e.filter(d=>d.severidade!=="critica"))}for(let n=0;n<u.length;n+=o){const d=u.slice(n,n+o);console.log(`üì¶ Processando lote ${Math.floor(n/o)+1}/${Math.ceil(u.length/o)}`);const i=d.map(p=>this.fixInconsistency(p)),m=await Promise.allSettled(i);for(const p of m)p.status==="fulfilled"?r.push(p.value):console.error("‚ùå Erro no lote:",p.reason);n+o<u.length&&await new Promise(p=>setTimeout(p,s))}const l=r.filter(n=>n.success).length,f=r.filter(n=>!n.success).length;return console.log(`üéØ RESULTADO FINAL: ${l} sucessos, ${f} falhas`),r}generateReport(e){var o,s,r,u;if(e.length===0)return"‚úÖ Nenhuma inconsist√™ncia detectada. Sistema est√° √≠ntegro.";const t=e.reduce((l,f)=>(l[f.severidade]=(l[f.severidade]||0)+1,l),{});let a=`üö® RELAT√ìRIO DE INCONSIST√äNCIAS DE ESTOQUE
`;a+=`==========================================
`,a+=`Total: ${e.length} inconsist√™ncias
`,a+=`- Cr√≠ticas: ${t.critica||0}
`,a+=`- Altas: ${t.alta||0}
`,a+=`- M√©dias: ${t.media||0}
`,a+=`- Baixas: ${t.baixa||0}

`,a+=`DETALHES:
`,a+=`----------
`;for(const l of e)a+=`üî∏ ${((o=l.item.tipoEPI)==null?void 0:o.nomeEquipamento)||"N/A"}
`,a+=`   ID do Item: ${l.item.id}
`,a+=`   CA: ${((s=l.item.tipoEPI)==null?void 0:s.numeroCA)||"N/A"}
`,a+=`   Almoxarifado ID: ${l.item.almoxarifadoId||((r=l.item.almoxarifado)==null?void 0:r.id)||"N/A"}
`,a+=`   Tipo EPI ID: ${l.item.tipoEPIId||l.item.tipoEpiId||((u=l.item.tipoEPI)==null?void 0:u.id)||"N/A"}
`,a+=`   Estoque Atual: ${l.estoqueAtual}
`,a+=`   Saldo Kardex: ${l.saldoKardex}
`,a+=`   Diferen√ßa: ${l.diferenca}
`,a+=`   Severidade: ${l.severidade.toUpperCase()}
`,a+=`   Recomenda√ß√£o: ${l.recomendacao}

`;return a}}const re=new Ie;function Ee(h){let e;return{c(){e=Q("Executar Verifica√ß√£o")},l(t){e=U(t,"Executar Verifica√ß√£o")},m(t,a){P(t,e,a)},d(t){t&&$(e)}}}function be(h){let e,t,a,o;return{c(){e=ee("svg"),t=ee("circle"),a=ee("path"),o=Q(`
          Verificando...`),this.h()},l(s){e=Z(s,"svg",{class:!0,xmlns:!0,fill:!0,viewBox:!0});var r=b(e);t=Z(r,"circle",{class:!0,cx:!0,cy:!0,r:!0,stroke:!0,"stroke-width":!0}),b(t).forEach($),a=Z(r,"path",{class:!0,fill:!0,d:!0}),b(a).forEach($),r.forEach($),o=U(s,`
          Verificando...`),this.h()},h(){v(t,"class","opacity-25"),v(t,"cx","12"),v(t,"cy","12"),v(t,"r","10"),v(t,"stroke","currentColor"),v(t,"stroke-width","4"),v(a,"class","opacity-75"),v(a,"fill","currentColor"),v(a,"d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"),v(e,"class","animate-spin -ml-1 mr-3 h-4 w-4 text-white"),v(e,"xmlns","http://www.w3.org/2000/svg"),v(e,"fill","none"),v(e,"viewBox","0 0 24 24")},m(s,r){P(s,e,r),c(e,t),c(e,a),P(s,o,r)},d(s){s&&($(e),$(o))}}}function Ce(h){let e;function t(s,r){return s[0]?be:Ee}let a=t(h),o=a(h);return{c(){o.c(),e=se()},l(s){o.l(s),e=se()},m(s,r){o.m(s,r),P(s,e,r)},p(s,r){a!==(a=t(s))&&(o.d(1),o=a(s),o&&(o.c(),o.m(e.parentNode,e)))},d(s){s&&$(e),o.d(s)}}}function ke(h){let e,t,a='<div class="w-8 h-8 text-red-500 flex items-center justify-center text-lg">‚ö†Ô∏è</div>',o,s,r,u="Inconsist√™ncias Cr√≠ticas",l,f,n;return{c(){e=x("div"),t=x("div"),t.innerHTML=a,o=k(),s=x("div"),r=x("div"),r.textContent=u,l=k(),f=x("div"),n=Q(h[3]),this.h()},l(d){e=g(d,"DIV",{class:!0});var i=b(e);t=g(i,"DIV",{class:!0,"data-svelte-h":!0}),q(t)!=="svelte-lubchg"&&(t.innerHTML=a),o=C(i),s=g(i,"DIV",{});var m=b(s);r=g(m,"DIV",{class:!0,"data-svelte-h":!0}),q(r)!=="svelte-1m5j0ep"&&(r.textContent=u),l=C(m),f=g(m,"DIV",{class:!0});var p=b(f);n=U(p,h[3]),p.forEach($),m.forEach($),i.forEach($),this.h()},h(){v(t,"class","flex-shrink-0"),v(r,"class","text-sm font-medium text-gray-500 dark:text-gray-400"),v(f,"class","text-2xl font-bold text-red-600"),v(e,"class","flex items-center space-x-3")},m(d,i){P(d,e,i),c(e,t),c(e,o),c(e,s),c(s,r),c(s,l),c(s,f),c(f,n)},p(d,i){i&8&&X(n,d[3])},d(d){d&&$(e)}}}function ye(h){let e,t,a,o,s,r,u="Diferen√ßa Total",l,f,n,d,i,m="unidades",p;return a=new ce({props:{class:"w-8 h-8 text-yellow-500"}}),{c(){e=x("div"),t=x("div"),N(a.$$.fragment),o=k(),s=x("div"),r=x("div"),r.textContent=u,l=k(),f=x("div"),n=Q(h[4]),d=k(),i=x("div"),i.textContent=m,this.h()},l(I){e=g(I,"DIV",{class:!0});var _=b(e);t=g(_,"DIV",{class:!0});var w=b(t);O(a.$$.fragment,w),w.forEach($),o=C(_),s=g(_,"DIV",{});var y=b(s);r=g(y,"DIV",{class:!0,"data-svelte-h":!0}),q(r)!=="svelte-18m2miu"&&(r.textContent=u),l=C(y),f=g(y,"DIV",{class:!0});var T=b(f);n=U(T,h[4]),T.forEach($),d=C(y),i=g(y,"DIV",{class:!0,"data-svelte-h":!0}),q(i)!=="svelte-a30si8"&&(i.textContent=m),y.forEach($),_.forEach($),this.h()},h(){v(t,"class","flex-shrink-0"),v(r,"class","text-sm font-medium text-gray-500 dark:text-gray-400"),v(f,"class","text-2xl font-bold text-yellow-600"),v(i,"class","text-xs text-gray-500"),v(e,"class","flex items-center space-x-3")},m(I,_){P(I,e,_),c(e,t),H(a,t,null),c(e,o),c(e,s),c(s,r),c(s,l),c(s,f),c(f,n),c(s,d),c(s,i),p=!0},p(I,_){(!p||_&16)&&X(n,I[4])},i(I){p||(D(a.$$.fragment,I),p=!0)},o(I){R(a.$$.fragment,I),p=!1},d(I){I&&$(e),L(a)}}}function De(h){let e,t,a,o,s,r,u="√öltima Verifica√ß√£o",l,f,n=(h[1]?h[1].toLocaleString("pt-BR"):"Nunca executada")+"",d,i;return a=new de({props:{class:"w-8 h-8 text-blue-500"}}),{c(){e=x("div"),t=x("div"),N(a.$$.fragment),o=k(),s=x("div"),r=x("div"),r.textContent=u,l=k(),f=x("div"),d=Q(n),this.h()},l(m){e=g(m,"DIV",{class:!0});var p=b(e);t=g(p,"DIV",{class:!0});var I=b(t);O(a.$$.fragment,I),I.forEach($),o=C(p),s=g(p,"DIV",{});var _=b(s);r=g(_,"DIV",{class:!0,"data-svelte-h":!0}),q(r)!=="svelte-1fqvrbg"&&(r.textContent=u),l=C(_),f=g(_,"DIV",{class:!0});var w=b(f);d=U(w,n),w.forEach($),_.forEach($),p.forEach($),this.h()},h(){v(t,"class","flex-shrink-0"),v(r,"class","text-sm font-medium text-gray-500 dark:text-gray-400"),v(f,"class","text-sm font-medium text-gray-900 dark:text-white"),v(e,"class","flex items-center space-x-3")},m(m,p){P(m,e,p),c(e,t),H(a,t,null),c(e,o),c(e,s),c(s,r),c(s,l),c(s,f),c(f,d),i=!0},p(m,p){(!i||p&2)&&n!==(n=(m[1]?m[1].toLocaleString("pt-BR"):"Nunca executada")+"")&&X(d,n)},i(m){i||(D(a.$$.fragment,m),i=!0)},o(m){R(a.$$.fragment,m),i=!1},d(m){m&&$(e),L(a)}}}function we(h){let e,t,a,o,s=`<div class="font-medium">Verifica√ß√£o Confirmada</div> <div class="text-sm mt-1">‚úÖ Backend consultado diretamente<br/>
                  ‚úÖ Dados validados via API<br/>
                  ‚úÖ Inconsist√™ncia real confirmada</div>`,r;return t=new de({props:{class:"w-5 h-5 mt-0.5"}}),{c(){e=x("div"),N(t.$$.fragment),a=k(),o=x("div"),o.innerHTML=s,this.h()},l(u){e=g(u,"DIV",{class:!0});var l=b(e);O(t.$$.fragment,l),a=C(l),o=g(l,"DIV",{"data-svelte-h":!0}),q(o)!=="svelte-1e4ryha"&&(o.innerHTML=s),l.forEach($),this.h()},h(){v(e,"class","flex items-start space-x-2")},m(u,l){P(u,e,l),H(t,e,null),c(e,a),c(e,o),r=!0},p:pe,i(u){r||(D(t.$$.fragment,u),r=!0)},o(u){R(t.$$.fragment,u),r=!1},d(u){u&&$(e),L(t)}}}function Ve(h){let e,t,a,o='<div class="w-6 h-6 text-red-500 flex items-center justify-center text-base mt-1">‚ö†Ô∏è</div>',s,r,u,l="üö® Inconsist√™ncia Cr√≠tica Detectada",f,n,d='<h4 class="font-medium text-red-800 dark:text-red-200 mb-3">Avental de Raspa de Couro CA 32890</h4> <div class="grid grid-cols-1 md:grid-cols-3 gap-4 text-sm"><div><div class="text-red-700 dark:text-red-300 font-medium">Estoque Atual (Read Model)</div> <div class="text-xl font-bold text-red-800 dark:text-red-200">244 unidades</div></div> <div><div class="text-red-700 dark:text-red-300 font-medium">Saldo Kardex (Event Log)</div> <div class="text-xl font-bold text-red-800 dark:text-red-200">-2 unidades</div></div> <div><div class="text-red-700 dark:text-red-300 font-medium">Diferen√ßa</div> <div class="text-xl font-bold text-red-800 dark:text-red-200">+246 unidades</div></div></div> <div class="mt-4 pt-4 border-t border-red-200 dark:border-red-700"><div class="text-sm text-red-700 dark:text-red-300"><strong>Causa:</strong> Script de seed inseriu dados diretamente no Read Model sem gerar eventos correspondentes no Event Log</div></div>',i,m,p;return m=new $e({props:{color:"blue",class:"mb-4",$$slots:{default:[we]},$$scope:{ctx:h}}}),{c(){e=x("div"),t=x("div"),a=x("div"),a.innerHTML=o,s=k(),r=x("div"),u=x("h3"),u.textContent=l,f=k(),n=x("div"),n.innerHTML=d,i=k(),N(m.$$.fragment),this.h()},l(I){e=g(I,"DIV",{class:!0});var _=b(e);t=g(_,"DIV",{class:!0});var w=b(t);a=g(w,"DIV",{class:!0,"data-svelte-h":!0}),q(a)!=="svelte-mxqjp7"&&(a.innerHTML=o),s=C(w),r=g(w,"DIV",{class:!0});var y=b(r);u=g(y,"H3",{class:!0,"data-svelte-h":!0}),q(u)!=="svelte-95n8lb"&&(u.textContent=l),f=C(y),n=g(y,"DIV",{class:!0,"data-svelte-h":!0}),q(n)!=="svelte-ruz889"&&(n.innerHTML=d),i=C(y),O(m.$$.fragment,y),y.forEach($),w.forEach($),_.forEach($),this.h()},h(){v(a,"class","flex-shrink-0"),v(u,"class","text-lg font-semibold text-gray-900 dark:text-white mb-2"),v(n,"class","bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-sm p-4 mb-4"),v(r,"class","flex-1"),v(t,"class","flex items-start space-x-4"),v(e,"class","p-6")},m(I,_){P(I,e,_),c(e,t),c(t,a),c(t,s),c(t,r),c(r,u),c(r,f),c(r,n),c(r,i),H(m,r,null),p=!0},p(I,_){const w={};_&512&&(w.$$scope={dirty:_,ctx:I}),m.$set(w)},i(I){p||(D(m.$$.fragment,I),p=!0)},o(I){R(m.$$.fragment,I),p=!1},d(I){I&&$(e),L(m)}}}function oe(h){let e,t;return e=new J({props:{class:"rounded-sm mb-6",$$slots:{default:[Se]},$$scope:{ctx:h}}}),{c(){N(e.$$.fragment)},l(a){O(e.$$.fragment,a)},m(a,o){H(e,a,o),t=!0},p(a,o){const s={};o&548&&(s.$$scope={dirty:o,ctx:a}),e.$set(s)},i(a){t||(D(e.$$.fragment,a),t=!0)},o(a){R(e.$$.fragment,a),t=!1},d(a){L(e,a)}}}function ne(h){let e,t,a="üîß A√ß√µes Dispon√≠veis:",o,s,r,u,l,f;return r=new te({props:{color:"blue",size:"sm",class:"rounded-sm",$$slots:{default:[Ae]},$$scope:{ctx:h}}}),r.$on("click",h[7]),l=new te({props:{color:"alternative",size:"sm",class:"rounded-sm ml-2",$$slots:{default:[Re]},$$scope:{ctx:h}}}),l.$on("click",h[8]),{c(){e=x("div"),t=x("h4"),t.textContent=a,o=k(),s=x("div"),N(r.$$.fragment),u=k(),N(l.$$.fragment),this.h()},l(n){e=g(n,"DIV",{class:!0});var d=b(e);t=g(d,"H4",{class:!0,"data-svelte-h":!0}),q(t)!=="svelte-1k2ghvg"&&(t.textContent=a),o=C(d),s=g(d,"DIV",{class:!0});var i=b(s);O(r.$$.fragment,i),u=C(i),O(l.$$.fragment,i),i.forEach($),d.forEach($),this.h()},h(){v(t,"class","font-medium text-gray-900 dark:text-white mb-2"),v(s,"class","space-y-2"),v(e,"class","mt-4")},m(n,d){P(n,e,d),c(e,t),c(e,o),c(e,s),H(r,s,null),c(s,u),H(l,s,null),f=!0},p(n,d){const i={};d&512&&(i.$$scope={dirty:d,ctx:n}),r.$set(i);const m={};d&512&&(m.$$scope={dirty:d,ctx:n}),l.$set(m)},i(n){f||(D(r.$$.fragment,n),D(l.$$.fragment,n),f=!0)},o(n){R(r.$$.fragment,n),R(l.$$.fragment,n),f=!1},d(n){n&&$(e),L(r),L(l)}}}function Ae(h){let e;return{c(){e=Q("Corrigir Automaticamente")},l(t){e=U(t,"Corrigir Automaticamente")},m(t,a){P(t,e,a)},d(t){t&&$(e)}}}function Re(h){let e;return{c(){e=Q("Fechar Resultados")},l(t){e=U(t,"Fechar Resultados")},m(t,a){P(t,e,a)},d(t){t&&$(e)}}}function Se(h){let e,t,a="üìä Resultados da Verifica√ß√£o",o,s,r,u,l,f,n=h[2].length>0&&ne(h);return{c(){e=x("div"),t=x("h3"),t.textContent=a,o=k(),s=x("div"),r=x("pre"),u=Q(h[5]),l=k(),n&&n.c(),this.h()},l(d){e=g(d,"DIV",{class:!0});var i=b(e);t=g(i,"H3",{class:!0,"data-svelte-h":!0}),q(t)!=="svelte-1tqekwp"&&(t.textContent=a),o=C(i),s=g(i,"DIV",{class:!0});var m=b(s);r=g(m,"PRE",{class:!0});var p=b(r);u=U(p,h[5]),p.forEach($),m.forEach($),l=C(i),n&&n.l(i),i.forEach($),this.h()},h(){v(t,"class","text-lg font-semibold text-gray-900 dark:text-white mb-4"),v(r,"class","text-sm text-gray-700 dark:text-gray-300 whitespace-pre-wrap font-mono"),v(s,"class","bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-sm p-4"),v(e,"class","p-6")},m(d,i){P(d,e,i),c(e,t),c(e,o),c(e,s),c(s,r),c(r,u),c(e,l),n&&n.m(e,null),f=!0},p(d,i){(!f||i&32)&&X(u,d[5]),d[2].length>0?n?(n.p(d,i),i&4&&D(n,1)):(n=ne(d),n.c(),D(n,1),n.m(e,null)):n&&(le(),R(n,1,1,()=>{n=null}),ie())},i(d){f||(D(n),f=!0)},o(d){R(n),f=!1},d(d){d&&$(e),n&&n.d()}}}function qe(h){let e;return{c(){e=Q("Em Desenvolvimento")},l(t){e=U(t,"Em Desenvolvimento")},m(t,a){P(t,e,a)},d(t){t&&$(e)}}}function Pe(h){let e,t,a="üí° Solu√ß√µes Dispon√≠veis",o,s,r,u='<h4 class="font-medium text-gray-900 dark:text-white mb-2">1. Verifica√ß√£o via Terminal (Implementada)</h4> <p class="text-sm text-gray-600 dark:text-gray-400 mb-3">Execute o comando para verificar e confirmar a inconsist√™ncia:</p> <div class="bg-gray-100 dark:bg-gray-800 rounded-sm p-3 font-mono text-sm">npm run quick-check-avental</div>',l,f,n='<h4 class="font-medium text-gray-900 dark:text-white mb-2">2. Corre√ß√£o via API (Manual)</h4> <p class="text-sm text-gray-600 dark:text-gray-400 mb-3">Use o endpoint oficial para corrigir o estoque:</p> <div class="bg-gray-100 dark:bg-gray-800 rounded-sm p-3 text-sm"><div class="font-mono text-blue-600 dark:text-blue-400">POST /api/estoque/ajuste-direto</div> <div class="text-gray-600 dark:text-gray-400 mt-2">Payload: novaQuantidade: -2, motivo: &quot;Corre√ß√£o seed&quot;</div></div>',d,i,m,p="3. Ferramenta Visual Completa",I,_,w="Interface web para corre√ß√£o autom√°tica (em desenvolvimento):",y,T,B;return T=new ge({props:{color:"yellow",class:"rounded-sm",$$slots:{default:[qe]},$$scope:{ctx:h}}}),{c(){e=x("div"),t=x("h3"),t.textContent=a,o=k(),s=x("div"),r=x("div"),r.innerHTML=u,l=k(),f=x("div"),f.innerHTML=n,d=k(),i=x("div"),m=x("h4"),m.textContent=p,I=k(),_=x("p"),_.textContent=w,y=k(),N(T.$$.fragment),this.h()},l(M){e=g(M,"DIV",{class:!0});var j=b(e);t=g(j,"H3",{class:!0,"data-svelte-h":!0}),q(t)!=="svelte-o9q43f"&&(t.textContent=a),o=C(j),s=g(j,"DIV",{class:!0});var S=b(s);r=g(S,"DIV",{class:!0,"data-svelte-h":!0}),q(r)!=="svelte-16dvxw"&&(r.innerHTML=u),l=C(S),f=g(S,"DIV",{class:!0,"data-svelte-h":!0}),q(f)!=="svelte-19beh8p"&&(f.innerHTML=n),d=C(S),i=g(S,"DIV",{class:!0});var F=b(i);m=g(F,"H4",{class:!0,"data-svelte-h":!0}),q(m)!=="svelte-1dzrm65"&&(m.textContent=p),I=C(F),_=g(F,"P",{class:!0,"data-svelte-h":!0}),q(_)!=="svelte-zzp7f6"&&(_.textContent=w),y=C(F),O(T.$$.fragment,F),F.forEach($),S.forEach($),j.forEach($),this.h()},h(){v(t,"class","text-lg font-semibold text-gray-900 dark:text-white mb-4"),v(r,"class","border border-gray-200 dark:border-gray-700 rounded-sm p-4"),v(f,"class","border border-gray-200 dark:border-gray-700 rounded-sm p-4"),v(m,"class","font-medium text-gray-900 dark:text-white mb-2"),v(_,"class","text-sm text-gray-600 dark:text-gray-400 mb-3"),v(i,"class","border border-gray-200 dark:border-gray-700 rounded-sm p-4 opacity-60"),v(s,"class","space-y-4"),v(e,"class","p-6")},m(M,j){P(M,e,j),c(e,t),c(e,o),c(e,s),c(s,r),c(s,l),c(s,f),c(s,d),c(s,i),c(i,m),c(i,I),c(i,_),c(i,y),H(T,i,null),B=!0},p(M,j){const S={};j&512&&(S.$$scope={dirty:j,ctx:M}),T.$set(S)},i(M){B||(D(T.$$.fragment,M),B=!0)},o(M){R(T.$$.fragment,M),B=!1},d(M){M&&$(e),L(T)}}}function Te(h){let e,t,a,o,s,r,u,l,f='<h1 class="text-2xl font-bold text-gray-900 dark:text-white">Verificador de Consist√™ncia de Estoque</h1> <p class="text-gray-600 dark:text-gray-400">Detecta inconsist√™ncias entre estoque atual (Read Model) e hist√≥rico (Event Log)</p>',n,d,i,m,p,I,_,w,y,T,B,M,j,S,F;r=new ce({props:{class:"w-6 h-6 text-primary-600"}}),d=new te({props:{color:"primary",size:"sm",disabled:h[0],class:"rounded-sm",$$slots:{default:[Ce]},$$scope:{ctx:h}}}),d.$on("click",h[6]),p=new J({props:{class:"rounded-sm",$$slots:{default:[ke]},$$scope:{ctx:h}}}),_=new J({props:{class:"rounded-sm",$$slots:{default:[ye]},$$scope:{ctx:h}}}),y=new J({props:{class:"rounded-sm",$$slots:{default:[De]},$$scope:{ctx:h}}}),B=new J({props:{class:"rounded-sm mb-6",$$slots:{default:[Ve]},$$scope:{ctx:h}}});let V=h[5]&&oe(h);return S=new J({props:{class:"rounded-sm",$$slots:{default:[Pe]},$$scope:{ctx:h}}}),{c(){e=k(),t=x("div"),a=x("div"),o=x("div"),s=x("div"),N(r.$$.fragment),u=k(),l=x("div"),l.innerHTML=f,n=k(),N(d.$$.fragment),i=k(),m=x("div"),N(p.$$.fragment),I=k(),N(_.$$.fragment),w=k(),N(y.$$.fragment),T=k(),N(B.$$.fragment),M=k(),V&&V.c(),j=k(),N(S.$$.fragment),this.h()},l(E){ve("svelte-v45kx",document.head).forEach($),e=C(E),t=g(E,"DIV",{class:!0});var z=b(t);a=g(z,"DIV",{class:!0});var W=b(a);o=g(W,"DIV",{class:!0});var G=b(o);s=g(G,"DIV",{class:!0});var Y=b(s);O(r.$$.fragment,Y),u=C(Y),l=g(Y,"DIV",{"data-svelte-h":!0}),q(l)!=="svelte-1y1sfck"&&(l.innerHTML=f),Y.forEach($),n=C(G),O(d.$$.fragment,G),G.forEach($),W.forEach($),i=C(z),m=g(z,"DIV",{class:!0});var K=b(m);O(p.$$.fragment,K),I=C(K),O(_.$$.fragment,K),w=C(K),O(y.$$.fragment,K),K.forEach($),T=C(z),O(B.$$.fragment,z),M=C(z),V&&V.l(z),j=C(z),O(S.$$.fragment,z),z.forEach($),this.h()},h(){document.title="Verificador de Consist√™ncia - DataLife EPI",v(s,"class","flex items-center space-x-3"),v(o,"class","flex items-center justify-between"),v(a,"class","mb-6"),v(m,"class","grid grid-cols-1 md:grid-cols-3 gap-4 mb-6"),v(t,"class","container mx-auto px-4 py-6")},m(E,A){P(E,e,A),P(E,t,A),c(t,a),c(a,o),c(o,s),H(r,s,null),c(s,u),c(s,l),c(o,n),H(d,o,null),c(t,i),c(t,m),H(p,m,null),c(m,I),H(_,m,null),c(m,w),H(y,m,null),c(t,T),H(B,t,null),c(t,M),V&&V.m(t,null),c(t,j),H(S,t,null),F=!0},p(E,[A]){const z={};A&1&&(z.disabled=E[0]),A&513&&(z.$$scope={dirty:A,ctx:E}),d.$set(z);const W={};A&520&&(W.$$scope={dirty:A,ctx:E}),p.$set(W);const G={};A&528&&(G.$$scope={dirty:A,ctx:E}),_.$set(G);const Y={};A&514&&(Y.$$scope={dirty:A,ctx:E}),y.$set(Y);const K={};A&512&&(K.$$scope={dirty:A,ctx:E}),B.$set(K),E[5]?V?(V.p(E,A),A&32&&D(V,1)):(V=oe(E),V.c(),D(V,1),V.m(t,j)):V&&(le(),R(V,1,1,()=>{V=null}),ie());const ae={};A&512&&(ae.$$scope={dirty:A,ctx:E}),S.$set(ae)},i(E){F||(D(r.$$.fragment,E),D(d.$$.fragment,E),D(p.$$.fragment,E),D(_.$$.fragment,E),D(y.$$.fragment,E),D(B.$$.fragment,E),D(V),D(S.$$.fragment,E),F=!0)},o(E){R(r.$$.fragment,E),R(d.$$.fragment,E),R(p.$$.fragment,E),R(_.$$.fragment,E),R(y.$$.fragment,E),R(B.$$.fragment,E),R(V),R(S.$$.fragment,E),F=!1},d(E){E&&($(e),$(t)),L(r),L(d),L(p),L(_),L(y),L(B),V&&V.d(),L(S)}}}function Me(h,e,t){let a=!1,o=null,s=[],r=1,u=246,l=null;async function f(){t(0,a=!0),t(5,l=null);try{console.log("üöÄ Iniciando verifica√ß√£o real de consist√™ncia...");const i=await re.detectInconsistencies();t(2,s=i),t(3,r=i.length),t(4,u=i.reduce((p,I)=>p+Math.abs(I.diferenca),0));const m=re.generateReport(i);t(5,l=m),t(1,o=new Date),console.log("‚úÖ Verifica√ß√£o conclu√≠da:",{inconsistencies:r,totalDifference:u,items:i})}catch(i){console.error("‚ùå Erro na verifica√ß√£o:",i),t(5,l=`Erro na verifica√ß√£o: ${i instanceof Error?i.message:String(i)}`)}finally{t(0,a=!1)}}return[a,o,s,r,u,l,f,()=>console.log("Corre√ß√£o autom√°tica ainda n√£o implementada na interface"),()=>t(5,l=null)]}class Ke extends ue{constructor(e){super(),fe(this,e,Me,Te,me,{})}}export{Ke as component};
